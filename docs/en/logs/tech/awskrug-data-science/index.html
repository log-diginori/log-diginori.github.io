<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.53">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <meta property="og:type" content="website"><meta property="og:title" content="diginori loG"><meta property="og:description" content="so make a better loG.digiNORI"><meta property="og:image" content="https://user-images.githubusercontent.com/10396850/205328536-741b634a-c7e4-4721-b0be-79a4a396b2bc.png"><meta property="og:url" content="https://log.diginori.com"><title>Airflow + ECS + Bigquery | loG</title><meta name="description" content="make a better world. so make a better loG.digiNORI">
    <link rel="preload" href="/assets/style.00faf208.css" as="style" /><link rel="stylesheet" href="/assets/style.00faf208.css" />
    <link rel="modulepreload" href="/assets/app.7f66a962.js"><link rel="modulepreload" href="/assets/index.html.cf13824e.js"><link rel="modulepreload" href="/assets/aws-cup.f5d2f7b1.js"><link rel="modulepreload" href="/assets/index.html.332b0e6b.js"><link rel="prefetch" href="/assets/index.html.2d4b8093.js" as="script" /><link rel="prefetch" href="/assets/index.html.a2677f2e.js" as="script" /><link rel="prefetch" href="/assets/index.html.b672b174.js" as="script" /><link rel="prefetch" href="/assets/index.html.05976f27.js" as="script" /><link rel="prefetch" href="/assets/index.html.290ce687.js" as="script" /><link rel="prefetch" href="/assets/index.html.ca5755d0.js" as="script" /><link rel="prefetch" href="/assets/meplace.html.3d9eeb8c.js" as="script" /><link rel="prefetch" href="/assets/naverunion.html.6f5b32c5.js" as="script" /><link rel="prefetch" href="/assets/정숙성.html.e05acd88.js" as="script" /><link rel="prefetch" href="/assets/index.html.c50334fb.js" as="script" /><link rel="prefetch" href="/assets/index.html.b53f8c72.js" as="script" /><link rel="prefetch" href="/assets/meplace.html.2f3ef3b0.js" as="script" /><link rel="prefetch" href="/assets/naverunion.html.2dd16919.js" as="script" /><link rel="prefetch" href="/assets/정숙성.html.32483e67.js" as="script" /><link rel="prefetch" href="/assets/resume.html.4d8fe410.js" as="script" /><link rel="prefetch" href="/assets/index.html.01311eee.js" as="script" /><link rel="prefetch" href="/assets/index.html.d65aee0a.js" as="script" /><link rel="prefetch" href="/assets/index.html.64b84925.js" as="script" /><link rel="prefetch" href="/assets/index.html.7186e77c.js" as="script" /><link rel="prefetch" href="/assets/index.html.407e7f20.js" as="script" /><link rel="prefetch" href="/assets/index.html.c35f8b42.js" as="script" /><link rel="prefetch" href="/assets/index.html.98a08115.js" as="script" /><link rel="prefetch" href="/assets/index.html.e7514299.js" as="script" /><link rel="prefetch" href="/assets/index.html.8a2ff965.js" as="script" /><link rel="prefetch" href="/assets/index.html.e8653be6.js" as="script" /><link rel="prefetch" href="/assets/index.html.c09ade16.js" as="script" /><link rel="prefetch" href="/assets/theory-of-goods.html.b37eccfa.js" as="script" /><link rel="prefetch" href="/assets/index.html.64dfba3b.js" as="script" /><link rel="prefetch" href="/assets/index.html.f2346db8.js" as="script" /><link rel="prefetch" href="/assets/index.html.26634226.js" as="script" /><link rel="prefetch" href="/assets/index.html.8f1a123a.js" as="script" /><link rel="prefetch" href="/assets/index.html.65df1476.js" as="script" /><link rel="prefetch" href="/assets/resume.html.0acf1e21.js" as="script" /><link rel="prefetch" href="/assets/index.html.e5c9ea48.js" as="script" /><link rel="prefetch" href="/assets/index.html.f9a218e2.js" as="script" /><link rel="prefetch" href="/assets/index.html.8ee6bc64.js" as="script" /><link rel="prefetch" href="/assets/index.html.bfcec346.js" as="script" /><link rel="prefetch" href="/assets/index.html.35978fb5.js" as="script" /><link rel="prefetch" href="/assets/index.html.c54c8891.js" as="script" /><link rel="prefetch" href="/assets/index.html.2d4261fd.js" as="script" /><link rel="prefetch" href="/assets/index.html.797e2c03.js" as="script" /><link rel="prefetch" href="/assets/index.html.bec9c5fd.js" as="script" /><link rel="prefetch" href="/assets/index.html.422eef66.js" as="script" /><link rel="prefetch" href="/assets/index.html.bb5acd48.js" as="script" /><link rel="prefetch" href="/assets/theory-of-goods.html.dba829ca.js" as="script" /><link rel="prefetch" href="/assets/index.html.d81c3a70.js" as="script" /><link rel="prefetch" href="/assets/index.html.71b7ca4f.js" as="script" /><link rel="prefetch" href="/assets/index.html.e7b47d74.js" as="script" /><link rel="prefetch" href="/assets/index.html.4e31902b.js" as="script" /><link rel="prefetch" href="/assets/404.html.90ef47f1.js" as="script" /><link rel="prefetch" href="/assets/index.html.bd18d4d0.js" as="script" /><link rel="prefetch" href="/assets/index.html.33f293d6.js" as="script" /><link rel="prefetch" href="/assets/index.html.609c101c.js" as="script" /><link rel="prefetch" href="/assets/index.html.7860115f.js" as="script" /><link rel="prefetch" href="/assets/index.html.0d468f3c.js" as="script" /><link rel="prefetch" href="/assets/index.html.d99f9ead.js" as="script" /><link rel="prefetch" href="/assets/meplace.html.e33c2f65.js" as="script" /><link rel="prefetch" href="/assets/naverunion.html.d57e6ef1.js" as="script" /><link rel="prefetch" href="/assets/정숙성.html.1a2e86cc.js" as="script" /><link rel="prefetch" href="/assets/index.html.d9fe1d35.js" as="script" /><link rel="prefetch" href="/assets/index.html.12ec46a8.js" as="script" /><link rel="prefetch" href="/assets/meplace.html.2cdaf4f5.js" as="script" /><link rel="prefetch" href="/assets/naverunion.html.d22d2a0f.js" as="script" /><link rel="prefetch" href="/assets/정숙성.html.a62e770a.js" as="script" /><link rel="prefetch" href="/assets/resume.html.980be601.js" as="script" /><link rel="prefetch" href="/assets/index.html.61ce7fcf.js" as="script" /><link rel="prefetch" href="/assets/index.html.ba2e77b3.js" as="script" /><link rel="prefetch" href="/assets/index.html.a6e0a256.js" as="script" /><link rel="prefetch" href="/assets/index.html.0524f364.js" as="script" /><link rel="prefetch" href="/assets/index.html.6acaf6d6.js" as="script" /><link rel="prefetch" href="/assets/index.html.6def4983.js" as="script" /><link rel="prefetch" href="/assets/index.html.413d5486.js" as="script" /><link rel="prefetch" href="/assets/index.html.0463d317.js" as="script" /><link rel="prefetch" href="/assets/index.html.f3a21010.js" as="script" /><link rel="prefetch" href="/assets/index.html.64868d08.js" as="script" /><link rel="prefetch" href="/assets/index.html.f6a5dda5.js" as="script" /><link rel="prefetch" href="/assets/theory-of-goods.html.fe850432.js" as="script" /><link rel="prefetch" href="/assets/index.html.0dbba1c2.js" as="script" /><link rel="prefetch" href="/assets/index.html.b83e30cc.js" as="script" /><link rel="prefetch" href="/assets/index.html.7f64d964.js" as="script" /><link rel="prefetch" href="/assets/index.html.022b88a8.js" as="script" /><link rel="prefetch" href="/assets/index.html.4661d5a9.js" as="script" /><link rel="prefetch" href="/assets/resume.html.370953f2.js" as="script" /><link rel="prefetch" href="/assets/index.html.73f15604.js" as="script" /><link rel="prefetch" href="/assets/index.html.a816ad60.js" as="script" /><link rel="prefetch" href="/assets/index.html.f45ee4ad.js" as="script" /><link rel="prefetch" href="/assets/index.html.e10ec196.js" as="script" /><link rel="prefetch" href="/assets/index.html.b3919307.js" as="script" /><link rel="prefetch" href="/assets/index.html.1e790e65.js" as="script" /><link rel="prefetch" href="/assets/index.html.2a5042d8.js" as="script" /><link rel="prefetch" href="/assets/index.html.b5b0a797.js" as="script" /><link rel="prefetch" href="/assets/index.html.dfa4227c.js" as="script" /><link rel="prefetch" href="/assets/index.html.bba01811.js" as="script" /><link rel="prefetch" href="/assets/index.html.1e6b021e.js" as="script" /><link rel="prefetch" href="/assets/theory-of-goods.html.6293a99a.js" as="script" /><link rel="prefetch" href="/assets/index.html.c11b9cbc.js" as="script" /><link rel="prefetch" href="/assets/index.html.39e0d3e6.js" as="script" /><link rel="prefetch" href="/assets/index.html.53dd9bb8.js" as="script" /><link rel="prefetch" href="/assets/index.html.230a2922.js" as="script" /><link rel="prefetch" href="/assets/404.html.d0e473af.js" as="script" />
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/index.md" class=""><!----><span class="site-name can-hide">loG</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/logs/" class="" aria-label="tail -f loG"><!--[--><!--]--> tail -f loG <!--[--><!--]--></a></div><div class="navbar-item"><a href="/logs/travel/meplace.md" class="" aria-label="meplace"><!--[--><!--]--> meplace <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/en/logs/tech/awskrug-data-science/" class="router-link-active router-link-exact-active router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/logs/tech/awskrug-data-science/" class="" aria-label="Korean"><!--[--><!--]--> Korean <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/log-diginori/log-diginori.github.io/discussions" rel="noopener noreferrer" target="_blank" aria-label="discussions"><!--[--><!--]--> discussions <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/logs/" class="" aria-label="tail -f loG"><!--[--><!--]--> tail -f loG <!--[--><!--]--></a></div><div class="navbar-item"><a href="/logs/travel/meplace.md" class="" aria-label="meplace"><!--[--><!--]--> meplace <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a aria-current="page" href="/en/logs/tech/awskrug-data-science/" class="router-link-active router-link-exact-active router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/logs/tech/awskrug-data-science/" class="" aria-label="Korean"><!--[--><!--]--> Korean <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/log-diginori/log-diginori.github.io/discussions" rel="noopener noreferrer" target="_blank" aria-label="discussions"><!--[--><!--]--> discussions <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">Technology <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/en/logs/tech/nhn-forward/" class="sidebar-item" aria-label="NHN FORWARD"><!--[--><!--]--> NHN FORWARD <!--[--><!--]--></a><!----></li><li><a href="/en/logs/tech/naver-cloud-summit/" class="sidebar-item" aria-label="NAVER CLOUD SUMMIT"><!--[--><!--]--> NAVER CLOUD SUMMIT <!--[--><!--]--></a><!----></li><li><a href="/en/logs/tech/google-cloud-innovators-hive/" class="sidebar-item" aria-label="GOOGLE INNOVATORS HIVE"><!--[--><!--]--> GOOGLE INNOVATORS HIVE <!--[--><!--]--></a><!----></li><li><a href="/en/logs/tech/1784/" class="sidebar-item" aria-label="1784 AND MY STORY"><!--[--><!--]--> 1784 AND MY STORY <!--[--><!--]--></a><!----></li><li><a href="/en/logs/tech/sre/" class="sidebar-item" aria-label="SRE"><!--[--><!--]--> SRE <!--[--><!--]--></a><!----></li><li><a href="/en/logs/tech/seo/" class="sidebar-item" aria-label="SEO"><!--[--><!--]--> SEO <!--[--><!--]--></a><!----></li><li><a href="/en/logs/tech/ai/" class="sidebar-item" aria-label="AI &amp; DEEP LEARNING"><!--[--><!--]--> AI &amp; DEEP LEARNING <!--[--><!--]--></a><!----></li><li><a href="/en/logs/tech/drone/" class="sidebar-item" aria-label="DRONE PROGRAMMING"><!--[--><!--]--> DRONE PROGRAMMING <!--[--><!--]--></a><!----></li><li><a href="/en/logs/tech/agile/" class="sidebar-item" aria-label="AGILE ARGUMENT"><!--[--><!--]--> AGILE ARGUMENT <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/en/logs/tech/awskrug-data-science/" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Airflow + ECS + Bigquery"><!--[--><!--]--> Airflow + ECS + Bigquery <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/en/logs/tech/awskrug-data-science/#참가신청" class="router-link-active router-link-exact-active sidebar-item" aria-label="참가신청"><!--[--><!--]--> 참가신청 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/en/logs/tech/awskrug-data-science/#pip" class="router-link-active router-link-exact-active sidebar-item" aria-label="pip"><!--[--><!--]--> pip <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/en/logs/tech/awskrug-data-science/#ecs" class="router-link-active router-link-exact-active sidebar-item" aria-label="ECS"><!--[--><!--]--> ECS <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/en/logs/tech/awskrug-data-science/#inplace-dag-배포" class="router-link-active router-link-exact-active sidebar-item" aria-label="Inplace DAG 배포"><!--[--><!--]--> Inplace DAG 배포 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/en/logs/tech/awskrug-data-science/#codebuild" class="router-link-active router-link-exact-active sidebar-item" aria-label="Codebuild"><!--[--><!--]--> Codebuild <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/en/logs/tech/awskrug-data-science/#서비스는-블루그린으로-배포해도-무방" class="router-link-active router-link-exact-active sidebar-item" aria-label="서비스는 블루그린으로 배포해도 무방"><!--[--><!--]--> 서비스는 블루그린으로 배포해도 무방 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/en/logs/tech/awskrug-data-science/#airflow-의존성-라이브러리" class="router-link-active router-link-exact-active sidebar-item" aria-label="Airflow 의존성 라이브러리"><!--[--><!--]--> Airflow 의존성 라이브러리 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/en/logs/tech/awskrug-data-science/#자동화란" class="router-link-active router-link-exact-active sidebar-item" aria-label="자동화란"><!--[--><!--]--> 자동화란 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/en/logs/tech/awskrug-data-science/#서비스-검색" class="router-link-active router-link-exact-active sidebar-item" aria-label="서비스 검색"><!--[--><!--]--> 서비스 검색 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/en/logs/tech/awskrug-data-science/#타-팀과의-협업" class="router-link-active router-link-exact-active sidebar-item" aria-label="타 팀과의 협업"><!--[--><!--]--> 타 팀과의 협업 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/en/logs/tech/awskrug-data-science/#데이터팀의-구성" class="router-link-active router-link-exact-active sidebar-item" aria-label="데이터팀의 구성"><!--[--><!--]--> 데이터팀의 구성 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/en/logs/tech/awskrug-data-science/#질문-답변" class="router-link-active router-link-exact-active sidebar-item" aria-label="질문/답변"><!--[--><!--]--> 질문/답변 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/en/logs/tech/naver-opensource/" class="sidebar-item" aria-label="Opensource used by NAVER"><!--[--><!--]--> Opensource used by NAVER <!--[--><!--]--></a><!----></li><li><a href="/en/logs/tech/rust-devops/" class="sidebar-item" aria-label="Devops &amp; mental If you leave it unattended, it&#39;ll rust!"><!--[--><!--]--> Devops &amp; mental If you leave it unattended, it&#39;ll rust! <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Travel <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/en/logs/travel/meplace.html" class="sidebar-item" aria-label="MEPLACE"><!--[--><!--]--> MEPLACE <!--[--><!--]--></a><!----></li><li><a href="/en/logs/travel/%EC%A0%95%EC%88%99%EC%84%B1.html" class="sidebar-item" aria-label="JUNGSOOKSUNG"><!--[--><!--]--> JUNGSOOKSUNG <!--[--><!--]--></a><!----></li><li><a href="/en/logs/travel/diet/" class="sidebar-item" aria-label="DIET"><!--[--><!--]--> DIET <!--[--><!--]--></a><!----></li><li><a href="/en/logs/travel/naverunion.html" class="sidebar-item" aria-label="UNION"><!--[--><!--]--> UNION <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Korean culture <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/en/logs/korean-culture/" class="sidebar-item" aria-label="KOREAN CULTURE"><!--[--><!--]--> KOREAN CULTURE <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">ZIP(blog,con) <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/en/logs/gather/" class="sidebar-item" aria-label="Zip(blog,con,opensource)"><!--[--><!--]--> Zip(blog,con,opensource) <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">about <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/en/logs/about/me/resume.html" class="sidebar-item" aria-label="ME"><!--[--><!--]--> ME <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Writing <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/en/logs/writing/1987/" class="sidebar-item" aria-label="1987 or 1784"><!--[--><!--]--> 1987 or 1784 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="airflow-ecs-bigquery" tabindex="-1"><a class="header-anchor" href="#airflow-ecs-bigquery" aria-hidden="true">#</a> Airflow + ECS + Bigquery</h1><div class="custom-container tip"><p class="custom-container-title">2022/12/14 19:00 ~ 21:00, in AWS Korea</p><ul><li>https://www.facebook.com/groups/awskrug 에서 진행</li><li>AWSKRUG -&gt; AWS KOREA USER GROUP</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>데이터팀에서 Amazon ECS 로 Airflow 홀로 서기 - 최종원(원티드랩)
혼자서 데이터 분석 클러스터를 운영하는 입장에서
Amazon ECS 를 활용하여 데이터팀 내에 Airflow 인프라와
비즈니스 코드를 분리하고 안정적인 문화로 정착시킨 사례를 소개합니다. 
운영하면서 발생한 기술적 이슈를 해결하는 과정뿐만 아니라
팀 문화 및 프로세스 관점으로도 살펴봅니다.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>속기록 버전으로 오타 및 오기가 좀 있습니다. 참가자 분들의 기억 소환을 위해 작성되었습니다.</li><li><a href="https://github.com/log-diginori/log-diginori.github.io/wiki/Collaboration-Guide-:::-loG" target="_blank" rel="noopener noreferrer">Collaboration Guide<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 를 참고하여 교정 및 보강 PR 을 주신다면 진심으로 감사드리겠습니다.</li></ul></div><p><img src="/assets/aws-airflow.26c08d10.jpeg" alt="awskrug airflow"></p><h3 id="참가신청" tabindex="-1"><a class="header-anchor" href="#참가신청" aria-hidden="true">#</a> 참가신청</h3><ul><li>페이스북에서 보고 밋업앱에서 참가신청 / aws 입주건물 출입이 까다로우니 밋업 안내에 따라 2틀전에 신청해야 함 - 아니면 보안 통과 까다로움 / 배움앞에 포기란 없지!</li></ul><h3 id="pip" tabindex="-1"><a class="header-anchor" href="#pip" aria-hidden="true">#</a> pip</h3><ul><li>분석 관련 팩키지를 airflow 가 돌기전에 docker 에서 미리 설치함</li></ul><h3 id="ecs" tabindex="-1"><a class="header-anchor" href="#ecs" aria-hidden="true">#</a> ECS</h3><ul><li>EC2 와 달리 블루그린 배포만 가능함 - 블루그린이 서비스가 다 떠야 해서 느림</li></ul><h3 id="inplace-dag-배포" tabindex="-1"><a class="header-anchor" href="#inplace-dag-배포" aria-hidden="true">#</a> Inplace DAG 배포</h3><ul><li>스케줄러가 이미 주기적으로 DAG 를 폴링</li><li>DAG 디렉터리 내부만 덮어쓰면</li></ul><h3 id="codebuild" tabindex="-1"><a class="header-anchor" href="#codebuild" aria-hidden="true">#</a> Codebuild</h3><ul><li>빌드속도를 빠르게 할려고 EFS 를 마운트 시켜두고 Codebuild 복사</li><li>배포속도 70초 완성</li><li>모든 인스턴스가 EFS 가 공유하므로 한 곳에 복사하면 끝! <img src="/assets/aws-efs.1d594c9a.jpeg" alt="awskrug efs"></li></ul><h3 id="서비스는-블루그린으로-배포해도-무방" tabindex="-1"><a class="header-anchor" href="#서비스는-블루그린으로-배포해도-무방" aria-hidden="true">#</a> 서비스는 블루그린으로 배포해도 무방</h3><h3 id="airflow-의존성-라이브러리" tabindex="-1"><a class="header-anchor" href="#airflow-의존성-라이브러리" aria-hidden="true">#</a> Airflow 의존성 라이브러리</h3><ul><li>기본으로 깔면 뭔가 많이 설치한다.</li><li>생각보다 많은 패키지가 많이 설치되어 있다.</li><li>pendulum - 날짜의 덧샘 뺄샘 타임존</li><li>tenacity - @retray - 알아서 다시 실행 - dag 가 빨강이 되는 일이 없다</li></ul><h3 id="자동화란" tabindex="-1"><a class="header-anchor" href="#자동화란" aria-hidden="true">#</a> 자동화란</h3><ul><li>자동화의 추상화만 잘되어 있으면 중복 작업이 없어진다.</li><li>메타데이터를 만드는 것이 추상화</li><li>만들어진 메타데이터가 ... 그것이 자동화</li></ul><h3 id="서비스-검색" tabindex="-1"><a class="header-anchor" href="#서비스-검색" aria-hidden="true">#</a> 서비스 검색</h3><ul><li>ECS 의 기능 중에 federman.wanted ... 라우터13에 연결되어 내부 서비스에 접근이 가능하다. 이상한 ip 매번 안치고 들어가도 된다.</li></ul><h3 id="타-팀과의-협업" tabindex="-1"><a class="header-anchor" href="#타-팀과의-협업" aria-hidden="true">#</a> 타 팀과의 협업</h3><ul><li>코드가 커밋되면 알아서 돈다.</li><li>db 만 제공하고 api 는 각자 만들어라. - api 까지 만들면 장애대응 까지 해야 하니까 / 그건 개발자의 일~ <img src="/assets/aws-co.a585b941.jpeg" alt="awskrug efs"></li></ul><h3 id="데이터팀의-구성" tabindex="-1"><a class="header-anchor" href="#데이터팀의-구성" aria-hidden="true">#</a> 데이터팀의 구성</h3><ul><li>애자일이 성숙화 되지 않았다. 아직</li><li>로우 데이터만 있으면 잘못 되더라도 다시 쭈욱 돌리면 다시 된다.</li><li>로우 데이터가 없으면 작업을 다시할때 일이 커진다 - 로우 데이터를 피처스토어에 저장했다</li><li>데이터팀은 제품도 아니고 비지니스도 아니다. 그래서 모호하다. 데이터팀이 제품팀에 들어간 곳도 많지만 ...</li><li>각자 조그만 회사에서 혼자 일하다 보니 히스토리를 전승하지 못하여 오늘 같은 공유 자리가 좋은거 같다</li></ul><h3 id="질문-답변" tabindex="-1"><a class="header-anchor" href="#질문-답변" aria-hidden="true">#</a> 질문/답변</h3><ul><li><p>매일 덤프로 데이터를 넣는다고 하는데요. 중복 데이터 문제는 ? 멱등성 rdb 미러링 -&gt; 리플레이스 하여 중복해결 cdc -&gt; mysql ... 빅로그를 디비로 저장하면서 멱등성을 보장했다. / 서비스 디비가 아니니까 있는걸 다 지우고 / 하루마다 전체를 다 ... 해서 중복을 피했다. 서비스가 아니므로 가능했다.</p></li><li><p>rds 에 있는 스냅샷을 s3 로 parquet 로 만들어서 - 해당 api 에도 멱등성 옵션이 있어서 중복된 시간에 돌리면 알아서 안돌고 처리가 된다.</p></li><li><p>분석가들이 로컬에서 테스트 한다고 하는데 코어부분 테스트는 어떻게 하셨나요? 코어 부분도 비슷하게 하였다. 테스트 프레임워크도 중요하지만 github action 으로 ci 를 구축했고 센드박스 환경을 만들어서 ... 했다. 주로 서드파티 관련 에러가 나는 문제는 cli 를 똑 같이 실행하면 다시 문제가 발생하여 처리 가능했다.</p></li><li><p>로컬에서 분석가들이 개발을 하고 리뷰를 받아서 최종적으로 ecs 올려서 사용한는데 로컬에서 문제 없던 것이 ecs(docker) 환경에서 문제 되는것은 없엇나? 그런 적은 별로 없엇다. pip 가 동기화 되도록 서버 환경과 같이 강제로 업데이트를 개발자 환경에 실행 되도록 하였다. 테스트가 똑같이 돌아가는 것도 중요하지만 ci 쪽으로 테스트를 작성하여 풀엇다.</p></li><li><p>ecs 컨테이너 크기는 어떻게 되나? 한 1G 2G pip 만 하는 것은 1G - 컨테이너 뜨는 속도는 많이 느리지만 매번 업데이트는 없어졌다. 이렇게 하면 최신을 설치하게 된다.</p></li><li><p>넘파이 같은 것들이 분기에 한번은 디펜던시 문제로 속썩이는 적이 있다 - AMI 로 구워버리기도 하지만 ... 그것이 답은 아닌거 같다.</p></li><li><p>airflow 의 사용 디비인 메타스토어의 이중화를 했나? 운영하다 보니 airflow 버그로 잘못된 정보가 메타스토어에 들어가면 airflow 가 죽는 문제가 있었다. 어떻게 했나? 디비에서 직접 지워주지 않으면 계속 dag 가 죽어있다. 이 문제를 어떻게 해결했나? rds 서비리스 사용하여 ha 고민은 하지 않았다.</p></li><li><p>딥큐라는 라이브러리를 사용해서 시간단위로 ...</p></li><li><p>타임싱크 - dag test ... ? 이그잼플 dag 를 테스트 2.0 부터 ... 안도는 테스크가 있을 수 있죠. 리펙토링 한번 하면 원본 dag 가 바뀌고</p></li><li><p>task 가 실패하면 콜백으로 슬랙으로 보내줄수 있지 않나? 왜 그렇게 하지 않았나? 분석가가 보지 않아 구성하지 않았다. 실패한 작업은 센트리로 보내고 최소한 dag 를 최소한 간소하게 만들어 운영함 / 그래서 단순한 dag 가 실패한</p></li><li><p><a href="https://open.sentry.io/" target="_blank" rel="noopener noreferrer">센트리 sentry<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 는 모니터링 툴이다. 그쪽으로 데이터를 넣으면 알아서 알람을 보내준다.</p></li><li><p>ecs 에서 스파크를 쓰시나요? 안써요.</p></li><li><p>비용절감은 어떻게 하셨나요? 파게이트 빅쿼리로 보다 최소한의 램을 구성해서</p></li><li><p>빅쿼리로 밀어 넣는 데이터 양은? 안생각봤다 구글에서 넣는건 무료라 ...</p></li><li><p>버전업 할때 200개 dag 가 있다고 하셨는데 문제가 없나요? 노하우가 있을까요? 스테이징 영역이 따로(2개 만들어) 있어서 거기 먼저 올려서 에러를 잡고 갔다. 프로덕션에도 나지만 이렇게 걸러지면 많이 줄어든다.</p></li><li><p>ec2 에서 ecs 로 전환 하는데 얼마나 걸렸나? 안정화는? 3개월 efs 문제 클라우드워치도 ... eks 로 했다면 더 오래 걸렸을 것이다.</p></li><li><p>ec2 닭잡는 ecs 소잡는칼 eks 기관총</p></li><li><p>airflow + 빅쿼리(?) + 서드파티 문제가 있다. 한달전쯤 빅쿼리와 관련된 발표를 한다.</p></li><li><p>ecs 가 삶의 질을 향상시켜 주니까 - 버전이 너무 옛날이다. 파이썬 3.12 를 쓰고 싶다. 빠르다니까. 스테이징에 올려서 테스트 하고 있다.</p></li><li><p>3.12 등 올리면 전체 dag 테스트 하느냐? stg 에서 모드 한다.</p></li><li><p>저의 같은 경우는 test dag 를 정의하고 off 해두고 분석가가 짠 스크립트를 pr 로 올려두고 on 하면 돌아가도록 되어 있다. - emr 로 airflow 돌리니까 로딩만 오래걸려서 하기때문에 분석가들이 싫어한다.</p></li><li><p>ecs 를 썻기때문에 로컬에서 돌면 똑같이 돈다. 멱등성만 신경써서 ... emr 아닌거라 ... ecs 를 emr 처럼 썻다. 그리고 대부분 자원은 빅쿼리로 썻다. 쿼리를 해두면 임시테이블이 만들어 지거나 이런 작업은 1cpu 8g 메모리</p></li><li><p>스팟으로 해도 되지 않나요? 안해봤지만 조망간 벡로그에 들어갈것이다.</p></li><li><p>자동차 부붐 공정에서 자체 운영중인 oracle 등 rdb 의 증분 데이터를 일배치로 AWS 에 올리는 방법은? <a href="https://sqoop.apache.org/" target="_blank" rel="noopener noreferrer">Apache Sqoop, 관계형 데이터베이스와 같은 구조화된 데이터 저장소 간에 대량 데이터를 효율적으로 전송하도록 설계된 도구<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 을 활용(네이버 예)</p></li><li><p>녹화본은 <a href="https://www.youtube.com/c/awskrug" target="_blank" rel="noopener noreferrer">YouTube AWS 한국사용자모임 - AWSKRUG<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>에 올릴 예정.</p></li></ul><p><img src="/assets/aws-cup.1baf7e1a.jpeg" alt="awskrug efs"></p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/en/logs/tech/agile/" class="" aria-label="AGILE ARGUMENT"><!--[--><!--]--> AGILE ARGUMENT <!--[--><!--]--></a></span><span class="next"><a href="/en/logs/tech/naver-opensource/" class="" aria-label="Opensource used by NAVER"><!--[--><!--]--> Opensource used by NAVER <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.7f66a962.js" defer></script>
  </body>
</html>
