;/*FB_PKG_DELIM*/

__d("LSFilteredThreadsRangesQuery",["LSGetCursor","LSIssueNewTaskAndGetTaskID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.i64.neq(a[10],f)?d[0]=a[10]:d[0]=[0,0],a[11]!==f?d[1]=a[11]:d[1]="",(a[2]&&c.i64.neq(a[7],f)&&c.i64.neq(a[4],f)||a[3]&&c.i64.neq(a[6],f)&&c.i64.neq(a[5],f))&&!(a[2]&&c.i64.neq(a[7],f)&&c.i64.neq(a[4],f)&&a[3]&&c.i64.neq(a[6],f)&&c.i64.neq(a[5],f))?c.seq([function(e){return d[3]=a[4]==null?[-2147483648,0]:a[4],d[4]=a[7]==null?[0,1]:a[7],d[10]=c.i64.gt(d[4],[0,1])&&c.i64.gt(d[3],[-2147483648,0]),c.sp(b("LSGetCursor"),[0,1]).then(function(a){return a=a,d[2]=a[0],a})},function(e){return d[5]=new c.Map(),d[5].set("cursor",d[2]),d[5].set("filter",a[1]),d[5].set("is_after",a[3]),d[5].set("parent_thread_key",a[0]),d[5].set("reference_activity_timestamp",a[3]?a[6]:a[7]),d[5].set("reference_thread_key",a[3]?a[5]:a[4]),d[5].set("secondary_filter",d[0]),d[5].set("filter_value",d[1]),c.i64.gt([0,0],[0,0])?d[6]=c.i64.add(c.i64.of_float(Date.now()),[0,0]):d[6]=[0,0],d[7]=c.toJSON(d[5]),c.sp(b("LSIssueNewTaskAndGetTaskID"),"trq",[0,313],d[7],f,f,[0,0],[0,0],f,f,d[6]).then(function(a){return a=a,d[8]=a[0],a})},function(b){return c.ftr(c.db.table(247).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.parentThreadKey,a[0])&&c.i64.eq(b.threadRangeFilter,a[1])&&c.i64.eq(b.secondaryThreadRangeFilter,d[0])&&b.threadRangeFilterValue===d[1]}).next().then(function(b,e){e=b.done;b=b.value;return e?c.db.table(247).add({folderName:"",parentThreadKey:a[0],minThreadKey:d[3]==null?[-2147483648,0]:d[3],minLastActivityTimestampMs:d[4]==null?[0,1]:d[4],threadRangeFilter:a[1],secondaryThreadRangeFilter:d[0],threadRangeFilterValue:d[1],maxLastActivityTimestampMs:[0,1],maxThreadKey:[-2147483648,0],isLoadingBefore:d[10],isLoadingAfter:!1,hasMoreBefore:d[10],hasMoreAfter:!1}):(b.item,c.fe(c.ftr(c.db.table(247).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.parentThreadKey,a[0])&&c.i64.eq(b.threadRangeFilter,a[1])&&c.i64.eq(b.secondaryThreadRangeFilter,d[0])&&b.threadRangeFilterValue===d[1]}),function(a){var b=a.update;a.item;return b({isLoadingBefore:!0,isLoadingAfter:!1,hasMoreBefore:d[10],hasMoreAfter:!1})}))})}]):c.resolve()},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSUpdateCommunityChannelDirectInvite",["LSIssueNewError","LSIssueNewTaskAndGetTaskID"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(a){return c.sb(c.db.table(115).fetch(),[["timestampMs","DESC"]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[0]=!1:(b=a.item,d[0]=b.errorShouldBeShown)})},function(a){return d[0]===!0?c.seq([function(a){return c.localizeV2Async([0,2285622730],f).then(function(a){return d[11]=a})},function(a){return c.localizeV2Async([0,1919524925],f).then(function(a){return d[12]=a})},function(a){return c.sp(b("LSIssueNewError"),f,[0,1545093],d[11],d[12],f)}]):c.resolve()},function(e){return d[2]=new c.Map(),d[2].set("channel_id",a[0]),d[2].set("state",a[1]),c.i64.gt([0,0],[0,0])?d[3]=c.i64.add(c.i64.of_float(Date.now()),[0,0]):d[3]=[0,0],d[4]=d[2].get("channel_id"),d[2],d[5]=c.toJSON(d[2]),c.sp(b("LSIssueNewTaskAndGetTaskID"),["community_channel_invitation","_",c.i64.to_string(d[4])].join(""),[0,463],d[5],f,f,[0,0],[0,0],f,f,d[3]).then(function(a){return a=a,d[6]=a[0],a})},function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[7]=[-1,4294967295]:(b=a.item,d[7]=b.parentThreadKey)})},function(a){return c.db.table(162).fetch([[[d[7]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[9]=[-1,4294967295]:(b=a.item,d[9]=b.fbGroupId)})},function(b){return c.i64.eq(a[1],[0,1])?c.fe(c.ftr(c.db.table(162).fetch(),function(a){return c.i64.eq(a.fbGroupId,d[9])}),function(a){var b=a.update;a.item;return b({joiningChannelTaskId:d[6]})}):c.resolve()}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("CometMessagingJewelCommunitiesQPBannerContainerQuery.graphql",["CometMessagingJewelCommunitiesQPBannerContainerQuery_facebookRelayOperation","relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"Literal",name:"surface_nux_id",value:10713},{kind:"Literal",name:"trigger",value:"MESSAGING_JEWEL_COMMUNITIES_TAB_OPEN"}],c=[{kind:"Literal",name:"supported",value:["CometQuickPromotionMessengerWebCommunitiesBannerRendererStrategy"]}],d={kind:"InlineFragment",selections:[{args:null,documentName:"CometMessagingJewelCommunitiesQPBannerContainerQuery",fragmentName:"CometQuickPromotionMessengerWebCommunitiesBannerRendererStrategy_quickPromotionRef",fragmentPropName:"quickPromotionRef",kind:"ModuleImport"}],type:"CometQuickPromotionMessengerWebCommunitiesBannerRendererStrategy",abstractKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometMessagingJewelCommunitiesQPBannerContainerQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:a,concreteType:"ViewerEligibleQuickPromotionsConnection",kind:"LinkedField",name:"eligible_promotions",plural:!1,selections:[{alias:null,args:null,concreteType:"QuickPromotion",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,concreteType:"CometQuickPromotionSections",kind:"LinkedField",name:"comet_qp_sections",plural:!1,selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"renderer_strategy",plural:!1,selections:[d],storageKey:'renderer_strategy(supported:["CometQuickPromotionMessengerWebCommunitiesBannerRendererStrategy"])'}],storageKey:null}],storageKey:null}],storageKey:'eligible_promotions(surface_nux_id:10713,trigger:"MESSAGING_JEWEL_COMMUNITIES_TAB_OPEN")'}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"CometMessagingJewelCommunitiesQPBannerContainerQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:a,concreteType:"ViewerEligibleQuickPromotionsConnection",kind:"LinkedField",name:"eligible_promotions",plural:!1,selections:[{alias:null,args:null,concreteType:"QuickPromotion",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,concreteType:"CometQuickPromotionSections",kind:"LinkedField",name:"comet_qp_sections",plural:!1,selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"renderer_strategy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},d],storageKey:'renderer_strategy(supported:["CometQuickPromotionMessengerWebCommunitiesBannerRendererStrategy"])'}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:'eligible_promotions(surface_nux_id:10713,trigger:"MESSAGING_JEWEL_COMMUNITIES_TAB_OPEN")'}],storageKey:null}]},params:{id:b("CometMessagingJewelCommunitiesQPBannerContainerQuery_facebookRelayOperation"),metadata:{},name:"CometMessagingJewelCommunitiesQPBannerContainerQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("MessengerCheckmark.svg.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){return h.jsxs("svg",babelHelpers["extends"]({fill:"currentColor",viewBox:"0 0 36 36",width:"1em",height:"1em"},a,{children:[a.title!=null&&h.jsx("title",{children:a.title}),a.children!=null&&h.jsx("defs",{children:a.children}),h.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M26.378 9.169c.597.347.8 1.112.453 1.709l-9 15.5a1.25 1.25 0 0 1-1.965.256l-6.5-6.5a1.25 1.25 0 1 1 1.768-1.768l5.121 5.121a.25.25 0 0 0 .393-.05L24.67 9.621a1.25 1.25 0 0 1 1.709-.453z"})]}))}a.displayName=a.name+" [from "+f.id+"]";a._isSVG=!0;b=a;g["default"]=b}),98);
__d("CometMessagingJewelCommunitiesQPBannerContainer.react",["CometMessagingJewelCommunitiesQPBannerContainerQuery.graphql","CometMessagingJewelDropdownQPBannerPlaceholder.react","CometPlaceholder.react","CometQuickPromotionLoggerContext.react","CometRelay","react","useQuickPromotionFalcoEvent"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react");function a(a){var e=a.messagingEntryPoint,f=a.onClose;a=a.queryRef;a=d("CometRelay").usePreloadedQuery(h!==void 0?h:h=b("CometMessagingJewelCommunitiesQPBannerContainerQuery.graphql"),a);var g=c("useQuickPromotionFalcoEvent")({context_surface_id:10713,context_trigger:"messaging_jewel_communities_tab_open"});a=a==null?void 0:(a=a.viewer)==null?void 0:(a=a.eligible_promotions)==null?void 0:(a=a.nodes)==null?void 0:a.find(function(a){return((a=a.comet_qp_sections)==null?void 0:a.renderer_strategy)!=null});a=a==null?void 0:(a=a.comet_qp_sections)==null?void 0:a.renderer_strategy;return a==null?null:i.jsx(c("CometPlaceholder.react"),{fallback:i.jsx(c("CometMessagingJewelDropdownQPBannerPlaceholder.react"),{}),children:i.jsx(c("CometQuickPromotionLoggerContext.react").Provider,{value:g,children:i.jsx(d("CometRelay").MatchContainer,{match:a,props:{messagingEntryPoint:e,onClose:f}})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWInboxContextSwitcherGlimmer.react",["BaseGlimmer.react","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i={tabPlaceholder:{borderTopStartRadius:"x1tlxs6b",borderTopEndRadius:"x1g8br2z",borderBottomEndRadius:"x1gn5b1j",borderBottomStartRadius:"x230xth",display:"x78zum5",flexDirection:"xdt5ytf",flexGrow:"x1iyjqo2",justifyContent:"xl56j7k",$$css:!0},tabPlaceholderRoot:{display:"x78zum5",minHeight:"xu0aao5",paddingStart:"x1swvt13",paddingEnd:"x1pi30zi",paddingTop:"x1y1aw1k",paddingBottom:"xwib8y2",width:"x3bhodz",$$css:!0}};function a(a){a=a.xstyle;a=a===void 0?i.tabPlaceholderRoot:a;return h.jsx("div",{className:c("stylex")(a),children:h.jsx(c("BaseGlimmer.react"),{index:0,xstyle:i.tabPlaceholder})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWInboxQuickPromotionWrapper.react",["CometErrorBoundary.react","CometPlaceholder.react","cr:108","deferredLoadComponent","react","requireDeferredForDisplay"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=c("deferredLoadComponent")(c("requireDeferredForDisplay")("MAWUserVisibleErrorsNuxWrapper.react").__setRef("MWInboxQuickPromotionWrapper.react")),j=(e=b("cr:108"))!=null?e:h.Fragment;function a(a){var b=a.children;a=a.onError;return h.jsx(c("CometErrorBoundary.react"),{onError:a,children:h.jsx(c("CometPlaceholder.react"),{fallback:null,children:h.jsx(i,{children:h.jsx(j,{children:b})})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWJewelDropdownHeaderSeeAllButton.react",["fbt","ix","CometTooltip.react","TetraCircleButton.react","fbicon","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react");function a(a){var b=a.onClose,e=a.testid;e=a.url;a=h._("__JHASH__oavSR1mxJiV__JHASH__");return j.jsx(c("CometTooltip.react"),{align:"end",tooltip:a,children:j.jsx(c("TetraCircleButton.react"),{color:"secondary",icon:d("fbicon")._(i("580260"),20),label:a,linkProps:{url:e},onPress:b,size:32,testid:void 0,type:"deemphasized"})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWJewelMessengerLink.react",["fbt","CometLink.react","TetraText.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(a){var b=a.onClick;a=a.url;return i.jsx("div",{className:"xlsxne2 x1l90r2v x1i80of2","data-testid":void 0,children:i.jsx(c("TetraText.react"),{align:"center",color:"blueLink",type:"bodyLink3",children:i.jsx(c("CometLink.react"),{href:a,onClick:b,children:h._("__JHASH__oavSR1mxJiV__JHASH__")})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWJewelThreadSnippet.react",["CurrentEnvironment","MDSText.react","TetraText.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.isUnread;a=a.text;return b?c("CurrentEnvironment").facebookdotcom?h.jsx(c("TetraText.react"),{color:"highlight",numberOfLines:1,type:"bodyLink4",children:a}):c("MDSText.react")!=null?h.jsx(c("MDSText.react"),{color:"primary",numberOfLines:1,type:"entityHeaderMeta3",children:a}):h.jsx(c("TetraText.react"),{color:"primary",numberOfLines:1,type:"bodyLink4",children:a}):h.jsx(c("TetraText.react"),{color:"secondary",numberOfLines:1,type:"body4",children:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWJewelMessageRequestsThread.react",["fbt","ix","I64","Locale","LsSystemFolderInterop.bs","MWJewelThreadSnippet.react","ReQL","ReQLSuspense","TetraIcon.react","TetraListCell.react","fbicon","react","useReStore"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react"),k=function(){var a=c("useReStore")();return d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableDescending(a.table("threads").index("parentThreadKeyLastActivityTimestampMs")).getKeyRange(d("LsSystemFolderInterop.bs").pending).filter(function(a){return d("I64").gt(a.lastActivityTimestampMs,a.lastReadWatermarkTimestampMs)}).map(function(b){b=b.snippetSenderContactId;if(b!=null){b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(a.table("contacts")).getKeyRange(b));return b?b.name:void 0}})},[a])};function a(a){var b=a.onOpenMessageRequests;a=a.unreadRequestsCount;var e=h._("__JHASH__SQMsXxQB2ND__JHASH__",[h._plural(a)]),f=h._("__JHASH__jhOYdnXiHj7__JHASH__",[h._enum(a===1?"someone":"people",{someone:"someone",people:"people"})]),g=k();g!=null&&(a===1?f=h._("__JHASH__Lhb1JePxKuz__JHASH__",[h._param("name",g)]):f=h._("__JHASH__CG_5_9rh3Rj__JHASH__",[h._param("name",g),h._param("count",a-1)]));return j.jsx(c("TetraListCell.react"),{addOnPrimary:{icon:d("fbicon")._(i("542884"),24),size:56,type:"contained-icon"},addOnSecondary:{addOn:j.jsx(c("TetraIcon.react"),{color:"secondary",icon:d("Locale").isRTL()?d("fbicon")._(i("492485"),16):d("fbicon")._(i("492533"),16)}),type:"body"},body:j.jsx(c("MWJewelThreadSnippet.react"),{isUnread:!0,text:f}),headline:e,level:4,onPress:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWLSLoadThreadFolderIfNotPresent.bs",["CancellablePromise.bs","CancellationToken.bs","MWLSJewelLoadMoreThreads.bs","Promise","ReQL.bs","bs_caml","promiseDone","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var e=c("useReStore")(),f=d("MWLSJewelLoadMoreThreads.bs").useHook(a);h.useEffect(function(){var g=d("CancellationToken.bs").make(),h=d("CancellablePromise.bs").ignoreFailed(void 0,d("CancellablePromise.bs").then_(g,function(a){a!==void 0||f();return b("Promise").resolve()},d("ReQL.bs").first(d("ReQL.bs").filter(d("ReQL.bs").fromTableAscending(e.table("threads_ranges_v2__generated")),function(b){return c("bs_caml").i64_eq(b.parentThreadKey,a)}))));c("promiseDone")(h);return g.cancel},[f,e,JSON.stringify(a)])}g.useHook=a}),98);
__d("MWLSJewelMessageRequestsThread.bs",["LsSystemFolder.bs","MWJewelMessageRequestsThread.react","MWLSLoadThreadFolderIfNotPresent.bs","MWPActor.bs","ReQL.bs","ReQLSubscription.bs","bs_caml","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b={make:c("MWJewelMessageRequestsThread.react")};function i(a){var b=c("useReStore")();a=d("MWPActor.bs").useActor();a=h.useMemo(function(){return d("ReQL.bs").filter(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromIndexDescending(b.table("threads").index("parentThreadKeyLastActivityTimestampMs")),{hd:d("LsSystemFolder.bs").pending,tl:0}),function(a){return c("bs_caml").i64_gt(a.lastActivityTimestampMs,a.lastReadWatermarkTimestampMs)})},[b,JSON.stringify(a)]);return d("ReQLSubscription.bs").useArray(a).length}function a(a){d("MWLSLoadThreadFolderIfNotPresent.bs").useHook(d("LsSystemFolder.bs").pending);var b=i();if(a!==void 0&&b>0)return h.jsx(c("MWJewelMessageRequestsThread.react"),{onOpenMessageRequests:a,unreadRequestsCount:b});else return null}g.RequestsThread=b;g.useHook=a}),98);
__d("LSThreadRangeFilter.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];b=[0,4];var g=[0,5],h=[0,6],i=[0,7],j=[0,8];f.none=a;f.unreadOnly=c;f.groupsOnly=d;f.igdProPrimary=e;f.igdProGeneral=b;f.pinned=g;f.readButUnresponded=h;f.threadChatLabel=i;f.businessInboxFollowUp=j}),null);
__d("LSThreadRangeFilter.re",["LSThreadRangeFilter.bs"],(function(a,b,c,d,e,f){c=(a=b("LSThreadRangeFilter.bs")).none;f.none=c;d=a.unreadOnly;f.unreadOnly=d;e=a.groupsOnly;f.groupsOnly=e;b=a.igdProPrimary;f.igdProPrimary=b;c=a.igdProGeneral;f.igdProGeneral=c;d=a.pinned;f.pinned=d;e=a.readButUnresponded;f.readButUnresponded=e;b=a.threadChatLabel;f.threadChatLabel=b;c=a.businessInboxFollowUp;f.businessInboxFollowUp=c}),null);
__d("MWThreadListFocusableTable.react",["FocusTable.react","focusScopeQueries","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");a=d("FocusTable.react").createFocusTable(d("focusScopeQueries").tabbableScopeQuery);var i=a[0];b=a[1];c=a[2];e=function(a){return h.jsx(i,{allowModifiers:!0,tabScopeQuery:d("focusScopeQueries").tabbableScopeQuery,wrapX:!0,children:a.children})};g.MWThreadListFocusableTableRow=b;g.MWThreadListFocusableTableCell=c;g.MWThreadListFocusableTableScopeQuery=d("focusScopeQueries").tabbableScopeQuery;g.MWThreadListFocusableTable=e}),98);
__d("MWPBaseThreadList.react",["I64","LS.re","LSFilteredThreadsRangesQuery","LSThreadRangeFilter.re","LSThreadsRangesQuery","MWIsXacGroupThread.bs","MWPFolderFocusedManager.bs","MWPMarkSeen.bs","MWThreadListFocusableTable.react","MWThreadListSupportedThreadTypes.bs","MWXacGating.bs","ReQL","ReQLPaginatedList.react","ReQLSuspense","UserActivity","gkx","justknobx","promiseDone","react","regeneratorRuntime","useReStore","useSimpleImpression","useVisibilityObserver"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");e=d("react");var i=e.useCallback,j=e.useEffect,k=e.useMemo,l=e.useRef,m={container:{display:"x78zum5",flexDirection:"xdt5ytf",flexGrow:"x1iyjqo2",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0},emptyContentContainer:{alignItems:"x6s0dn4",display:"x78zum5",flexGrow:"x1iyjqo2",justifyContent:"xl56j7k",$$css:!0},list:{display:"x78zum5",flexDirection:"xdt5ytf",flexGrow:"x1iyjqo2",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0}};function n(a,e,f){c("promiseDone")(a.runInTransaction(function(a){var g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:h.next=2;return b("regeneratorRuntime").awrap(a.table("threads_ranges_v2__generated").get(e));case 2:g=h.sent;if(!(g==null||g.isLoadingBefore)){h.next=5;break}return h.abrupt("return");case 5:f&&f();return h.abrupt("return",c("LSThreadsRangesQuery")(g.parentThreadKey,!0,!1,g.minThreadKey,g.maxThreadKey,g.maxLastActivityTimestampMs,g.minLastActivityTimestampMs,d("I64").zero,c("LS.re").make(a)));case 7:case"end":return h.stop()}},null,this)},"readwrite"))}function o(a,e,f,g,h){f===void 0&&(f=d("LSThreadRangeFilter.re").none),g===void 0&&(g=d("LSThreadRangeFilter.re").none),c("promiseDone")(a.runInTransaction(function(a){var d;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b("regeneratorRuntime").awrap(a.table("filtered_threads_ranges_v3__generated").get(e));case 2:d=i.sent;if(!(d==null||d.isLoadingBefore)){i.next=5;break}return i.abrupt("return");case 5:h&&h();return i.abrupt("return",c("LSFilteredThreadsRangesQuery")(d.parentThreadKey,f,!0,!1,d.minThreadKey,d.maxThreadKey,d.maxLastActivityTimestampMs,d.minLastActivityTimestampMs,void 0,void 0,g,void 0,c("LS.re").make(a)));case 7:case"end":return i.stop()}},null,this)},"readwrite"))}function a(a){var b=a.afterContent,e=a.beforeContent,f=a.customThreadFilter_DO_NOT_USE,g=a.emptyContent,p=a.filter,q=a.gridLabel,r=a.onLoadMoreThreads,s=a.onThreadsLoaded,t=a.parentThreadKey,u=a.renderItem,v=a.renderLoadingAnimation,w=a.scrollAreaElementRef,x=a.secondaryFilter,y=a.setIsEmptyInbox,z=c("useReStore")(),A=d("ReQLSuspense").useFirst(function(){if(p==null)return d("ReQL").fromTableDescending(z.table("threads_ranges_v2__generated")).getKeyRange(t);else return d("ReQL").fromTableDescending(z.table("filtered_threads_ranges_v3__generated")).getKeyRange(t).filter(function(a){return d("I64").equal(a.threadRangeFilter,p)&&(!x||d("I64").equal(a.secondaryThreadRangeFilter,x))})},[z,t,p,x]),B=d("ReQLSuspense").useArray(function(){return d("ReQL").fromTableAscending(z.table("pinned_threads").index("pinnedTimestamp"))},[z]);a=c("justknobx")._("568");A!=null&&!A.isLoadingBefore&&(s&&s());var C=A!=null?d("I64").equal(A.minLastActivityTimestampMs,d("I64").zero)||d("I64").equal(A.minLastActivityTimestampMs,d("I64").one)||(a?d("I64").equal(A.minLastActivityTimestampMs,d("I64").max_int):!1)?null:A.minLastActivityTimestampMs:null,D=A!=null?d("I64").equal(A.maxLastActivityTimestampMs,d("I64").zero)||d("I64").equal(A.maxLastActivityTimestampMs,d("I64").one)?null:A.maxLastActivityTimestampMs:null,E=k(function(){return{gte:C==null?d("ReQL").key(t):d("ReQL").key(t,C),lte:D==null?d("ReQL").key(t):d("ReQL").key(t,D)}},[D,C,JSON.stringify(t)]),F=k(function(){var a=z.table("threads").index("parentThreadKeyLastActivityTimestampMs");function b(a){return a.filter(function(a){return d("MWThreadListSupportedThreadTypes.bs").supportedThreadTypes.findIndex(function(b){return d("I64").equal(a.threadType,b)})!==-1&&(!c("gkx")("2445")||B.findIndex(function(b){return d("I64").equal(a.threadKey,b.threadKey)})===-1)&&(d("MWXacGating.bs").isGroupsEnabled()||!d("MWIsXacGroupThread.bs").check(a))&&(!f||f(a))})}var e=b(d("ReQL").fromTableAscending(a)),g=b(d("ReQL").fromTableDescending(a));return{entries:function(a,b,c){return(b==="asc"?e:g).iterator(a,c)},keyLength:e.keyLength,subscribe:function(a,b){var c=e.subscribe(function(b,c,d){return a(b,c,d)},b),d=g.subscribe(function(b,c,d){return a(b,c,d)},b);return function(){c(),d()}}}},[z,B,f]),G=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableDescending(F).bounds(E)},[E,F])==null;j(function(){y&&y(G)},[G,y]);j(function(){A==null&&c("promiseDone")(z.runInTransaction(function(a){r&&r();if(p==null)return c("LSThreadsRangesQuery")(t,!0,!1,d("I64").max_int,d("I64").max_int,d("I64").max_int,d("I64").max_int,d("I64").zero,c("LS.re").make(a));else return c("LSFilteredThreadsRangesQuery")(t,p,!0,!1,d("I64").max_int,d("I64").max_int,d("I64").max_int,d("I64").max_int,void 0,void 0,x,void 0,c("LS.re").make(a))},"readwrite"))},[JSON.stringify(t),A,z,p,x]);var H=l(!1);s=c("useVisibilityObserver")({onHidden:function(){H.current=!1},onVisible:function(){H.current=!0}});var I=d("MWPMarkSeen.bs").useHook(t);d("MWPFolderFocusedManager.bs").useWatchFocusChanges(I,H);c("useSimpleImpression")(I);j(function(){if(c("gkx")("6551"))return function(){};else return d("ReQL").fromTableDescending(z.table("threads").index("parentThreadKeyLastActivityTimestampMs")).getKeyRange(t).take(1).subscribe(function(){c("UserActivity").isOnTab()&&H.current===!0&&I()})},[z,JSON.stringify(t),I]);a=i(function(){if(A==null)return;if(!A.threadRangeFilter){var a=d("ReQL").key(A.parentThreadKey,A.minThreadKey,A.minLastActivityTimestampMs);n(z,a,r)}else{a=d("ReQL").key(A.parentThreadKey,A.minThreadKey,A.minLastActivityTimestampMs,A.threadRangeFilter,A.folderName,A.secondaryThreadRangeFilter,A.threadRangeFilterValue);o(z,a,p,x,r)}},[z,A,p,x,r]);return A==null?v!=null?v():null:h.jsx("div",{"aria-label":q,className:"x78zum5 xdt5ytf x1iyjqo2 x6ikm8r x10wlt62","data-testid":void 0,ref:s,role:"grid",children:h.jsx(d("MWThreadListFocusableTable.react").MWThreadListFocusableTable,{children:h.jsx(c("ReQLPaginatedList.react"),{bounds:E,direction:"desc",hasReachedBottom:!A.hasMoreBefore,hasReachedTop:!A.hasMoreAfter,onReachingBottom:a,renderEmptyContent:function(){return G&&!A.isLoadingAfter&&!A.isLoadingBefore?h.jsx("div",{className:"x6s0dn4 x78zum5 x1iyjqo2 xl56j7k",children:g}):null},renderFooter:function(){return b},renderHeader:function(){return e},renderItem:function(a){return h.jsx(h.Fragment,{children:u(a)},JSON.stringify(a.threadKey))},renderLoadingAnimation:v,scrollAreaElementRef:w,table:F,xstyle:m.list})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("FBGroupChatInviteState.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];d=[0,3];e=[0,4];b=[0,5];var g=[0,6];f.accepted=a;f.active=c;f.declinedByReceiver=d;f.ignoredByReceiver=e;f.deletedBySender=b;f.discarded=g}),null);
__d("MAWGroupInvitesForThread.bs",["LSMessagingThreadTypeUtil.bs","LSThreadBitOffset.bs","LSThreadCapabilityBitOffset.bs","ReQL.bs","ReQLSubscription.bs","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=c("useReStore")();return d("ReQLSubscription.bs").useArray(h.useMemo(function(){return d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableDescending(b.table("group_invites")),{hd:a.threadKey,tl:0})},[b,JSON.stringify(a.threadKey)]))}function b(a){var b=d("LSMessagingThreadTypeUtil.bs").isSecure(a.threadType),c=d("LSMessagingThreadTypeUtil.bs").isGroup(a.threadType);a=d("LSThreadBitOffset.bs").has(d("LSThreadCapabilityBitOffset.bs").messageRequestGroupInvite,a);if(b&&c)return a;else return!1}e=a;f=b;g.useValue=e;g.isGroupInviteThread=f}),98);
__d("MWPThreadListItemInviteAddOn.react",["fbt","MDSCircleButton.react","MDSRow.react","MDSRowItem.react","MWPBumpEntityKey.re","MessengerCheckmark.svg.react","MessengerCross.svg.react","SVGIcon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j=h._("__JHASH__ThY36iiMiSm__JHASH__"),k=h._("__JHASH__IQ1-ytNyqLB__JHASH__");a=function(a){var b=a.onAccept,e=a.onDecline;return i.jsxs(c("MDSRow.react"),{paddingHorizontal:0,paddingVertical:0,verticalAlign:"center",children:[i.jsx(c("MDSRowItem.react"),{children:i.jsx(c("MDSCircleButton.react"),{icon:d("SVGIcon").svgIcon(c("MessengerCheckmark.svg.react")),label:j,onPress:function(a){d("MWPBumpEntityKey.re").bumpEntityKeyWithAppId("mw.sidebar","thread_invite.accept"),b()},size:32})}),i.jsx(c("MDSRowItem.react"),{children:i.jsx(c("MDSCircleButton.react"),{icon:d("SVGIcon").svgIcon(c("MessengerCross.svg.react")),label:k,onPress:function(a){d("MWPBumpEntityKey.re").bumpEntityKeyWithAppId("mw.sidebar","thread_invite.decline"),e()},size:32})})]})};b=a;g["default"]=b}),98);
__d("MDSPushPinSvgIcon.react",["MDSSvgIcon.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){return h.jsx(c("MDSSvgIcon.react"),babelHelpers["extends"]({},a,{children:h.jsx("path",{clipRule:"evenodd",d:"M21.39 21.997a.5.5 0 0 0-.485.38l-1.663 6.65c-.322 1.292-2.162 1.291-2.484 0l-1.663-6.65a.5.5 0 0 0-.485-.38h-4.442c-.95 0-1.478-1.064-.972-1.816.419-.62 1.533-2.029 3.589-3.04a.982.982 0 0 0 .536-.811c.099-1.284.334-3.339.435-4.661a.988.988 0 0 0-.465-.918 7.136 7.136 0 0 1-2.075-1.914C10.674 8.07 11.212 7 12.163 7h11.675c.95 0 1.488 1.07.946 1.837-.31.44-.97 1.232-2.075 1.914a.99.99 0 0 0-.465.918c.102 1.322.337 3.377.435 4.661a.982.982 0 0 0 .537.812c2.055 1.01 3.17 2.419 3.588 3.04.506.751-.021 1.816-.971 1.816H21.39Z",fillRule:"evenodd"})}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWJewelThreadAddOnSecondaryIcons",["cr:1737009"],(function(a,b,c,d,e,f,g){"use strict";g.MWJewelThreadAddOnSecondaryIcons=b("cr:1737009")}),98);
__d("MWThreadAddOnSecondary.react",["fbt","CometBadge.react","CometPressable.react","CurrentEnvironment","I64","LSMediaUrl.bs","LSMessagingThreadTypeUtil.bs","MAWGating","MDSPushPinSvgIcon.react","MWJewelThreadAddOnSecondaryIcons","MWLSMarkThreadAsRead.bs","MWMessageDeliveryStatusIcons","MWPActor.bs","ReQL","ReQLSuspense","TetraOverlappingFacepileUnstyled.react","gkx","react","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function j(a){var b=c("useReStore")(),e=d("MWPActor.bs").useActor();return d("ReQLSuspense").useArray(function(){return d("ReQL").fromTableAscending(b.table("participants").index("threadKeyReadWatermarkTimestampMs")).getKeyRange(a.threadKey).bounds({gte:{hd:a.lastActivityTimestampMs,tl:0}}).filter(function(a){a=a.contactId;return!d("I64").equal(a,e)}).take(3).map(function(a){a=a.contactId;a=d("ReQLSuspense").first(d("ReQL").fromTableAscending(b.table("contacts")).getKeyRange(a));return a!=null?{alt:a.name,source:{uri:d("LSMediaUrl.bs").Contact.profilePictureUrl(a)}}:null})},[b,e,a.threadKey,a.lastActivityTimestampMs]).filter(Boolean)}function a(a){var b=a.isMuted,e=a.isPinned,f=a.isUnread,g=a.isViewerSender,k=a.lastMessageDeliveryStatusIcon;a=a.thread;var l=d("MWLSMarkThreadAsRead.bs").useHook(),m=j(a),n=[];a=d("LSMessagingThreadTypeUtil.bs").isSecure(a.threadType)&&d("LSMessagingThreadTypeUtil.bs").isGroup(a.threadType);c("gkx")("2445")&&e&&n.push(i.jsx(c("MDSPushPinSvgIcon.react"),{color:"tertiary",size:24}));b&&n.push(d("MWJewelThreadAddOnSecondaryIcons").MWJewelThreadAddOnSecondaryIcons.bell);f?n.push(i.jsx(c("CometPressable.react"),{"aria-label":h._("__JHASH__kxStFVEPa-2__JHASH__"),expanding:!0,onPress:function(a){return l()},children:i.jsx(c("CometBadge.react"),{color:"blue",isProfileBadge:!0,size:d("MAWGating").isArmadillo()&&c("CurrentEnvironment").messengerdotcom?10:12})})):g&&(m.length===0?k&&n.push(k):a?n.push(i.jsx(c("MWMessageDeliveryStatusIcons").DeliveredAndReadIcon,{size:12})):n.push(i.jsx(c("TetraOverlappingFacepileUnstyled.react"),{count:m.length,isTextInline:!0,items:m,screenReaderLabel:m.length===1?h._("__JHASH__2MhSP-AMGlO__JHASH__",[h._param("=personName",m[0].alt)]):h._("__JHASH__jJBaERf_iKB__JHASH__",[h._param("=numPeople",m.length,[0])]),size:16})));return i.jsx("div",{className:"x6s0dn4 x78zum5 xozqiw3",children:n.map(function(a,b){return i.jsxs(i.Fragment,{children:[b!==0?i.jsx("div",{className:"x1fsd2vl"}):null,a]},"item_"+b.toString(10))})})}a.displayName=a.name+" [from "+f.id+"]";b=i.memo(a);g["default"]=b}),98);
__d("MWThreadListLastMessage.bs",["fbt","CometGlimmer.react","CometMiddot.react","CometRelativeTimestamp.react","LSMessagingThreadTypeUtil.bs","MAWGating","MAWThreadCutover.bs","MDSLockSvgIcon.bs","MWJewelThreadSnippet.react","MWText.react","MWVerticalRhythm","gkx","react","useMAWOfflineQueueState"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j={bodyGlimmer:{borderTopStartRadius:"x1lq5wgf",borderTopEndRadius:"xgqcy7u",borderBottomEndRadius:"x30kzoy",borderBottomStartRadius:"x9jhf4c",height:"x1l36t39",$$css:!0},bodyGlimmerSecond:{width:"xktia5q",$$css:!0},lockIcon:{color:"xi81zsa",marginStart:"x8182xy",$$css:!0},lockIconMiddot:{marginStart:"xgzva0m",marginEnd:"xeyog9w",$$css:!0},root:{alignItems:"x6s0dn4",color:"xi81zsa",display:"x78zum5",minHeight:"x1hshjfz",$$css:!0},subtext:{whiteSpace:"xuxw1ft",$$css:!0},verticallyPaddedMiddot:{marginTop:"xdj266r",marginEnd:"xfs2ol5",marginBottom:"xat24cr",marginStart:"x12mruv9",$$css:!0}};function k(a){a=a.timestamp;return i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"xdj266r xfs2ol5 xat24cr x12mruv9",children:i.jsx(c("MWText.react"),{align:"start",color:"secondary",type:"body4",children:i.jsx(c("CometMiddot.react"),{})})}),i.jsx("span",{className:"xuxw1ft","data-testid":void 0,children:i.jsx(c("CometRelativeTimestamp.react"),{date:new Date(a),format:"minimized"})})]})}b={make:k};function l(a){return i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"xi81zsa x8182xy","data-testid":void 0,children:i.jsx(c("MDSLockSvgIcon.bs"),{color:"secondary",size:16})}),i.jsx("span",{className:"xgzva0m xeyog9w",children:i.jsx(c("MWText.react"),{align:"start",color:"secondary",type:"body4",children:i.jsx(c("CometMiddot.react"),{})})})]})}e={make:l};f={};function a(a){var b=a.hasOngoingCall,e=a.isUnread,f=a.lastMessageTimestamp,g=a.showTimestamp,m=a.snippet;a=a.thread;var n=a!==void 0?d("LSMessagingThreadTypeUtil.bs").isSecure(a.threadType):!1;a=d("MAWThreadCutover.bs").useIsCutoverSecureThread(a==null?void 0:a.threadKey);var o=c("useMAWOfflineQueueState")();if(d("MAWGating").isWebLoadStateEnabled()&&n&&o)return i.jsx(c("CometGlimmer.react"),{index:1,xstyle:[j.bodyGlimmer,j.bodyGlimmerSecond]});o=d("MAWGating").isArmadillo()&&d("MAWGating").isE2EEAttributionAndPresenceEnabled()&&n&&!(c("gkx")("3711")&&a);return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"x6s0dn4 xi81zsa x78zum5 x1hshjfz","data-testid":void 0,children:[o&&i.jsx(l,{}),i.jsx(c("MWJewelThreadSnippet.react"),{isUnread:e,text:m}),g&&f!==void 0&&f>0?i.jsx(k,{timestamp:f}):null]}),b?i.jsxs(i.Fragment,{children:[d("MAWGating").isArmadillo()?i.jsx(c("MWVerticalRhythm"),{height:5}):null,i.jsx(c("MWText.react"),{align:"start",color:"positive",numberOfLines:1,type:"body4",children:h._("__JHASH__vQgw_4Xpge6__JHASH__")})]}):null]})}a=a;b=b;e=e;a=a;g.CometGlimmer=f;g.Timestamp=b;g.LockIcon=e;g.make=a}),98);
__d("MessageRequestsBulkActionsThreadListItem.bs",["ix","CometPressable.react","JSSet.bs","MWIcon.react","MWPIsThreadUnread.bs","MWUseAriaLabelForThread.bs","MessageRequestsBulkActionsContext.react","bs_curry","bs_int64","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j={checkboxWrapper:{paddingRight:"xy13l1i",$$css:!0},pressableContent:{borderTopStartRadius:"x1lq5wgf",borderTopEndRadius:"xgqcy7u",borderBottomEndRadius:"x30kzoy",borderBottomStartRadius:"x9jhf4c",display:"x1lliihq",width:"xh8yej3",$$css:!0},selectorWrapper:{alignItems:"x6s0dn4",display:"x78zum5",paddingTop:"xexx8yu",paddingEnd:"x1iji9kk",paddingBottom:"x18d9i69",paddingStart:"x1sln4lm",$$css:!0},threadItemContainerEditMode:{flexGrow:"x1iyjqo2",minWidth:"xeuugli",pointerEvents:"x47corl",$$css:!0}};function a(a){var b=a.thread;a=a.threadListCell;var e=i.useContext(c("MessageRequestsBulkActionsContext.react")),f=e.setBulkActionsUnreadSelectedThreads,g=e.setBulkActionsSelectedThreads,k=e.bulkActionsSelectedThreads,l=c("bs_int64").to_string(b.threadKey),m=i.useCallback(function(a){return c("bs_curry")._1(g,function(a){a=new Set(d("JSSet.bs").values(a));if(a["delete"](l))return a;else return a.add(l)})});i.useEffect(function(){c("bs_curry")._1(f,function(a){a=new Set(d("JSSet.bs").values(a));if(d("MWPIsThreadUnread.bs").isThreadUnread(b)&&k.has(l))return a.add(l);else if(d("MWPIsThreadUnread.bs").isThreadUnread(b)){a["delete"](l);return a}else return a})},[k]);e=k.has(l);var n=d("MWUseAriaLabelForThread.bs").useHook(b);return i.jsx(c("CometPressable.react"),{"aria-checked":e,"aria-label":n,onPress:function(a){return c("bs_curry")._1(m)},role:"checkbox",xstyle:function(a){return[j.pressableContent]},children:i.jsxs("div",{"aria-hidden":!0,className:"x6s0dn4 x78zum5 xexx8yu x1iji9kk x18d9i69 x1sln4lm",children:[i.jsx("div",{className:"xy13l1i",children:i.jsx(c("MWIcon.react"),{color:e?"highlight":"disabled",hideHoverOverlay:!0,icon:e?d("fbicon")._(h("484757"),20):d("fbicon")._(h("659288"),20)})}),i.jsx("div",{className:"x1iyjqo2 xeuugli x47corl",children:a})]})})}a.displayName=a.name+" [from "+f.id+"]";b=a;e=b;g.make=e}),98);
__d("RTWebInboxJoinOngoingCallIcon.react",["ix","TetraIcon.react","fbicon","react","stylex"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j=function(a,b,c){if(b===!0)return k.camcorder[c];switch(a){case"AUDIO_GROUP_CALL":return k.phone[c];case"VIDEO_GROUP_CALL":return k.camcorder[c];default:return null}};function a(a){var b=a.hasActiveRoom,d=a.hidden,e=a.ongoingCallType;a=a.size;a=a===void 0?36:a;if(d)return null;d=j(e,b,a);return d===null?null:i.jsx("div",{className:"x14yjl9h xudhj91 x18nykt9 xww2gxu x1qeybcx x84fkku x67bb7w x10l6tqk xwa60dl x1cb1t30",children:i.jsx("div",{className:c("stylex")(m.button,l[a]),children:i.jsx(c("TetraIcon.react"),{color:"white",icon:d})})})}a.displayName=a.name+" [from "+f.id+"]";var k={camcorder:{32:d("fbicon")._(h("493173"),16),36:d("fbicon")._(h("493174"),20)},phone:{32:d("fbicon")._(h("558160"),16),36:d("fbicon")._(h("558161"),20)}},l={32:{height:"x10w6t97",width:"x1td3qas",$$css:!0},36:{height:"xc9qbxq",width:"x14qfxbe",$$css:!0}},m={button:{alignItems:"x6s0dn4",backgroundImage:"x144zhqp",borderTopStartRadius:"x14yjl9h",borderTopEndRadius:"xudhj91",borderBottomEndRadius:"x18nykt9",borderBottomStartRadius:"xww2gxu",borderTopWidth:"x972fbf",borderEndWidth:"xcfux6l",borderBottomWidth:"x1qhh985",borderStartWidth:"xm0m39n",boxSizing:"x9f619",display:"x78zum5",justifyContent:"xl56j7k",paddingTop:"xexx8yu",paddingEnd:"x4uap5",paddingBottom:"x18d9i69",paddingStart:"xkhd6sd",position:"x1n2onr6",$$css:!0},buttonContainer:{borderTopStartRadius:"x14yjl9h",borderTopEndRadius:"xudhj91",borderBottomEndRadius:"x18nykt9",borderBottomStartRadius:"xww2gxu",boxShadow:"x1qeybcx",end:"x84fkku",pointerEvents:"x67bb7w",position:"x10l6tqk",top:"xwa60dl",transform:"x1cb1t30",$$css:!0}};g["default"]=a}),98);
__d("MWThreadListItem.bs",["fbt","CometCardedDialogLoadingState.re","CometEntryPointDialogTrigger.react","CometListCellHoverButton.react","CometTextWithEntities.react","CometTransientDialogProvider.react","CommunityMessagingEnableState.bs","FBGroupChatInviteState.bs","FBID.bs","GroupsCometJoinChatDialog.entrypoint","I64","InteractionTracingMetrics","JSResourceForInteraction","LS.bs","LSMessagingThreadTypeUtil.bs","LSRtcCallState.bs","LSThreadTitle.bs","LSTransaction.bs","LSUpdateCommunityChannelDirectInvite","LsMessengerThreadDamagingActionsEntryPoint.bs","LsSystemFolder.bs","MAWGating","MAWGroupInvitesForThread.bs","MDSListCell.react","MWCMIsAnyCMThread","MWCMThreadTypes.bs","MWCMUseFolder.bs","MWCMUseShouldGoToFullScreenChat.bs","MWChatCalculateIsMutedFromExpireTime.bs","MWChatTextTransform.bs","MWJewelPopoverDialogContext.react","MWLSThreadDisplayContext.bs","MWLSThreadIsPinned.bs","MWLSThreadSnippetForDisplay","MWMessageDeliveryStatusIcons","MWPActor.bs","MWPIsThreadUnread.bs","MWPMessageRowCalculateStatus.react","MWPThreadListItemInviteAddOn.react","MWSelectedThreadOptionsIdContext.bs","MWText.react","MWThreadAddOnSecondary.react","MWThreadListFocusableTable.react","MWThreadListLastMessage.bs","MWThreadPicture.bs","MWV2OpenTabOrThread.bs","MWV2PreloadThread.bs","MWVerticalRhythm","MessageRequestsBulkActionsContext.react","MessageRequestsBulkActionsThreadListItem.bs","MessengerMuteUtils.bs","MessengerWebEntryPointsUtil.bs","RTCCallState.bs","RTWebInboxJoinOngoingCallIcon.react","ReQL.bs","ReQLSuspense","UseBlockedUserInterstitial.bs","cometPushToast","emptyFunction","gkx","promiseDone","react","requireDeferred","stylex","useCometLazyDialog","useGroupsCometCMOffboardingEntryPointDialog","useMatchMedia","useMenuButtonVisibilityState","useReStore","useSimpleImpression"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j=c("requireDeferred")("C4gEngagementFalcoEvent.bs").__setRef("MWThreadListItem.bs"),k=c("requireDeferred")("MWThreadListHoverButtonDropdownMenu.bs").__setRef("MWThreadListItem.bs"),l={listItemContainer:{paddingStart:"xurb0ha",paddingEnd:"x1sxyh0",position:"x1n2onr6",$$css:!0},listItemContainerForMessengerDotCom:{paddingStart:"x16hj40l",paddingEnd:"xsyo7zv",$$css:!0},listItemContainerHiddenContent:{display:"x1lliihq",width:"xnalus7",height:"xqtp20y",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0}};function m(a,b,c,e){j.onReady(function(f){return f.log(function(){return{action:"tap",event:c,group_id:d("FBID.bs").ofString(b),parent_surface:"channel_list",source:e,surface:"chat_row",thread_id:d("FBID.bs").ofString(a)}})})}function a(a){var b=a.lsEntryPoint,e=a.messagingEntrypoint,f=a.onClose,g=f===void 0?c("emptyFunction"):f,j=a.onPress;f=a.onThreadSelected;var n=f===void 0?c("emptyFunction"):f;f=a.parentSurface;f=f===void 0?"channel_list":f;var o=a.renderAddOnEnd,p=a.renderThreadPhoto,q=a.renderThreadSubtitle,r=a.renderThreadTitle,s=a.responsive,t=a.selected,u=a.thread,v=(a=p)!=null?a:function(a){return i.jsx(d("MWThreadPicture.bs").make,{badgeSize:c("gkx")("571")?10:14,photoSize:c("MWCMIsAnyCMThread")(a.threadType)||c("gkx")("571")?"s_48":"s_56",thread:a})},w=(p=r)!=null?p:function(a){return i.jsx(d("LSThreadTitle.bs").make,{thread:a})},x=(a=q)!=null?a:function(a){return i.jsx(d("MWThreadListLastMessage.bs").make,{hasOngoingCall:!d("I64").equal(a.ongoingCallState,d("LSRtcCallState.bs").noOngoingCall),isUnread:d("MWPIsThreadUnread.bs").isThreadUnread(a),lastMessageTimestamp:d("I64").to_float(a.lastActivityTimestampMs),showTimestamp:!d("MWCMThreadTypes.bs").isUnjoinedCMThread(a.threadType),snippet:d("MWLSThreadSnippetForDisplay").MWLSThreadSnippetForDisplay(a),thread:a})};c("useSimpleImpression")(function(){var a=d("LSMessagingThreadTypeUtil.bs").isSecure(u.threadType),b=c("InteractionTracingMetrics").currentInteractionLogger();return b.addMetadata("hasSecureThread",a?1:0)});var y=d("LSMessagingThreadTypeUtil.bs").isSecure(u.threadType),z=d("LSMessagingThreadTypeUtil.bs").isGroup(u.threadType),A=d("MAWGroupInvitesForThread.bs").isGroupInviteThread(u),B=d("MWV2OpenTabOrThread.bs").useHook();r=i.useRef(null);p=i.useMemo(function(){return d("FBID.bs").ofStringExn(d("I64").to_string(u.threadKey))},[u]);var C=c("useMatchMedia")("(min-width: 900px)")||!s,D=c("useReStore")();q=c("useCometLazyDialog")(c("JSResourceForInteraction")("MAWGroupInviteDialog.react").__setRef("MWThreadListItem.bs"));var E=q[0];a=d("MWPActor.bs").useActor();var F=d("MWPIsThreadUnread.bs").isThreadUnread(u),G=d("MWCMThreadTypes.bs").isUnjoinedCMThread(u.threadType);s=i.useMemo(function(){return d("MessengerMuteUtils.bs").calcMuteUntilMs(u)},[u]);q=u.snippetSenderContactId;var H=q!==void 0?d("I64").equal(q,a):!1,I=d("MWChatCalculateIsMutedFromExpireTime.bs").useHook(s);q=c("useMenuButtonVisibilityState")(!0);a=q[0];q=q[1];var J=q.setListItemHovered,K=q.setMenuBtnFocused,L=q.setMenuBtnHovered,aa=q.setMenuOpened,M=c("MWCMIsAnyCMThread")(u.threadType),N=d("MWCMThreadTypes.bs").isBroadcastThread(u.threadType),O=d("I64").equal(u.parentThreadKey,d("LsSystemFolder.bs").inbox);q=O?C:!G;var ba=i.useCallback(function(){return J(!1)},[J]),ca=i.useCallback(K,[K]),da=d("MWLSThreadIsPinned.bs").useHook(),P=i.useContext(c("MWJewelPopoverDialogContext.react")),Q=P.setIsOpenForDialog,ea=i.useCallback(function(){if(e==="jewel")return Q(!1)},[e,Q]);P=i.useCallback(function(a){return J(!0)},[J]);var R=d("ReQLSuspense").useFirst(function(){return d("ReQL.bs").getKeyRange(d("ReQL.bs").fromIndexDescending(D.table("messages").index("messageDisplayOrder")),{hd:u.threadKey,tl:0})},[u.threadKey]),S=d("MWV2PreloadThread.bs").useHook(u.threadKey,y),fa=S[0],ga=S[1];S=!d("I64").equal(u.ongoingCallState,d("LSRtcCallState.bs").noOngoingCall);var T=u.additionalThreadContext,ha=i.useMemo(function(){if(T!==void 0)return i.jsxs(i.Fragment,{children:[i.jsx(c("MWText.react"),{align:"start",color:"secondary",numberOfLines:1,type:"meta4",children:i.jsx(c("CometTextWithEntities.react"),{text:T,transforms:d("MWChatTextTransform.bs").epdTextTransforms})}),i.jsx(c("MWVerticalRhythm"),{height:8})]});else return null},[T]),U=d("MWCMUseFolder.bs").useHook(u),V=i.useMemo(function(){if(U!==void 0&&M)return[U.fbGroupId,U.enableState,U.disableTimestamp];else return[void 0,void 0,void 0]},[M,U]),W=V[0],X=V[1];V[2];var ia=d("I64").equal((V=X)!=null?V:d("CommunityMessagingEnableState.bs").enabled,d("CommunityMessagingEnableState.bs").disableRequested),ja=u.folderName==="inbox"?d("LsMessengerThreadDamagingActionsEntryPoint.bs").inboxThreadList:u.folderName==="pending"?d("LsMessengerThreadDamagingActionsEntryPoint.bs").pendingThreadList:d("LsMessengerThreadDamagingActionsEntryPoint.bs").spamThreadList,ka=d("UseBlockedUserInterstitial.bs").useHook(u.threadKey),la=function(a){ka(function(){var c={clientThreadKey:u.clientThreadKey,threadKey:u.threadKey,threadType:u.threadType};return a?B.openInbox(c,b):B.openTabOrInbox(!0,c,b)},ja);return g()};X=d("MWLSThreadDisplayContext.bs").useHook();V=X==="Inbox";X=i.useContext(c("MessageRequestsBulkActionsContext.react"));X=X.isBulkActionsEditMode;var Y=d("MWCMUseShouldGoToFullScreenChat.bs").useHook();d("MWV2OpenTabOrThread.bs").usePreloadRoute(u.threadKey,u.threadType);var Z=u.hasPendingInvitation||!1,$=c("useGroupsCometCMOffboardingEntryPointDialog")({groupID:d("I64").to_string(W||d("I64").zero)}),ma=$[0],na=function(a){c("promiseDone")(d("LSTransaction.bs").run(D,function(a){return c("LSUpdateCommunityChannelDirectInvite")(u.threadKey,d("FBGroupChatInviteState.bs").declinedByReceiver,d("LS.bs").make(a))},"readWrite"));m(d("I64").to_string(u.threadKey),d("I64").to_string((a=W)!=null?a:d("I64").zero),"invite_declined","direct_invite_join_button");d("cometPushToast").cometPushSimpleToast(h._("__JHASH__tNF5MX9GoB5__JHASH__").toString())},oa=!c("MWCMIsAnyCMThread")(u.threadType)||d("MessengerWebEntryPointsUtil.bs").getEntryPointHasGroupNameAsThreadSnippet(b)?!1:c("gkx")("957");$=i.jsx(c("CometEntryPointDialogTrigger.react"),{dialogEntryPoint:c("GroupsCometJoinChatDialog.entrypoint"),fallback:function(){return i.jsx(d("CometCardedDialogLoadingState.re").make,{})},otherProps:{invited:Z,parentSurface:f,shouldGoToMessenger:Y},preloadParams:{groupID:d("I64").to_string(W||d("I64").zero),threadID:d("I64").to_string(u.threadKey)},children:function(a){var b=function(){if(o!==void 0)return o(u);if(Z)return i.jsx(c("MWPThreadListItemInviteAddOn.react"),{onAccept:function(){m(d("I64").to_string(u.threadKey),d("I64").to_string(W||d("I64").zero),"invite_accepted","direct_invite_decline_button");return a()},onDecline:na});return C||!O?i.jsx(c("MWThreadAddOnSecondary.react"),{isMuted:I,isPinned:da,isUnread:F,isViewerSender:H,lastMessageDeliveryStatusIcon:R!==void 0&&!(N&&c("gkx")("6159"))?i.jsx(c("MWPMessageRowCalculateStatus.react"),{isBroadcastThread:N,isLargeGroup:!1,isSecureGroupThread:y&&z,message:R,nextMessage:void 0,children:function(a){switch(a.TAG){case 1:return i.jsx(c("MWMessageDeliveryStatusIcons").SendingIcon,{size:12});case 2:return i.jsx(c("MWMessageDeliveryStatusIcons").SentIcon,{size:12});case 3:return i.jsx(c("MWMessageDeliveryStatusIcons").DeliveredIcon,{size:12});case 4:return i.jsx(c("MWMessageDeliveryStatusIcons").ErrorIcon,{size:12});default:return null}}}):null,thread:u}):void 0}();return i.jsx(c("MDSListCell.react"),{addOnEnd:b,addOnStart:v(u),"aria-current":t?"page":"false",content:i.jsxs("span",{className:C||!O?void 0:"x1lliihq xnalus7 xqtp20y x6ikm8r x10wlt62",children:[ha,i.jsx(c("MWText.react"),{align:"start",color:"primary",numberOfLines:1,type:F?c("gkx")("571")?"entityHeaderMeta1":"headlineEmphasized4":c("gkx")("571")?"headline4":"body3",children:w(u)}),d("MWCMThreadTypes.bs").isJoinedCMThread(u.threadType)&&oa?null:i.jsxs(i.Fragment,{children:[i.jsx(c("MWVerticalRhythm"),{height:8}),x(u)]})]}),linkProps:{preventLocalNavigation:!0,url:B.getUrlFromThreadKey(u.threadKey,u.threadType)},onFocusChange:ca,onHoverIn:fa,onHoverOut:ga,onPress:function(b){j==null?void 0:j(b);if(G){if(!ia)return a();if(W===void 0)return;return ma({onClose:c("emptyFunction")},c("emptyFunction"))}d("MAWGating").isGroupInvitesEnabled()&&A?E({onClose:c("emptyFunction"),thread:u},c("emptyFunction")):la(b.metaKey||b.ctrlKey||b.shiftKey);return n()},selected:t,size:"large"})}},d("I64").to_string(u.threadKey));if(q){if(X)f=null;else{q={hidden:!a,onFocusChange:K,onHoverChange:L,onMenuStateChange:function(a){ea();return aa(a)},popoverProps:{fbid:p,groupId:d("I64").to_string((Y=W)!=null?Y:d("I64").zero),isUnread:F,messagingEntrypoint:e,mutedUntil:s/1e3,onCloseJewel:g,selected:t,thread:u},popoverResource:k,popoverTriggerType:"lazy",testid:"mwthreadlist-menu-id-"+p};a=c("gkx")("571")?32:void 0;a!==void 0&&(q.size=a);f=i.jsx(c("CometListCellHoverButton.react"),babelHelpers["extends"]({},q))}K=i.jsx(d("MWThreadListFocusableTable.react").MWThreadListFocusableTableCell,{children:i.jsxs("div",{role:"gridcell",children:[i.jsx(c("RTWebInboxJoinOngoingCallIcon.react"),{hidden:!S,ongoingCallType:d("RTCCallState.bs").ofLsRtcCallState(u.ongoingCallState,u.threadType),size:32}),f]})})}else K=null;L=i.jsx("div",{"data-testid":void 0,children:i.jsx("div",{className:c("stylex")(l.listItemContainer,c("gkx")("571")?l.listItemContainerForMessengerDotCom:!1),"data-testid":void 0,onMouseEnter:P,onMouseLeave:ba,role:"row",children:i.jsxs(d("MWThreadListFocusableTable.react").MWThreadListFocusableTableRow,{children:[i.jsx(d("MWThreadListFocusableTable.react").MWThreadListFocusableTableCell,{children:i.jsx("div",{ref:r,role:"gridcell",children:X?i.jsx(d("MessageRequestsBulkActionsThreadListItem.bs").make,{thread:u,threadListCell:$}):$})}),K]})})});if(V)return i.jsx(d("MWSelectedThreadOptionsIdContext.bs").make,{threadId:u.threadKey,children:i.jsx(c("CometTransientDialogProvider.react"),{children:L})});else return L}a.displayName=a.name+" [from "+f.id+"]";b=i.memo(a);e=b;g.make=e}),98);
__d("MWThreadListFolderItem.bs",["CometTextWithEntities.react","MDSListCell.react","MDSTextPairing.react","MWAddOnCircleContainer.react","MWCMThreadTypes.bs","MWChatTextTransform.bs","MWPIsThreadUnread.bs","MWText.react","MWThreadListFocusableTable.react","MWThreadListLastMessage.bs","ReQL.bs","ReQLSubscription.bs","SortedAsyncIterable.bs","bs_belt_Option","bs_caml","bs_caml_int64","bs_curry","react","useMatchMedia","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.icon,e=a.onClick,f=a.responsive,g=a.selectedThreadKey,i=a.size,j=a.systemFolder,k=a.thread,l=a.threadName;a=c("useMatchMedia")("(min-width: 900px)")||!f;var m=c("useReStore")();f=c("bs_belt_Option").isSome(d("ReQLSubscription.bs").useFirst(h.useMemo(function(){if(g!==void 0)return d("ReQL.bs").filter(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(m.table("threads")),{hd:g,tl:0}),function(a){return c("bs_caml").i64_eq(a.parentThreadKey,j)});else return d("SortedAsyncIterable.bs").empty()},[g,k])));var n=h.useMemo(function(){var a=k.snippet;if(a!==void 0)return a;else return null},[k]),o=c("bs_caml_int64").to_float(k.lastActivityTimestampMs),p=d("MWPIsThreadUnread.bs").isThreadUnread(k),q=k.threadName,r=h.useMemo(function(){return h.jsx(c("MWAddOnCircleContainer.react"),{size:function(){switch(i){case"s_28":return 28;case"s_36":return 36;case"s_40":return 40;case"s_48":return 48;case"s_56":return 56}}(),children:b})},[i]),s=h.useMemo(function(){return c("bs_belt_Option").getWithDefault(q,l)},[q]),t=h.useMemo(function(){return h.jsx(c("MWText.react"),{color:"primary",numberOfLines:1,type:p?"headlineEmphasized4":"body3",children:h.jsx(c("CometTextWithEntities.react"),{text:s.toString(),transforms:d("MWChatTextTransform.bs").epdTextTransforms})})},[p,s]),u=h.useCallback(function(a){return c("bs_curry")._1(e)},[e]);r=h.jsx(d("MWThreadListFocusableTable.react").MWThreadListFocusableTableRow,{children:h.jsx("div",{role:"row",children:h.jsx(d("MWThreadListFocusableTable.react").MWThreadListFocusableTableCell,{children:h.jsx("div",{className:"xurb0ha x1sxyh0",role:"gridcell",children:h.jsx(c("MDSListCell.react"),{addOnStart:r,content:h.jsx(c("MDSTextPairing.react"),{body:a?h.jsx(d("MWThreadListLastMessage.bs").make,{hasOngoingCall:!1,isUnread:p,lastMessageTimestamp:o,showTimestamp:!d("MWCMThreadTypes.bs").isUnjoinedCMThread(k.threadType),snippet:n}):null,bodyLineLimit:1,headline:a?t:null,headlineLineLimit:1,level:4,reduceEmphasis:!p}),onPress:u,selected:f,size:"large"})})})})});o={children:r};return h.jsx("div",babelHelpers["extends"]({},(o["data-testid"]="mwthreadlist-item",o)))}a.displayName=a.name+" [from "+f.id+"]";b=a;e=b;g.make=e}),98);
__d("MWThreadListJobsItem.bs",["fbt","ix","LsSystemFolder.bs","MWIcon.react","MWThreadListFolderItem.bs","bs_curry","fbicon","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react");function a(a){var b=a.onClick,e=a.responsive,f=a.selectedThreadKey,g=a.size;a=a.thread;var k=function(a){return c("bs_curry")._1(b,d("LsSystemFolder.bs").jobs)};return j.jsx(d("MWThreadListFolderItem.bs").make,{icon:j.jsx(c("MWIcon.react"),{color:"primary",icon:d("fbicon")._(i("512668"),32),size:56}),onClick:k,responsive:e,selectedThreadKey:f,size:g,systemFolder:d("LsSystemFolder.bs").jobs,thread:a,threadName:h._("__JHASH__fyt3EBzeQRx__JHASH__")})}a.displayName=a.name+" [from "+f.id+"]";b=a;e=b;g.make=e}),98);
__d("MWThreadList.bs",["fbt","BootloaderResource","CometPlaceholder.react","FBID.bs","FocusRegion.react","JSResource","LSMessagingThreadTypeUtil.bs","LsSystemFolder.bs","MWIsXacGroupThread.bs","MWLSJewelMessageRequestsThread.bs","MWPBaseThreadList.react","MWPBumpEntityKey","MWPThreadIsPage.bs","MWPThreadsForThreadList.bs","MWText.react","MWThreadKey.bs","MWThreadListGlimmer.react","MWThreadListItem.bs","MWThreadListJobsItem.bs","MWThreadListSupportedThreadTypes.bs","MWThread_DEPRECATED.bs","MWXacGating.bs","MessagingThreadType.bs","ReQL.bs","ReQLSuspense","bs_belt_Option","bs_caml","bs_caml_obj","bs_caml_option","bs_curry","bs_int64","cr:12211","cr:1913","cr:4519","cr:4716","cr:9873","gkx","qex","react","recoverableViolation","useCometUniqueID","useReStore","useSimpleImpression"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j=b("cr:4519")==null?void 0:c("bs_caml_option").some(b("cr:4519")),k=b("cr:1913")==null?void 0:c("bs_caml_option").some(b("cr:1913")),l=b("cr:12211")==null?void 0:c("bs_caml_option").some(b("cr:12211")),m=c("JSResource")("MWThreadListNullState.react").__setRef("MWThreadList.bs");function n(a){return i.createElement(d("BootloaderResource").read(m),a)}function a(a){c("useSimpleImpression")(a)}function o(a){i.useEffect(function(){c("recoverableViolation")("Unknown thread type","comet_messenger")},[]);return null}var p={make:o};function q(a){var b=d("FBID.bs").ofStringExn(c("bs_int64").to_string(a.threadKey)),e=a.threadType;a=a.cannotUnsendReason;if(a!==void 0&&c("bs_caml").i64_eq(e,d("MessagingThreadType.bs").oneToOne)&&c("bs_caml").i64_eq(a,[0,4]))return{NAME:"Page",VAL:b};if(d("LSMessagingThreadTypeUtil.bs").isOneToOne(e))return{NAME:"User",VAL:b};else if(d("LSMessagingThreadTypeUtil.bs").isGroup(e))return{NAME:"Group",VAL:b};else return}var r=c("gkx")("7681")===!1&&c("gkx")("1950")===!1;function e(a){var e=a.lsEntryPoint,f=a.messagingEntrypoint,g=a.onClickNestedFolderThread,h=a.onClose,l=a.responsive,m=a.selectedThreadKey;a=a.thread;if(c("bs_caml").i64_eq(a.threadType,d("MessagingThreadType.bs").folder)){var n=a.threadKey;if(!c("bs_caml").i64_eq(n,d("LsSystemFolder.bs").mplace))if(c("bs_caml").i64_eq(n,d("LsSystemFolder.bs").jobs))return i.jsx(d("MWThreadListJobsItem.bs").make,{onClick:g,responsive:l,selectedThreadKey:m,size:"s_56",thread:a});else return null;if(b("cr:4519")==null){if(b("cr:1913")==null)return null;n=k}else n=j;if(r===!0)return i.jsx(n.make,{onClick:g,responsive:l,selectedThreadKey:m,size:"s_56",thread:a});else return null}n=q(a);if(n!==void 0)return i.jsx(d("MWThread_DEPRECATED.bs").make,{id:n,children:i.jsx(c("CometPlaceholder.react"),{fallback:i.jsx(c("MWThreadListGlimmer.react"),{}),children:i.jsx(d("MWPThreadIsPage.bs").make,{threadKey:a.threadKey,children:i.jsx(d("MWThreadKey.bs").make,{id:a.threadKey,children:i.jsx(d("MWThreadListItem.bs").make,{lsEntryPoint:e,messagingEntrypoint:f,onClose:h,responsive:l,selected:c("bs_caml_obj").caml_equal(m,a.threadKey),size:56,thread:a})})})})});else return i.jsx(o,{})}var s=i.memo(e);e={make:s};var t=b("cr:12211")==null?function(a){}:l.useHook;function u(a){var e=a.onClose,f=a.preamble,g=a.onClickNestedFolderThread,j=a.gridLabel,k=a.header,l=a.lsEntryPoint,m=a.onOpenMessageRequests,o=a.parentThreadKey,p=a.responsive,q=a.selectedThreadKey,r=a.setHasScrolled,u=a.setIsEmptyInbox,v=a.threadListMessagingEntrypoint,w=e!==void 0?e:function(a){};a=f!==void 0?c("bs_caml_option").valFromOption(f):null;var x=g!==void 0?g:function(a){},y=c("useReStore")(),z=d("ReQLSuspense").useFirst(function(){return d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(y.table("threads_ranges_v2__generated")),{hd:o,tl:0})},[y,o]);e=d("ReQLSuspense").useArray(function(){return d("ReQL.bs").take(d("ReQL.bs").filter(d("ReQL.bs").filter(d("MWPThreadsForThreadList.bs").createIterable(y,o,z),function(a){return d("MWThreadListSupportedThreadTypes.bs").supportedThreadTypes.findIndex(function(b){return c("bs_caml").i64_eq(a.threadType,b)})!==-1}),function(a){if(d("MWXacGating.bs").isGroupsEnabled())return!0;else return!d("MWIsXacGroupThread.bs").check(a)}),5)},[y,JSON.stringify(o),z]).pop();var A=e===void 0?void 0:c("bs_caml_option").some(e);f=k!==void 0?i.jsx(d("FocusRegion.react").FocusRegion,{children:c("bs_caml_option").valFromOption(k)}):null;g=c("useCometUniqueID")();c("bs_curry")._1(t,g);e=d("MWLSJewelMessageRequestsThread.bs").useHook(m);var B=i.useCallback(function(a){if(r!==void 0)return c("bs_curry")._1(r,function(b){return a.target.scrollTop!==0})},[]);k=i.useCallback(function(a){return i.jsx(s,{lsEntryPoint:l==="inboxThreadList"?c("bs_belt_Option").mapWithDefault(A,!1,function(b){return c("bs_caml").i64_le(a.lastActivityTimestampMs,b.lastActivityTimestampMs)})?"inboxRecentThreads":"inboxRemainingThreads":l,messagingEntrypoint:c("bs_belt_Option").getWithDefault(v,"jewel"),onClickNestedFolderThread:x,onClose:w,responsive:p,selectedThreadKey:q,thread:a})},[p,v,l,w,x,q,A]);m=b("cr:4716")==null?null:i.jsx(b("cr:4716"),{renderItem:k});var C=i.useRef(null),D=C.current;i.useEffect(function(){D==null||D.addEventListener("scroll",B)},[D]);f={beforeContent:i.jsxs(i.Fragment,{children:[f,e,a,m]}),emptyContent:c("qex")._("1310")===!0?i.jsx(c("CometPlaceholder.react"),{fallback:null,children:i.jsx(n,{parentThreadKey:o})}):i.jsx("div",{className:"xyamay9 x1pi30zi x1l90r2v x1swvt13",children:i.jsx(c("MWText.react"),{align:"center",type:"body2",children:h._("__JHASH__1gb6sA7PX-j__JHASH__")})}),gridLabel:j,itemPlaceholder:i.jsxs(i.Fragment,{children:[i.jsx(c("MWThreadListGlimmer.react"),{}),i.jsx(c("MWThreadListGlimmer.react"),{})]}),onLoadMoreThreads:function(a){return d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.threadlist","load_more_threads")},parentThreadKey:o,renderItem:k,renderLoadingAnimation:function(a){return i.jsxs(i.Fragment,{children:[i.jsx(c("MWThreadListGlimmer.react"),{}),i.jsx(c("MWThreadListGlimmer.react"),{})]})},scrollAreaElementRef:C};u!==void 0&&(f.setIsEmptyInbox=c("bs_caml_option").valFromOption(u));return i.jsx("div",{className:"x78zum5 xdt5ytf x1iyjqo2 x6ikm8r x10wlt62",id:g,children:i.jsx(c("MWPBaseThreadList.react"),babelHelpers["extends"]({},f))})}u.displayName=u.name+" [from "+f.id+"]";l=56;f="s_56";u=u;l=l;f=f;p=p;e=e;var v=t;u=u;g.$MAWThreadId$requireCond=b("cr:9873");g.$MWUseKeyCommandsForThreadList$OR$null$requireCond=b("cr:12211");g.$null$OR$MWThreadListMarketplaceItem$requireCond=b("cr:4519");g.$null$OR$MWThreadListMarketplaceItem$requireCond$1=b("cr:1913");g.useSimpleImpression=a;g.threadlistItemHeight=l;g.threadListItemHeightListCell=f;g.UnknownThreadType=p;g.ThreadListItemMemoized=e;g.useKeyCommandsForThreadList=v;g.make=u}),98);
__d("CometMessagingJewelDropdown.react",["fbt","BaseMultiStepContainer.react","CometMessagingJewelDropdownContent.react","CometTopNavListDropdown.react","react","stylex"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(a){var b=a.props.onClose;a=a.queries;var d=a.qpBannerCommunitiesContainerQueryRef,e=a.qpBannerContainerQueryRef;a=i.jsx("div",{className:c("stylex")([c("CometTopNavListDropdown.react").styles.cardWidth]),children:i.jsx(c("BaseMultiStepContainer.react"),{fitContentWidth:!0,children:function(a){return i.jsx(c("CometMessagingJewelDropdownContent.react"),{errorBoundaryXstyle:c("CometTopNavListDropdown.react").styles.cardWidth,onClose:b,pushPage:a,qpBannerCommunitiesContainerQueryRef:d,qpBannerContainerQueryRef:e})}})});return i.jsx(c("CometTopNavListDropdown.react"),{label:h._("__JHASH__ptC-BqtItMK__JHASH__"),name:"MWJewelDropdown",children:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWIssueNewUserVisibleErrors",["fbt","$InternalEnum","LS.re","LSIssueNewError","LSRemoveError","Promise","ReQL","promiseDone","regeneratorRuntime"],(function(a,b,c,d,e,f,g,h){"use strict";function a(a,b,e,f){a.runInTransaction(function(a){return c("LSIssueNewError")(void 0,void 0,e.toString(),b!=null?b.toString():void 0,String(f),d("LS.re").make(a))},"readwrite")}function i(a,b){return a.runInTransaction(function(a){return c("LSRemoveError")(b,d("LS.re").make(a))},"readwrite")}function e(a){c("promiseDone")(function(){var c;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.table("user_visible_errors"))));case 2:c=e.sent;e.next=5;return b("regeneratorRuntime").awrap(b("Promise").all(c.map(function(c){return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(i(a,c.errorId));case 2:case"end":return d.stop()}},null,this)})));case 5:case"end":return e.stop()}},null,this)}())}f=b("$InternalEnum")({TOAST:"toast",BANNER:"banner"});var j=h._("__JHASH__Iu3LLAycxul__JHASH__"),k=h._("__JHASH__sfKyyq_GmTy__JHASH__"),l=h._("__JHASH__GFcUdiCyJga__JHASH__"),m=h._("__JHASH__eNLW45dJwcf__JHASH__"),n=h._("__JHASH__ullHqmlWvhs__JHASH__");h=h._("__JHASH__1UM5NSCZCUv__JHASH__");var o=new Map([[j.toString(),j],[l.toString(),l]]),p=new Map([[k.toString(),k],[m.toString(),m]]);g.issueError=a;g.deleteUserVisibleError=i;g.deleteAllErrors=e;g.MAWUserVisibleErrorPresentationType=f;g.MAWGeneralErrorMsgTitle=j;g.MAWGeneralErrorMsgBody=k;g.MAWLegacyUserErrorMsgTitle=l;g.MAWLegacyUserErrorMsgBody=m;g.MAWUnsupportedIndexedDBErrorMsgTitle=n;g.MAWUnsupportedIndexedDBErrorMsg=h;g.errorMsgTitleToFbtMap=o;g.errorMsgBodyToFbtMap=p}),98);
__d("MWInboxContextSwitcher.react",["fbt","CometPivotLinkTabs.react","I64","LsSystemFolderInterop.bs","MWChatBadgeCountUpdates.bs","MWInboxPersistedUIState","MWPBumpEntityKey.re","MessagingThreadType.re","ReQL","ReQLSuspense","cr:3408","cr:3437","qex","react","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react"),j=d("react").useEffect,k=(e=b("cr:3408"))!=null?e:function(){return!1},l=(e=c("qex")._("1169"))!=null?e:!1,m={inboxTabContainer:{paddingStart:"xkhd6sd",paddingEnd:"x4uap5",paddingTop:"x1y1aw1k",paddingBottom:"xwib8y2",$$css:!0},tabContainer:{paddingStart:"x1swvt13",paddingEnd:"x1pi30zi",paddingTop:"x1y1aw1k",paddingBottom:"xwib8y2",$$css:!0}};function a(a){var e=a.entryPoint,f=a.onTabChange,g=a.selectedFolderTab,n=c("useReStore")();j(function(){b("cr:3437")!=null&&n.runInTransaction(function(a){return b("cr:3437")(a)},"readwrite","background")},[n]);a=!!d("ReQLSuspense").useFirst(function(){var a=[d("ReQL").fromTableDescending(n.table("threads").index("threadTypeLastActivityTimestampMs")).getKeyRange(c("MessagingThreadType.re").communityBroadcastJoinedThread),d("ReQL").fromTableDescending(n.table("threads").index("threadTypeLastActivityTimestampMs")).getKeyRange(c("MessagingThreadType.re").communityGroup),d("ReQL").fromTableDescending(n.table("threads").index("threadTypeLastActivityTimestampMs")).getKeyRange(c("MessagingThreadType.re").communityPrivateHiddenJoinedThread)];return d("ReQL").union.apply(void 0,a)},[n]);var o=k(),p=d("MWInboxPersistedUIState").usePersistedUIState(o,"__MWInboxContextSwitcher.hasViewedSuggestedChats__"),q=p[0],r=p[1];p=d("MWChatBadgeCountUpdates.bs").useHook(d("LsSystemFolderInterop.bs").inbox);p=p!=null&&p>0;var s=d("MWChatBadgeCountUpdates.bs").useHasUnseenCommunityThreads(),t=o&&!q;p=[{folder:d("LsSystemFolderInterop.bs").inbox,hasNewContentBadge:p,isShown:!0,label:h._("__JHASH__4dBM4WjAtAu__JHASH__"),odsAction:"inbox_tab_click"},{folder:d("LsSystemFolderInterop.bs").community,hasNewContentBadge:s||t,isShown:a||o||l,label:h._("__JHASH___yDrE8px4gt__JHASH__"),odsAction:"communities_tab_click"}];s=p.filter(function(a){return a.isShown}).map(function(a,b){var c=a.folder;b=a.hasNewContentBadge;a.isShown;var h=a.odsAction;a=babelHelpers.objectWithoutPropertiesLoose(a,["folder","hasNewContentBadge","isShown","odsAction"]);return babelHelpers["extends"]({},a,{hasNewContentBadge:b,onPress:function(){c===d("LsSystemFolderInterop.bs").community&&o&&!q&&r(!0),d("MWPBumpEntityKey.re").bumpEntityKeyWithAppId("mw.contextswitcher."+e,h),f(c)},selected:d("I64").equal(c,g)})});return i.jsx(c("CometPivotLinkTabs.react"),{linkType:"deemphasized",tabs:s,tabsContainerStyle:e==="inbox"?m.inboxTabContainer:m.tabContainer})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWInboxContextSwitcherCond.react",["cr:4067","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){return b("cr:4067")?h.jsx(b("cr:4067"),babelHelpers["extends"]({},a)):null}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("TetraMWJewelThreadAddOnSecondaryIcons",["ix","TetraIcon.react","fbicon","react"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("react");b=a.jsx(c("TetraIcon.react"),{color:"disabled",icon:d("fbicon")._(h("569284"),16)});g.bell=b}),98);
__d("MWJewelLightspeedSearchTypeaheadViewList.react",["CometScrollView.react","MWChatSearchLightspeedTypeaheadViewList.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i={scroll:{maxHeight:"xo4cw3p",$$css:!0}};function a(a){var b=a.xstyle;a=babelHelpers.objectWithoutPropertiesLoose(a,["xstyle"]);return h.jsx(c("CometScrollView.react"),{showsHorizontalScrollIndicator:!1,xstyle:[i.scroll,b],children:h.jsx(c("MWChatSearchLightspeedTypeaheadViewList.react"),babelHelpers["extends"]({},a))})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWJewelSearchEmptyState.react",["fbt","TetraText.react","react","useCometTypeaheadEmptyState"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");function a(a){var b=c("useCometTypeaheadEmptyState")();return b?i.jsxs("div",{className:"xz9dl7a xn6708d xsag5q8 x1ye3gou",children:[i.jsx(c("TetraText.react"),{align:"center",type:"body2",children:h._("__JHASH__kjfZwRT5xYf__JHASH__")}),i.jsx("br",{}),i.jsx(c("TetraText.react"),{align:"center",color:"tertiary",type:"body3",children:h._("__JHASH__vJvyHT-oIpm__JHASH__",[h._param("query",a.queryString)])})]}):null}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useBaseTypeaheadSubscriptionDataSourceFetchResolverNetwork",["react"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useCallback,i=b.useEffect,j=b.useRef,k=b.useState;function a(a){var b=a.dataSource;a=k(!1);var c=a[0],d=a[1],e=j(null);a=h(function(a){var c,f=a.onResolvePayload;a=a.requestParams;(c=e.current)==null?void 0:c.unsubscribe();e.current=b.fetchNetwork(a).subscribe({complete:function(){d(!1)},error:function(a){d(!1)},next:function(a){return f(a)},start:function(a){d(!0)},unsubscribe:function(){d(!1)}})},[b]);i(function(){return function(){var a;(a=e.current)==null?void 0:a.unsubscribe()}},[]);return[{isLoading:c},a]}g["default"]=a}),98);
__d("useBaseTypeaheadSubscriptionDataSourceFetchResolver",["cometTypeaheadODSLogFetchNetworkEvent","cr:2557","react","recoverableViolation","useBaseTypeaheadSubscriptionDataSourceFetchResolverNetwork","useDebouncedComet"],(function(a,b,c,d,e,f,g){"use strict";e=d("react");var h=e.useCallback,i=e.useEffect,j=e.useRef;function a(a,d){var e=a.dataSource,f=a.dataSourceFetchConfigParams;f=f===void 0?{}:f;var g=f.requestFlow;f=f.shouldDebounceNetwork;var k=f===void 0?!0:f,l=a.onResolvePayload;f=c("useBaseTypeaheadSubscriptionDataSourceFetchResolverNetwork")({dataSource:e});a=f[0].isLoading;var m=f[1],n=c("useDebouncedComet")(m),o=h(function(a,b){var d=b.isTraceComplete;b=b.source;try{l(a,{isTraceComplete:d,source:b})}catch(a){c("recoverableViolation")("Failed to resolve fetched payload","search")}return b},[l]),p=j(g),q=h(function(a){o(a,{isTraceComplete:!0,source:a.entries.length>0?"network":"network-no-results"}),c("cometTypeaheadODSLogFetchNetworkEvent")&&c("cometTypeaheadODSLogFetchNetworkEvent")("comet.ta.fetch",!0,1),b("cr:2557")&&b("cr:2557")(["all"],a)},[o]);i(function(){function a(a){a=a.requestParams;var b=a.requestFlow;b!=null&&(p.current=b);b={onResolvePayload:q,requestParams:babelHelpers["extends"]({},a,{requestFlow:p.current})};Boolean(k)?n(b):m(b)}d!=null&&a(d)},[m,n,d,q,k]);return[{isLoading:a}]}g["default"]=a}),98);
__d("useBaseTypeaheadSubscriptionDataSourceFetch",["react","recoverableViolation","useBaseTypeaheadSubscriptionDataSourceFetchResolver"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useCallback,i=b.useState;function a(a){var b=i(null),d=b[0],e=b[1];b=c("useBaseTypeaheadSubscriptionDataSourceFetchResolver")(a,d);a=b[0].isLoading;var f=h(function(a,b){b===void 0&&(b="all"),e({requestParams:a,source:b})},[]);b=h(function(a){a=a||{};var b=a.requestFlow;a=a.source;if(d==null){c("recoverableViolation")("Refetch cannot be called with undefined `fetchParams`","search");return}var e=d.requestParams,g=e.loggingEventTrace;e=babelHelpers.objectWithoutPropertiesLoose(e,["loggingEventTrace"]);g=babelHelpers["extends"]({loggingEventTrace:babelHelpers["extends"]({},g,{sequenceID:String(Date.now())}),requestFlow:b},e);f(g,a)},[f,d]);return[{isLoading:a,source:(a=d==null?void 0:d.source)!=null?a:"all"},f,b]}g["default"]=a}),98);
__d("TypeaheadLoggingFetchRequestFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1880031");c=b("FalcoLoggerInternal").create("typeahead_logging_fetch_request",a);e.exports=c}),null);
__d("CometTypeaheadVolumeLoggingProvider",["TypeaheadLoggingFetchRequestFalcoEvent","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h=function(){return Math.random().toString()};a=function(){function a(a){this.$2=null,this.$1=a,this.$2=h()}var b=a.prototype;b.getContext=function(){return this.$1};b.getSessionID=function(){this.$2==null&&c("recoverableViolation")("Logging sessionID requested from "+this.getContext()+" surface does not exist.","search");return this.$2};b.logRequest=function(a){var b={context:this.getContext(),requestType:a,sessionID:this.getSessionID()};c("TypeaheadLoggingFetchRequestFalcoEvent").log(function(){return{fetchRequest:b}})};return a}();g["default"]=a}),98);
__d("useCometTypeaheadVolumeLoggingProvider",["CometTypeaheadVolumeLoggingProvider","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useMemo;function a(a){a===void 0&&(a="UNKNOWN");return h(function(){return new(c("CometTypeaheadVolumeLoggingProvider"))(a)},[a])}g["default"]=a}),98);
__d("CometInternalTypeaheadSubscriptionProvider",["CometInternalTypeaheadEmptyFetchProvider","CometInternalTypeaheadFetchContext","react","useBaseTypeaheadSubscriptionDataSourceFetch","useCometInternalTypeaheadStateDispatcher","useCometTypeaheadVolumeLoggingProvider"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=d("react");var i=b.useCallback,j=b.useMemo;function a(a){var b=a.children,d=a.dataSource,e=a.dataSourceFetchConfigParams,f=a.loggingContext,g=a.onFetchEntries_DO_NOT_USE,k=a.traceProvider;a=c("useCometInternalTypeaheadStateDispatcher")();var l=a.dispatchActiveEntries,m=c("useCometTypeaheadVolumeLoggingProvider")(f);a=c("useBaseTypeaheadSubscriptionDataSourceFetch")({dataSource:d,dataSourceFetchConfigParams:e,onResolvePayload:i(function(a,b){var c;a=a.entries;var d=b.isTraceComplete;b=b.source;l((c=a)!=null?c:[]);m.logRequest(o);g&&g(a);k&&!k.isResolved()&&(d&&(b==="cache"&&a.length>=k.getEntriesCountForVisualComplete()?k.setEndReason("max_suggestions_reached"):b==="network"?k.setEndReason("all_queries_completed"):b==="network-no-results"&&k.setEndReason("all_queries_completed_no_network_results"),k.resolve()))},[l,g,k])});f=a[0];var n=f.isLoading,o=f.source,p=a[1],q=a[2];d=j(function(){return{fetch:p,isLoading:n,refetch:q,source:o}},[p,n,q,o]);return h.jsx(c("CometInternalTypeaheadFetchContext").Provider,{value:d,children:h.jsx(c("CometInternalTypeaheadEmptyFetchProvider"),{isLoading:n,source:o,children:b})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("BaseSubscriptionTypeahead.react",["CometHeroInteractionContextPassthrough.react","CometInternalTypeahead.react","CometInternalTypeaheadStateProvider","CometInternalTypeaheadSubscriptionProvider","emptyFunction","react","useCometUniqueID","withCometTypeaheadInputStrategyShouldQueryStringFollowHighlightedEntry"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=d("react");var i=b.useCallback,j=b.useMemo;function a(a){var b=a.autoOpen;b=b===void 0?!1:b;var d=a.autoFocus;d=d===void 0?!1:d;var e=a.isDisabled;e=e===void 0?!1:e;var f=a.errorMessage;f=f===void 0?null:f;var g=a.inputStrategyRenderer,k=a.dataSource,l=a.dataSourceFetchConfigParams,m=a.decorators,n=m===void 0?[]:m;m=a.emptyEntries_DO_NOT_USE;var o=a.id,p=a.label;p=p===void 0?"":p;var q=a.loggingContext,r=a.onBackspace;r=r===void 0?c("emptyFunction"):r;var s=a.onBlur;s=s===void 0?c("emptyFunction"):s;var t=a.onChange,u=a.onClose;u=u===void 0?c("emptyFunction"):u;var v=a.onEnter;v=v===void 0?c("emptyFunction"):v;var w=a.onEscape;w=w===void 0?c("emptyFunction"):w;var x=a.onFetchEntries_DO_NOT_USE,y=a.onFocus;y=y===void 0?c("emptyFunction"):y;var z=a.onOpen;z=z===void 0?c("emptyFunction"):z;var A=a.onPressEntry,B=a.placeholder;B=B===void 0?"":B;var C=a.shouldQueryStringFollowHighlightedEntry,D=C===void 0?!0:C;C=a.shouldQueryStringUpdateFromSelectedEntryOnClick;var E=C===void 0?!0:C;C=a.testid;C=C===void 0?"":C;C=a.traceProvider;var F=a.inputRef,G=a.viewRole;G=G===void 0?"listbox":G;var H=a.viewStrategyRenderer;a=babelHelpers.objectWithoutPropertiesLoose(a,["autoOpen","autoFocus","isDisabled","errorMessage","inputStrategyRenderer","dataSource","dataSourceFetchConfigParams","decorators","emptyEntries_DO_NOT_USE","id","label","loggingContext","onBackspace","onBlur","onChange","onClose","onEnter","onEscape","onFetchEntries_DO_NOT_USE","onFocus","onOpen","onPressEntry","placeholder","shouldQueryStringFollowHighlightedEntry","shouldQueryStringUpdateFromSelectedEntryOnClick","testid","traceProvider","inputRef","viewRole","viewStrategyRenderer"]);var I=c("useCometUniqueID")(),J=j(function(){var a=c("CometInternalTypeahead.react");n.forEach(function(b){var c=b.decorate;b=b.params;a=c(a,b)});return a},[n]),K=i(function(a){E&&t(a.label),A&&A(a)},[t,A,E]),L=j(function(){return c("withCometTypeaheadInputStrategyShouldQueryStringFollowHighlightedEntry")(g,{shouldQueryStringFollowHighlightedEntry:D})},[g,D]);p=p||B;return h.jsx(c("CometHeroInteractionContextPassthrough.react"),{clear:!0,children:h.jsx(c("CometInternalTypeaheadStateProvider"),{autoOpen:b,emptyEntries_DO_NOT_USE:m,onClose:u,onOpen:z,children:h.jsx(c("CometInternalTypeaheadSubscriptionProvider"),{dataSource:k,dataSourceFetchConfigParams:l,loggingContext:q,onFetchEntries_DO_NOT_USE:x,traceProvider:C,children:h.jsx(J,babelHelpers["extends"]({},a,{autoFocus:d,errorMessage:f,id:(b=o)!=null?b:I,inputRef:F,inputStrategyRenderer:L,isDisabled:e,label:p,onBackspace:r,onBlur:s,onChange:t,onDownArrow:c("emptyFunction"),onEnter:v,onEscape:w,onFocus:y,onHighlightEntry:c("emptyFunction"),onPressEntry:K,onShiftTab:c("emptyFunction"),onTab:c("emptyFunction"),onUpArrow:c("emptyFunction"),placeholder:B,testid:void 0,viewRole:G,viewStrategyRenderer:H}))})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("LsUniversalSearchEndFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("92");c=b("FalcoLoggerInternal").create("ls_universal_search_end",a);e.exports=c}),null);
__d("LsUniversalSearchQueryChangedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("94");c=b("FalcoLoggerInternal").create("ls_universal_search_query_changed",a);e.exports=c}),null);
__d("LsUniversalSearchStartFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("96");c=b("FalcoLoggerInternal").create("ls_universal_search_start",a);e.exports=c}),null);
__d("LsUniversalSearchResultSelectedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("95");c=b("FalcoLoggerInternal").create("ls_universal_search_result_selected",a);e.exports=c}),null);
__d("MWJewelSearchTypeaheadHelper.bs",["bs_caml_int64","bs_int64"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=c("bs_caml_int64").to_int32(a.threadType),d=c("bs_caml_int64").to_int32(a.type_),e;switch(d){case 0:e=1;break;case 1:e=2;break;case 2:e=3;break;case 3:e=9;break;case 4:e=14;break;case 5:e=7;break;case 6:e=15;break;case 7:e=6;break;default:e=7}return{queryString:a.query,resultFbid:a.resultId,resultIndex:c("bs_int64").to_string(a.globalIndex),resultType:c("bs_caml_int64").to_int32(a.type_),threadType:c("bs_caml_int64").to_int32(a.threadType),transportType:b!==0?b!==1?3:2:1,universalSearchResultType:e}}b=a;g.getLoggingValues=b}),98);
__d("UniversalSearchEndFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("844");c=b("FalcoLoggerInternal").create("universal_search_end",a);e.exports=c}),null);
__d("UniversalSearchResultSelectedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("846");c=b("FalcoLoggerInternal").create("universal_search_result_selected",a);e.exports=c}),null);
__d("MWSearchLogging",["LsUniversalSearchEndFalcoEvent","LsUniversalSearchResultSelectedFalcoEvent","MWJewelSearchTypeaheadHelper.bs","UniversalSearchEndFalcoEvent","UniversalSearchResultSelectedFalcoEvent","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=c("gkx")("4438"),i=c("gkx")("4370"),j=function(a){if(a==="offline"||a==="offline_nullstate"||a==="secure")return[0];return a==="server"?[1,2]:[]};function a(a,b,e,f,g){var k=e.rawData;e=k.id;var l=2,m=3;k.isE2e&&(l=0,m=1);var n=e,o=5,p=7;e=k.serverSearchResult;if(e!=null){e=d("MWJewelSearchTypeaheadHelper.bs").getLoggingValues(e);o=e.resultType;l=e.threadType;n=e.resultFbid}var q=((e=k.renderIndex)!=null?e:-1).toString();c("LsUniversalSearchResultSelectedFalcoEvent").log(function(){return{data_sources:j(k.searchSource),instance_id:a,recipient_ids:f,result_index_without_header:q,search_result:{query_string:b,result_fbid:n,result_index:q,result_type:o},thread_type:l,ui_section:0}});c("LsUniversalSearchEndFalcoEvent").log(function(){return{end_action:6,instance_id:a,recipient_ids:f,thread_type:l}});i&&(c("UniversalSearchResultSelectedFalcoEvent").log(function(){return{data_sources:j(k.searchSource),is_epd:h||k.isEPD,search_result:{query_string:b,result_fbid:n,result_index:q,result_type:p},session_id:a,transport_type:m,ui_section:1}}),g.current||(c("UniversalSearchEndFalcoEvent").log(function(){return{end_action:7,is_epd:h||k.isEPD,session_id:a,transport_type:m}}),g.current=!0))}g.logResultSelected=a}),98);
__d("UniversalSearchQueryChangedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("843");c=b("FalcoLoggerInternal").create("universal_search_query_changed",a);e.exports=c}),null);
__d("UniversalSearchStartFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("840");c=b("FalcoLoggerInternal").create("universal_search_start",a);e.exports=c}),null);
__d("createMWJewelSearchTypeaheadViewStrategy.react",["CometTypeaheadProgressGlimmer.react","MWJewelLightspeedSearchTypeaheadViewList.react","MWJewelSearchEmptyState.react","MWJewelSearchTypeaheadViewItem.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){return function(b){var d=b.ariaProps,e=b.entries;b.extraViewProps;var f=b.highlightedEntry,g=b.isLoading;b.onAbandonTypeahead_DO_NOT_USE;var i=babelHelpers.objectWithoutPropertiesLoose(b,["ariaProps","entries","extraViewProps","highlightedEntry","isLoading","onAbandonTypeahead_DO_NOT_USE"]);b=e.length===0&&i.queryString.length>0;g=e.length>0&&g;return b?h.jsx(c("MWJewelSearchEmptyState.react"),{queryString:i.queryString}):h.jsxs(h.Fragment,{children:[h.jsx(c("MWJewelLightspeedSearchTypeaheadViewList.react"),{ariaProps:d,entries:e,highlightedEntry:f,xstyle:a,children:function(a){var b=a.entry,d=a.isActive;a=a.itemRole;return h.createElement(c("MWJewelSearchTypeaheadViewItem.react"),babelHelpers["extends"]({},i,{entry:b,isActive:d,key:b.key,role:a}))}}),g&&h.jsx(c("CometTypeaheadProgressGlimmer.react"),{})]})}}g["default"]=a}),98);
__d("MWJewelSearchSubscriptionTypeahead.react",["fbt","BaseSubscriptionTypeahead.react","CometTypeaheadBackButton.react","CometTypeaheadInputRoundedStrategy.react","CometTypeaheadLayoutContextualStrategy.react","LsUniversalSearchEndFalcoEvent","LsUniversalSearchQueryChangedFalcoEvent","LsUniversalSearchStartFalcoEvent","MAWGating","MWChatSearchIssueLightspeedQuery.bs","MWChatSearchTypeaheadLightspeedSubscriptionDataSource","MWLSSearchIssueSearchQuerySupportedTypes.bs","MWLSThreadDisplayContext.re","MWPSearchSystem.bs","MWSearchLogging","UniversalSearchEndFalcoEvent","UniversalSearchQueryChangedFalcoEvent","UniversalSearchStartFalcoEvent","clearTimeout","createMWJewelSearchTypeaheadViewStrategy.react","gkx","react","setTimeout","useReStore","uuid"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");b=d("react");var j=b.useCallback,k=b.useMemo,l=b.useRef,m=b.useState,n={searchInput:{marginTop:"x1xmf6yo",marginEnd:"x11i5rnm",marginBottom:"x1e56ztr",marginStart:"x1mh8g0r",paddingTop:"xexx8yu",paddingEnd:"x1pi30zi",paddingBottom:"x18d9i69",paddingStart:"x1swvt13",$$css:!0},searchView:{borderTopStartRadius:"x1lq5wgf",borderTopEndRadius:"xgqcy7u",borderBottomEndRadius:"x30kzoy",borderBottomStartRadius:"x9jhf4c",boxShadow:"x1gnnqk1",display:"x78zum5",minHeight:"x1vvvjs8",$$css:!0}},o=c("createMWJewelSearchTypeaheadViewStrategy.react")(),p=["1001"],q=c("gkx")("6395"),r=c("gkx")("4438"),s=c("gkx")("4370");function a(a){var b=a.onBlur,e=a.onChange,f=a.onFocus,g=a.onPressEntry,t=a.onSelectFreeformQuery,u=babelHelpers.objectWithoutPropertiesLoose(a,["onBlur","onChange","onFocus","onPressEntry","onSelectFreeformQuery"]);a=m(null);var v=a[0],w=a[1],x=l(null),y=c("useReStore")(),z=l(!1),A=c("MWLSThreadDisplayContext.re").useHook();a=k(function(){return new(c("MWChatSearchTypeaheadLightspeedSubscriptionDataSource"))({database:y,excludedIDs:[],includeGroupSearch:A!=="ChatTab"&&c("gkx")("1902857"),includeMessageSearchEntry:!1,includeRecommendations:!0,lightspeedSupportedTypes:d("MWLSSearchIssueSearchQuerySupportedTypes.bs").allSupportedTypes,source:d("MWChatSearchIssueLightspeedQuery.bs").Surfaces.universal})},[y,A]);var B=j(function(){w(null),v!=null&&(c("LsUniversalSearchEndFalcoEvent").log(function(){return{end_action:0,instance_id:v,recipient_ids:p}}),s&&(z.current||(x.current!=null&&(c("clearTimeout")(x.current),x.current=null),c("UniversalSearchEndFalcoEvent").log(function(){return{end_action:8,is_epd:r,session_id:v,transport_type:null}}),z.current=!0))),e("")},[e,v]),C=j(function(a){var b=function(){x.current!=null&&(c("clearTimeout")(x.current),x.current=null),g!=null&&g(a)};if(v==null){b();return}d("MWSearchLogging").logResultSelected(v,u.queryString,a,p,z);b()},[g,v,u.queryString]),D=j(function(){q&&d("MWPSearchSystem.bs").clearAll(y);var a=c("uuid")();w(a);z.current=!1;c("LsUniversalSearchStartFalcoEvent").log(function(){return{instance_id:a}});s&&(c("UniversalSearchStartFalcoEvent").log(function(){return{is_epd:r,session_id:a}}),c("UniversalSearchQueryChangedFalcoEvent").log(function(){return{query_length:"0",query_string:null,session_id:a}}));x.current=c("setTimeout")(function(){w(null),c("LsUniversalSearchEndFalcoEvent").log(function(){return{end_action:3,instance_id:a,recipient_ids:p}}),s&&(z.current||(c("UniversalSearchEndFalcoEvent").log(function(){return{end_action:8,is_epd:r,session_id:a,transport_type:null}}),z.current=!0))},3e4)},[y]),E=j(function(a){v!=null&&(c("LsUniversalSearchQueryChangedFalcoEvent").log(function(){return{instance_id:v,query_string:a}}),s&&c("UniversalSearchQueryChangedFalcoEvent").log(function(){return{query_length:a.length.toString(),query_string:a,session_id:v}})),e(a)},[e,v]);return i.jsx(c("BaseSubscriptionTypeahead.react"),{dataSource:a,dataSourceFetchConfigParams:d("MAWGating").isArmadillo()?{requestFlow:"network-upon-approve"}:void 0,inputExtraProps:{hideIconAnimation:!0,hideIconOnFocus:!0},inputStartContent:v?i.jsx(c("CometTypeaheadBackButton.react"),{testid:void 0}):null,inputStrategyRenderer:c("CometTypeaheadInputRoundedStrategy.react"),layoutStrategyRenderer:c("CometTypeaheadLayoutContextualStrategy.react"),loggingContext:"messenger_jewel",onBlur:b,onChange:E,onClose:B,onFocus:f,onOpen:D,onPressEntry:C,onSelectFreeformQuery:t,placeholder:h._("__JHASH__ktsKn3dbNLm__JHASH__"),queryString:u.queryString,shouldHandleCloseAfterHandlePressEntry:!0,shouldQueryStringUpdateFromSelectedEntryOnClick:!1,viewStrategyRenderer:o,xstyles:{inputXStyle:n.searchInput,viewXStyle_DO_NOT_USE:n.searchView}})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useHasUnjoinedCMThreads",["MessagingThreadType.re","ReQL","ReQLSuspense","useReStore"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=c("useReStore")();return!!d("ReQLSuspense").useFirst(function(){return d("ReQL").union(d("ReQL").fromTableDescending(a.table("threads").index("threadTypeLastActivityTimestampMs")).getKeyRange(c("MessagingThreadType.re").communityBroadcastUnjoinedThread),d("ReQL").fromTableDescending(a.table("threads").index("threadTypeLastActivityTimestampMs")).getKeyRange(c("MessagingThreadType.re").communityGroupUnjoined))},[a])}g["default"]=a}),98);
__d("MAWUnsupportedIndexedDBNuxKey",["WebStorage"],(function(a,b,c,d,e,f,g){"use strict";var h="maw_unsupported_browser_nux_dismissed",i="dismissed";a=function(){var a;return((a=c("WebStorage").getLocalStorageForRead())==null?void 0:a.getItem(h))===i};b=function(){var a;(a=c("WebStorage").getLocalStorage())==null?void 0:a.setItem(h,i)};g.getIsDismissed=a;g.setIsDismissed=b}),98);
__d("MAWUserVisibleErrorsNuxWrapper.react",["fbt","CometPlaceholder.react","MAWIssueNewUserVisibleErrors","MAWUnsupportedIndexedDBNuxKey","QPLUserFlow","ReQL","ReQLSuspense","WebStorage","cr:1040","cr:3266","cr:4216","cr:595","gkx","qpl","react","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");e=d("react");var j=e.useCallback,k=e.useState;function a(a){var e;a=a.children;var f=k(d("MAWUnsupportedIndexedDBNuxKey").getIsDismissed()),g=f[0],l=f[1];f=window.indexedDB!=null&&c("WebStorage").getLocalStorage()!=null;e=(e=b("cr:4216").buildUri({cms_id:"597429858389632"}).setDomain("www.facebook.com"))==null?void 0:(e=e.setProtocol("https"))==null?void 0:e.toString();e={label:h._("__JHASH__W_KwwnBzw9K__JHASH__"),linkProps:{target:"_blank",url:e}};var m=!1;switch(!0){case b("cr:595")&&c("gkx")("1789"):m=!0;break;case b("cr:595")&&!f:m=!0;break;case b("cr:595")&&b("cr:3266")!=null&&!b("cr:3266").isDBCreated():m=!0;break}var n=c("useReStore")(),o=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableDescending(n.table("user_visible_errors")).filter(function(a){a=a.presentationStyle;return a==="banner"})},[n]),p=j(function(){o!=null&&o.errorId!=null&&(d("MAWIssueNewUserVisibleErrors").deleteUserVisibleError(n,o.errorId),window.location.reload(!0))},[n,o]);f=d("MAWIssueNewUserVisibleErrors").errorMsgBodyToFbtMap.get(o==null?void 0:o.errorBodyText);var q=d("MAWIssueNewUserVisibleErrors").errorMsgTitleToFbtMap.get(o==null?void 0:o.errorTitleText);return i.jsx(c("CometPlaceholder.react"),{fallback:null,children:b("cr:595")&&m&&!g?i.jsx(b("cr:595"),{nuxBodyText:d("MAWIssueNewUserVisibleErrors").MAWUnsupportedIndexedDBErrorMsg,nuxButtonProps:e,nuxTitleText:d("MAWIssueNewUserVisibleErrors").MAWUnsupportedIndexedDBErrorMsgTitle,onCloseButtonClick:function(){l(!0),d("MAWUnsupportedIndexedDBNuxKey").setIsDismissed()}}):o&&b("cr:1040")&&q!=null&&f!=null?i.jsx(b("cr:1040"),{nuxBodyText:f,nuxButtonProps:{label:h._("__JHASH__PnVpnKg9Gg___JHASH__"),onPress:function(){c("QPLUserFlow").addPoint(c("qpl")._(1056846286,"652"),"clicked_refresh"),p()}},nuxTitleText:q,onCloseButtonClick:function(){d("MAWIssueNewUserVisibleErrors").deleteUserVisibleError(n,o.errorId)}}):a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWThreadListMarketplaceItem.bs",["fbt","ix","LsSystemFolder.bs","MWIcon.react","MWPBumpEntityKey","MWThreadListFolderItem.bs","bs_curry","fbicon","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react");function a(a){var b=a.onClick,e=a.responsive,f=a.selectedThreadKey,g=a.size;a=a.thread;return j.jsx(d("MWThreadListFolderItem.bs").make,{icon:j.jsx(c("MWIcon.react"),{color:"primary",icon:d("fbicon")._(i("1027308"),32),size:56}),onClick:function(a){c("bs_curry")._1(b,d("LsSystemFolder.bs").mplace);return d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.sidebar","marketplace_threads")},responsive:e,selectedThreadKey:f,size:g,systemFolder:d("LsSystemFolder.bs").mplace,thread:a,threadName:h._("__JHASH__0Ktcc3EsRI7__JHASH__")})}a.displayName=a.name+" [from "+f.id+"]";b=a;e=b;g.make=e}),98);/*FB_PKG_DELIM*/
__d("useLiveCostreamerTagSubscription_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="5422329641195523"}),null);
__d("useLiveCostreamerTagSubscription.graphql",["useLiveCostreamerTagSubscription_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{kind:"Variable",name:"data",variableName:"input"}],d={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},e=[d],f={alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"tagged_page",plural:!1,selections:[d,{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"currently_live_video",plural:!1,selections:e,storageKey:null}],storageKey:null},g={args:null,documentName:"useLiveCostreamerTagSubscription",fragmentName:"VideoPlayerCostreamingControl_video",fragmentPropName:"video",kind:"ModuleImport"};e={alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[d,{alias:null,args:null,concreteType:"VideoLiveCostreamingStreamersConnection",kind:"LinkedField",name:"live_costreaming_streamers",plural:!1,selections:[{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"nodes",plural:!0,selections:e,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null}],storageKey:null}],storageKey:null};var h={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i=[h,d],j=[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"useLiveCostreamerTagSubscription",selections:[{alias:null,args:c,concreteType:"LiveVideoTagSubscribeResponsePayload",kind:"LinkedField",name:"live_video_tag_subscribe",plural:!1,selections:[f,{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"tagged_video",plural:!1,selections:[d,{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"if_viewer_can_see_costreaming_tools",plural:!1,selections:[g],storageKey:null},{alias:null,args:null,concreteType:"VideoLiveCostreamingStreamersConnection",kind:"LinkedField",name:"live_costreaming_streamers",plural:!1,selections:[{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"currently_live_video",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"CometVideoPlayerCostreamingThumbnailRowInner_video"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},e],storageKey:null}],type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"useLiveCostreamerTagSubscription",selections:[{alias:null,args:c,concreteType:"LiveVideoTagSubscribeResponsePayload",kind:"LinkedField",name:"live_video_tag_subscribe",plural:!1,selections:[f,{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"tagged_video",plural:!1,selections:[d,{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"if_viewer_can_see_costreaming_tools",plural:!1,selections:[g,d],storageKey:null},{alias:null,args:null,concreteType:"VideoLiveCostreamingStreamersConnection",kind:"LinkedField",name:"live_costreaming_streamers",plural:!1,selections:[{alias:null,args:null,concreteType:"Page",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"currently_live_video",plural:!1,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"video_channel",plural:!1,selections:i,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[h,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:j,storageKey:null},d],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"animated_image_caption",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"original_width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"original_height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"broadcaster_origin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"broadcast_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"broadcast_status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dash_manifest",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_live_streaming",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_live_trace_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_looping",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_video_broadcast",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_podcast_video",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"loop_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_spherical",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_spherical_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"unsupported_browser_message",storageKey:null},{alias:null,args:null,concreteType:"MusicVideoMetadata",kind:"LinkedField",name:"pmv_metadata",plural:!1,selections:i,storageKey:null},{alias:null,args:null,concreteType:"LatencySensitiveConfig",kind:"LinkedField",name:"latency_sensitive_config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"broadcast_latency_sensitivity",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"LivePlaybackInstrumentationConfigParams",kind:"LinkedField",name:"live_playback_instrumentation_configs",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_client_triggered_trace_enabled",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_ncsr",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"permalink_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captions_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dash_prefetch_experimental",storageKey:null},{alias:null,args:null,concreteType:"VideoCaptionLocale",kind:"LinkedField",name:"video_available_captions_locales",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"localized_creation_method",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"can_use_oz",storageKey:null},{alias:"playable_url_dash",args:[{kind:"Literal",name:"scrubbing_preference",value:"MPEG_DASH"}],kind:"ScalarField",name:"playable_url",storageKey:'playable_url(scrubbing_preference:"MPEG_DASH")'},{alias:null,args:null,kind:"ScalarField",name:"min_quality_preference",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_rss_podcast_video",storageKey:null},{alias:null,args:null,concreteType:"VideoPlayerShakaLiveP2PInit",kind:"LinkedField",name:"video_player_shaka_live_p2p_init",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"json_encoded_video_data",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"playable_url",storageKey:null},{alias:"playable_url_quality_hd",args:[{kind:"Literal",name:"quality",value:"HD"}],kind:"ScalarField",name:"playable_url",storageKey:'playable_url(quality:"HD")'},{alias:null,args:null,concreteType:"SphericalVideoFallbackUrls",kind:"LinkedField",name:"spherical_video_fallback_urls",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hd",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sd",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_gaming_video",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_latency_menu_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fbls_tier",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_latency_sensitive_broadcast",storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"selected_latency_setting",storageKey:null}]},{alias:null,args:null,kind:"ScalarField",name:"comet_video_player_static_config",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"comet_video_player_context_sensitive_config",storageKey:null},{alias:null,args:null,concreteType:"VideoPlayerShakaPerformanceLoggerInit",kind:"LinkedField",name:"video_player_shaka_performance_logger_init",plural:!1,selections:[{args:null,documentName:"useVideoPlayerShakaPerformanceLoggerRelayImpl_video",fragmentName:"useVideoPlayerShakaPerformanceLoggerRelayImpl_init",fragmentPropName:"init",kind:"ModuleImport"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"video_player_shaka_performance_logger_should_sample",storageKey:null},{alias:"video_player_shaka_performance_logger_init2",args:null,concreteType:"VideoPlayerShakaPerformanceLoggerInit",kind:"LinkedField",name:"video_player_shaka_performance_logger_init",plural:!1,selections:[{args:null,documentName:"useVideoPlayerShakaPerformanceLoggerBuilder_video",fragmentName:"useVideoPlayerShakaPerformanceLoggerBuilder_init",fragmentPropName:"init",kind:"ModuleImport"},{alias:null,args:null,kind:"ScalarField",name:"per_session_sampling_rate",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"autoplay_gating_result",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewer_autoplay_setting",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"can_autoplay",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"drm_info",storageKey:null},{alias:null,args:null,concreteType:"VideoP2PSettings",kind:"LinkedField",name:"p2p_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ticket",storageKey:null},{alias:null,args:null,concreteType:"VideoP2PSettingsConfig",kind:"LinkedField",name:"config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"delay_p2p_until_play",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"disable_hivejava_for_livevc",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VideoHiveCommunityInfo",kind:"LinkedField",name:"community_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"community_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"community_name",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VideoHiveInitializationOptions",kind:"LinkedField",name:"hive_initialization_options",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoHiveInitializationOptionHiveJava",kind:"LinkedField",name:"hive_java",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"min_version",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hive_tech_order",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"debug_level",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AudioSettings",kind:"LinkedField",name:"audio_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"video_volume_setting",storageKey:null},d],storageKey:null},{alias:null,args:null,concreteType:"CaptionsSettings",kind:"LinkedField",name:"captions_settings",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"always_show_captions",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captions_background_color",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captions_background_opacity",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captions_text_color",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captions_text_size",storageKey:null},d],storageKey:null},{alias:null,args:null,concreteType:"VideoBroadcastLowLatencyConfig",kind:"LinkedField",name:"broadcast_low_latency_config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ll_desired_latency_ms",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ll_latency_tolerance_ms",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"audio_availability",storageKey:null},{alias:null,args:null,concreteType:"VideoMutedSegment",kind:"LinkedField",name:"muted_segments",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"mute_start_time_in_sec",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mute_end_time_in_sec",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SphericalVideoRenderer",kind:"LinkedField",name:"spherical_video_renderer",plural:!1,selections:[{args:null,documentName:"VideoPlayerRelay_video_spherical_video_renderer",fragmentName:"VideoPlayerSphericalRelay_sphericalVideoRenderer",fragmentPropName:"sphericalVideoRenderer",kind:"ModuleImport"}],storageKey:null},{"if":null,kind:"Defer",label:"VideoPlayerRelay_video$defer$InstreamVideoAdBreaksPlayer_video",selections:[d,{alias:null,args:null,concreteType:"InstreamExtraConfig",kind:"LinkedField",name:"instream_extra_config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"instream_halo_delay_time_seconds",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"InstreamVideoAdBreaks",kind:"LinkedField",name:"instream_video_ad_breaks_comet",plural:!1,selections:[{args:null,documentName:"InstreamVideoAdBreaksPlayer_video_instream_video_ad_breaks_comet",fragmentName:"InstreamVideoAdBreaksPlayerImpl_adBreaks",fragmentPropName:"adBreaks",kind:"ModuleImport"}],storageKey:null}]},{alias:null,args:null,concreteType:"VideoThumbnail",kind:"LinkedField",name:"preferred_thumbnail",plural:!1,selections:[{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:j,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"image_preview_payload",storageKey:null},d],storageKey:null},{alias:null,args:null,concreteType:"VideoIMFData",kind:"LinkedField",name:"video_imf_data",plural:!1,selections:[{args:null,documentName:"useVideoPlayerIMFFromVideoMetadataRelay_video",fragmentName:"useVideoPlayerIMFFromVideoMetadataRelay_video_imf_data",fragmentPropName:"video_imf_data",kind:"ModuleImport"}],storageKey:null}],storageKey:null},d],storageKey:null}],storageKey:null}],storageKey:null},e],storageKey:null}]},params:{id:b("useLiveCostreamerTagSubscription_facebookRelayOperation"),metadata:{subscriptionName:"live_video_tag_subscribe"},name:"useLiveCostreamerTagSubscription",operationKind:"subscription",text:null}}}();e.exports=a}),null);
__d("fetchCtvCastPayloadQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="4867407706706103"}),null);
__d("fetchCtvCastPayloadQuery.graphql",["fetchCtvCastPayloadQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"castSessionID"},c={defaultValue:null,kind:"LocalArgument",name:"mediaParameters"},d={defaultValue:null,kind:"LocalArgument",name:"requestID"},e=[{alias:null,args:[{kind:"Variable",name:"cast_session_id",variableName:"castSessionID"},{kind:"Literal",name:"caster_id",value:0},{kind:"Variable",name:"media_parameters_json",variableName:"mediaParameters"},{kind:"Literal",name:"receiver_app_id",value:1614120985559993},{kind:"Variable",name:"request_id",variableName:"requestID"},{kind:"Literal",name:"uses_secure_connection",value:!0}],kind:"ScalarField",name:"ctv_cast_payload",storageKey:null}];return{fragment:{argumentDefinitions:[a,c,d],kind:"Fragment",metadata:null,name:"fetchCtvCastPayloadQuery",selections:e,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,d,c],kind:"Operation",name:"fetchCtvCastPayloadQuery",selections:e},params:{id:b("fetchCtvCastPayloadQuery_facebookRelayOperation"),metadata:{},name:"fetchCtvCastPayloadQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("fetchVideoCastPayloadQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="4715510405214458"}),null);
__d("fetchVideoCastPayloadQuery.graphql",["fetchVideoCastPayloadQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"castSessionID"},c={defaultValue:null,kind:"LocalArgument",name:"playerOrigin"},d={defaultValue:null,kind:"LocalArgument",name:"playerSubOrigin"},e={defaultValue:null,kind:"LocalArgument",name:"videoID"},f=[{kind:"Variable",name:"id",variableName:"videoID"}],g={alias:null,args:[{kind:"Variable",name:"cast_session_id",variableName:"castSessionID"},{kind:"Variable",name:"player_origin",variableName:"playerOrigin"},{kind:"Variable",name:"player_suborigin",variableName:"playerSubOrigin"}],kind:"ScalarField",name:"video_cast_payload",storageKey:null};return{fragment:{argumentDefinitions:[a,c,d,e],kind:"Fragment",metadata:null,name:"fetchVideoCastPayloadQuery",selections:[{alias:null,args:f,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[g],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[e,c,d,a],kind:"Operation",name:"fetchVideoCastPayloadQuery",selections:[{alias:null,args:f,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:b("fetchVideoCastPayloadQuery_facebookRelayOperation"),metadata:{},name:"fetchVideoCastPayloadQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("LiveVideoLatencyMenuContextProvider_video.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"LiveVideoLatencyMenuContextProvider_video",selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"if_viewer_can_use_latency_menu",plural:!1,selections:[{args:null,documentName:"LiveVideoLatencyMenuContextProvider_video_if_viewer_can_use_latency_menu",fragmentName:"VideoPlayerSettingsMenuLatencyPane_video",fragmentPropName:"video",kind:"ModuleImport"}],storageKey:null},action:"NONE",path:"if_viewer_can_use_latency_menu"},{kind:"RequiredField",field:{alias:"if_viewer_can_use_latency_menu_toggle",args:null,concreteType:"Video",kind:"LinkedField",name:"if_viewer_can_use_latency_menu",plural:!1,selections:[{args:null,documentName:"LiveVideoLatencyMenuContextProvider_video_if_viewer_can_use_latency_menu_toggle",fragmentName:"VideoPlayerSettingsMenuLatencyPaneToggle_video",fragmentPropName:"video",kind:"ModuleImport"}],storageKey:null},action:"NONE",path:"if_viewer_can_use_latency_menu_toggle"}],type:"Video",abstractKey:null};e.exports=a}),null);
__d("VideoPlayerCometFeedStoryControlsImplLive_video.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerCometFeedStoryControlsImplLive_video",selections:[{args:null,kind:"FragmentSpread",name:"VideoPlayerLiveVideoControls_video"}],type:"Video",abstractKey:null};e.exports=a}),null);
__d("VideoPlayerCometFeedStoryControlsImplNotLive_video.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerCometFeedStoryControlsImplNotLive_video",selections:[{args:null,kind:"FragmentSpread",name:"VideoPlayerScrubberPreview_video"},{args:null,kind:"FragmentSpread",name:"VideoPlayerWatchAndScrollControl_video"},{args:null,kind:"FragmentSpread",name:"VideoPlayerCaptionsControl_video"},{alias:null,args:null,concreteType:"Group",kind:"LinkedField",name:"recipient_group",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captions_url",storageKey:null}],type:"Video",abstractKey:null};e.exports=a}),null);
__d("VideoPlayerDefaultControlsImplMusicClip_video.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerDefaultControlsImplMusicClip_video",selections:[{alias:null,args:null,concreteType:"XFBMusicAttachmentMetadata",kind:"LinkedField",name:"music_attachment_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"end_time_ms",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"start_time_ms",storageKey:null}],storageKey:null}],type:"Video",abstractKey:null};e.exports=a}),null);
__d("VideoPlayerWithVideoCardsOverlay_video.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerWithVideoCardsOverlay_video",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"comet_video_player_with_video_card_renderer",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,documentName:"VideoPlayerWithVideoCardsOverlay_video",fragmentName:"VideoPlayerVideoCardsOverlay_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"CometVideoPlayerWithVideoCardRenderer",abstractKey:null}],storageKey:null}],type:"Video",abstractKey:null};e.exports=a}),null);
__d("useLiveCostreamerTagSubscription.react",["CometRelay","react","useLiveCostreamerTagSubscription.graphql","uuid"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react").useMemo;function a(a,e,f){var g=h!==void 0?h:h=b("useLiveCostreamerTagSubscription.graphql"),j=i(function(){return{onNext:f,subscription:g,updater:function(a){var b;a=a.getRootField("live_video_tag_subscribe");b=a==null?void 0:(b=a.getLinkedRecord("tagged_page"))==null?void 0:b.getLinkedRecord("currently_live_video");a=a==null?void 0:a.getLinkedRecord("tagged_video");b==null&&a!=null&&a.setValue(null,"if_viewer_can_see_costreaming_tools")},variables:{input:{client_subscription_id:c("uuid")(),tagged_page_id:a,tagged_video_id:e}}}},[f,a,g,e]);d("CometRelay").useSubscription(j)}g["default"]=a}),98);
__d("LiveCostreamerTagSubscription.react",["useLiveCostreamerTagSubscription.react"],(function(a,b,c,d,e,f,g){"use strict";function a(a){c("useLiveCostreamerTagSubscription.react")(a.pageID,a.videoID,a.onNext);return null}g["default"]=a}),98);
__d("CastingChromecastAPIWrapper",["cr:1885117"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:1885117")}),98);
__d("CastingChromecastSession",["Promise","err","recoverableViolation","removeFromArray"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,d){var e=this;this.$3=null;this.$4=[];this.$5=[];this.$6=[];this.$7=[];this.$8=[];this.$9=[];this.$10=[];this.$11=[];this.$12=function(a,b){if(a===e.$2){var d=e.$4.slice();d.forEach(function(a){a(b)})}else e.$6.slice().forEach(function(b){b(c("err")("Namespace does not match. Expected "+e.$2+" but received "+a),"CastingChromecastSession._onMessageReceived")})};this.$1=a;this.$2=b;this.$3=d;d.addMessageListener(this.$2,this.$12)}var d=a.prototype;d.destroy=function(){var a=this.$3;a!=null&&(a.status!=null&&a.status!=="disconnected"&&c("recoverableViolation")("Destroying receiver session that is not disconnected. Status, "+a.status,"comet_cast_sender"),a.removeMessageListener(this.$2,this.$12));this.$3=null};d.isCasting=function(){return this.$3!=null};d.isConnected=function(){return this.$3!=null&&this.$3.status==="connected"};d.isDisconnected=function(){return this.$3!=null&&this.$3.status==="disconnected"};d.disconnect=function(){var a=this;this.$5.slice().forEach(function(a){a()});return new(b("Promise"))(function(b,c){a.$3!=null?a.$3.stop(b,c):b()})["catch"](function(b){if(a.$3!=null&&a.$3.status!=="stopped"){a.$6.slice().forEach(function(a){a(b,"CastingChromecastSession.disconnect")});throw b}})["finally"](function(){var b=a.$3;a.$3=null;b&&b.removeMessageListener(a.$2,a.$12);a.$7.slice().forEach(function(a){a()})})};d.getVolume=function(){var a=this.$13();return a?a.level:null};d.getFriendlyName=function(){return this.$14()};d.setVolume=function(a){var d=this,e=this.$3;return new(b("Promise"))(function(b,d){if(e==null){d(c("err")("Cannot set volume without a session"));return}e.setReceiverVolumeLevel(a,b,d)})["catch"](function(a){d.$6.slice().forEach(function(b){b(a,"CastingChromecastSession.setVolume")});throw a})};d.isMuted=function(){var a=this.$13();return a?a.muted:null};d.mute=function(){return this.$15(!0)};d.unmute=function(){return this.$15(!1)};d.sendMessage=function(a){var d=this;return new(b("Promise"))(function(b,e){var f=d.$3;if(f==null){e(c("err")("The message can not be sent without a session"));return}f.sendMessage(d.$2,a,b,e)})["catch"](function(a){d.$6.slice().forEach(function(b){b(a,"CastingChromecastSession.sendMessage")});throw a})};d.$13=function(){var a;a=(a=this.$3)==null?void 0:(a=a.receiver)==null?void 0:a.volume;return a==null?null:a};d.$14=function(){var a;return((a=this.$3)==null?void 0:a.receiver.friendlyName)||null};d.$15=function(a){var d=this;return new(b("Promise"))(function(b,e){var f=d.$3;if(f==null){e(c("err")("The muted state can not be set without a session"));return}f.setReceiverMuted(a,b,e)})["catch"](function(a){d.$6.slice().forEach(function(b){b(a,"CastingChromecastSession._setIsMuted")});throw a})};d.onMessage=function(a){var b=this.$4;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};d.onDisconnecting=function(a){var b=this.$5;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};d.onError=function(a){var b=this.$6;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};d.onDisconnected=function(a){var b=this.$7;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};d.onVideoLoading=function(a){var b=this.$8;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};d.onVideoLoaded=function(a){var b=this.$9;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};d.onVideoPlaying=function(a){var b=this.$10;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};d.onVideoPaused=function(a){var b=this.$11;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};return a}();g["default"]=a}),98);
__d("CastingErrorUtils",["ErrorMetadata","err","getErrorSafe"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return a!=null&&typeof a==="object"&&typeof a.code==="string"&&a.code===b}function b(a){return a!=null&&typeof a==="object"&&typeof a.code==="string"?c("err")("Chromecast error: %s, keys: %s","cast.ChromecastError",JSON.stringify({code:a.code})):c("getErrorSafe")(a)}function d(a,b){a.metadata==null&&(a.metadata=new(c("ErrorMetadata"))());var d=a.metadata;b=b==null?void 0:b.videoID;b!=null&&d.addEntries(["COMET_VIDEO","VIDEO_ID",b]);return a}g.isChromecastError=a;g.getCastingErrorSafe=b;g.appendCastingMetadataToExpandedError=d}),98);
__d("ConnectedTvLoggingFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1843753");c=b("FalcoLoggerInternal").create("connected_tv_logging",a);e.exports=c}),null);
__d("CastingChromecastScanner",["CastingChromecastAPIWrapper","CastingChromecastSession","CastingErrorUtils","ConnectedTvLoggingFalcoEvent","Promise","err","performanceAbsoluteNow","promiseDone","removeFromArray"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){this.$6=null,this.$7=[],this.$8=[],this.$9=[],this.$10=[],this.$11=[],this.$12=[],this.$13=[],this.$14=[],this.$15=[],this.$1=a,this.$2=b,this.$4=!1,this.$3=!1,this.$5=new Set()}var e=a.prototype;e.init=function(){if(this.$6!=null)return b("Promise").reject(c("err")("Scanner can only be initialized once."));this.$6=this.$16();return this.$6};e.ready=function(){return this.$6==null?b("Promise").reject(c("err")("Scanner should be initialized.")):this.$6};e.hasSupport=function(){return this.$3};e.hasFoundReceiver=function(){return this.$4};e.getSession=function(){var a=this;if(!this.$4)return b("Promise").reject(c("err")("No receivers found"));this.$13.slice().forEach(function(a){a()});return this.$17().then(function(b){var c=a.$18(b);a.$5.add(c);a.$14.slice().forEach(function(a){a(c)});return c})["catch"](function(b){a.$10.slice().forEach(function(a){a()});a.$11.slice().forEach(function(a){a()});throw b})};e.$16=function(){var a=this;this.$3=!0;return this.$19().then(function(b){return a.$20()}).then(function(b){a.$9.slice().forEach(function(a){a()})}).then(function(b){return a.$21()})["catch"](function(b){!d("CastingErrorUtils").isChromecastError(b,"not_supported")&&!d("CastingErrorUtils").isChromecastError(b,"extension_not_available")&&!d("CastingErrorUtils").isChromecastError(b,"extension_no_casting_script")&&a.$8.slice().forEach(function(a){a(b,"CastingChromecastScanner._init")});throw b})};e.$21=function(){var a=this,d=this.$1;if(d==null)return b("Promise").reject(c("err")("App ID is not defined"));var e=function(b){var c=a.$18(b);a.$14.slice().forEach(function(a){a(c)})},f=function(b){c("promiseDone")(c("CastingChromecastAPIWrapper").getIsAvailable(b).then(function(b){a.$4=b,a.$15.slice().forEach(function(b){b({foundReceiver:a.$4})})}))};return c("CastingChromecastAPIWrapper").initialize({appID:d,receiverListener:f,sessionListener:e}).then(function(){})["catch"](function(b){a.$8.slice().forEach(function(a){a(b,"CastingChromecastScanner._initializeApi")});throw b})};e.$19=function(){var a=this;return this.$1!=null?b("Promise").resolve():c("CastingChromecastAPIWrapper").getDefaultAppID().then(function(b){a.$1=b})};e.$17=function(){var a=this.$1;if(a==null)return b("Promise").reject(c("err")("App ID is not defined"));var d=c("performanceAbsoluteNow")();c("ConnectedTvLoggingFalcoEvent").log(function(){return{event:"sender_session_requested"}});return c("CastingChromecastAPIWrapper").getSession(a).then(function(a){c("ConnectedTvLoggingFalcoEvent").log(function(){return{event:"sender_session_started",perf_time_ms:Math.floor(c("performanceAbsoluteNow")()-d)}});return a})["catch"](function(a){c("ConnectedTvLoggingFalcoEvent").log(function(){return{event:"sender_session_failed",perf_time_ms:Math.floor(c("performanceAbsoluteNow")()-d),session_failure_code:typeof a.code==="string"?a.code:null,session_failure_description:a.description}});throw a})};e.$18=function(a){var b=this,d=new(c("CastingChromecastSession"))(this.$1||"",this.$2||"",a),e=d.onDisconnecting(function(){b.$12.slice().forEach(function(a){a()})}),f=d.onError(function(a,c){b.$8.slice().forEach(function(b){b(a,c)})}),g=d.onDisconnected(function(){b.$11.slice().forEach(function(a){a()}),b.$5["delete"](d),e.remove(),f.remove(),g.remove()});return d};e.$20=function(){var a=this;return c("CastingChromecastAPIWrapper").addReceiverListener({onCast:function(b){a.$7.slice().forEach(function(a){a(b)})},onStop:function(){a.$5.forEach(function(a){return a.disconnect()})}})};e.onCast=function(a){var b=this.$7;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onError=function(a){var b=this.$8;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onInit=function(a){var b=this.$9;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onSessionCancelled=function(a){var b=this.$10;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onSessionDisconnected=function(a){var b=this.$11;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onSessionDisconnecting=function(a){var b=this.$12;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onSessionRequested=function(a){var b=this.$13;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onSessionStarted=function(a){var b=this.$14;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onStatusChanged=function(a){var b=this.$15;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};return a}();g["default"]=a}),98);
__d("CastingState",[],(function(a,b,c,d,e,f){"use strict";function a(){return{isCastPending:!1,receiverExperience:null,receiverFriendlyName:null,receiverIsConnected:!1,receiverIsMuted:null,receiverVolume:null}}function b(){return{currentDuration:null,currentPlaybackState:null,currentPosition:null,currentVideoID:null,type:"video_channel"}}function c(){return{type:"photo"}}function d(){return{currentAssetID:null,currentPlaybackState:null,type:"photo_album"}}f.initialCastingState=a;f.initialVideoChannelExperienceState=b;f.initialPhotoExperienceState=c;f.initialPhotoAlbumExperienceState=d}),66);
__d("TV2PhotoAlbumReportedState",[],(function(a,b,c,d,e,f){"use strict";function a(a){return k(JSON.parse(a),m("TV2PhotoAlbumReportedState"))}function b(a){return JSON.stringify(l(a,m("TV2PhotoAlbumReportedState")),null,2)}function g(a,b,c){c===void 0&&(c="");if(c)throw Error('Invalid value for key "'+c+'". Expected type '+JSON.stringify(a)+" but got "+JSON.stringify(b));throw Error("Invalid value "+JSON.stringify(b)+" for type "+JSON.stringify(a))}function h(a){if(a.jsonToJS===void 0){var b={};a.props.forEach(function(a){return b[a.json]={key:a.js,typ:a.typ}});a.jsonToJS=b}return a.jsonToJS}function i(a){if(a.jsToJSON===void 0){var b={};a.props.forEach(function(a){return b[a.js]={key:a.json,typ:a.typ}});a.jsToJSON=b}return a.jsToJSON}function j(a,b,c,d){d===void 0&&(d="");function e(b,a){return typeof b===typeof a?a:g(b,a,d)}function f(b,a){var d=b.length;for(var e=0;e<d;e++){var f=b[e];try{return j(a,f,c)}catch(a){}}return g(b,a)}function h(b,a){return b.indexOf(a)!==-1?a:g(b,a)}function i(b,a){return!Array.isArray(a)?g("array",a):a.map(function(a){return j(a,b,c)})}function k(a){if(a===null)return null;var b=new Date(a);return isNaN(b.valueOf())?g("Date",a):b}function l(b,d,a){if(a===null||typeof a!=="object"||Array.isArray(a))return g("object",a);var e={};Object.getOwnPropertyNames(b).forEach(function(d){var f=b[d];d=Object.prototype.hasOwnProperty.call(a,d)?a[d]:void 0;e[f.key]=j(d,f.typ,c,f.key)});Object.getOwnPropertyNames(a).forEach(function(f){Object.prototype.hasOwnProperty.call(b,f)||(e[f]=j(a[f],d,c,f))});return e}if(b==="any")return a;if(b===null)return a===null?a:g(b,a);if(b===!1)return g(b,a);while(typeof b==="object"&&b.ref!==void 0)b=n[b.ref];if(Array.isArray(b))return h(b,a);if(typeof b==="object")return Object.prototype.hasOwnProperty.call(b,"unionMembers")?f(b.unionMembers,a):Object.prototype.hasOwnProperty.call(b,"arrayItems")?i(b.arrayItems,a):Object.prototype.hasOwnProperty.call(b,"props")?l(c(b),b.additional,a):g(b,a);return b===Date&&typeof a!=="number"?k(a):e(b,a)}function k(a,b){return j(a,b,h)}function l(a,b){return j(a,b,i)}function c(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return{unionMembers:b}}function d(a,b){return{props:a,additional:b}}function m(a){return{ref:a}}var n={TV2PhotoAlbumReportedState:d([{json:"media_parameters",js:"media_parameters",typ:m("MediaParameters")},{json:"media_state",js:"media_state",typ:m("MediaState")}],"any"),MediaParameters:d([{json:"album_id",js:"album_id",typ:""}],"any"),MediaState:d([{json:"photo_state",js:"photo_state",typ:c(void 0,m("PhotoMediaState"))},{json:"video_state",js:"video_state",typ:c(void 0,m("VideoMediaState"))}],"any"),PhotoMediaState:d([{json:"duration_ms",js:"duration_ms",typ:3.14},{json:"photo_id",js:"photo_id",typ:""},{json:"photo_playback_state",js:"photo_playback_state",typ:m("PhotoPlaybackState")},{json:"position_ms",js:"position_ms",typ:3.14}],"any"),VideoMediaState:d([{json:"duration_ms",js:"duration_ms",typ:3.14},{json:"position_ms",js:"position_ms",typ:3.14},{json:"video_id",js:"video_id",typ:""},{json:"video_playback_state",js:"video_playback_state",typ:m("VideoPlaybackState")}],"any"),PhotoPlaybackState:["paused","play"],VideoPlaybackState:["ended","paused","play","seeking","unknown"]};e.exports={TV2PhotoAlbumReportedStateToJson:b,toTV2PhotoAlbumReportedState:a}}),null);
__d("TV2UniqueIDs",["guid"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function i(a){var b;b=(b=h.get(a))!=null?b:0;h.set(a,b+1);return""+a+b.toString(36)}function a(){return i("id_tv2_vcr_")}function b(){return i("id_tv2_veqe_")}function d(){return i("id_tv2_toast_")}function e(){return i("id_tv2_rvr_")}function f(){return c("guid")()}g.makeTV2VideoCastRequestID=a;g.makeTV2VideoExperienceQueueEntryID=b;g.makeTV2ToastID=d;g.makeTV2RelatedVideosRequestID=e;g.makeTV2ChainingSessionID=f}),98);
__d("getTV2QueryStringCheatcodeValue",[],(function(a,b,c,d,e,f){"use strict";function b(b){try{b=new RegExp("\\b"+b+"=([^&]*)");b=b.exec(a.location.search);return!b||b[1]==null?null:b[1]}catch(a){return null}}f["default"]=b}),66);
__d("getTV2QueryStringCheatcode",["getTV2QueryStringCheatcodeValue"],(function(a,b,c,d,e,f,g){"use strict";function a(a){try{return c("getTV2QueryStringCheatcodeValue")(a)==="1"}catch(a){return!1}}g["default"]=a}),98);
__d("getTV2DebuggingEnabled",["getTV2QueryStringCheatcode"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("getTV2QueryStringCheatcode")("debugging")}g["default"]=a}),98);
__d("TV2CommsParseUtils",["TV2PhotoAlbumReportedState","TV2UniqueIDs","err","getTV2DebuggingEnabled","gkx"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a===null?"null":a===""?"empty string":Array.isArray(a)?"array":typeof a==="object"?"object with keys: "+JSON.stringify(Object.keys(a).sort()):typeof a}function i(a,b,d){if(typeof a!=="string"||a===""){var e=c("err")("Message parse error: %s expected JSON string, got %s",d,h(a));throw e}try{e=JSON.parse(a);return b(e,d)}catch(b){if("messageFormat"in b&&typeof b.messageFormat==="string"&&"messageParams"in b&&Array.isArray(b.messageParams))throw b;else{a=c("err")("Message parse error: %s expected JSON string, got error: %s",d,b.message);throw a}}}function j(a,b){if(typeof a!=="object"||a==null){b=c("err")("Message parse error: %s expected object, got %s",b,h(a));throw b}return a}function b(a,b){if(a==null)return null;if(typeof a!=="object"||a==null){b=c("err")("Message parse error: %s expected object, got %s",b,h(a));throw b}return a}function k(a,b){if(!Array.isArray(a)){b=c("err")("Message parse error: %s expected array, got %s",b,h(a));throw b}return a}function l(a,b){if(!Array.isArray(a)){var d=c("err")("Message parse error: %s expected array, got %s",b,h(a));throw d}return a.map(function(a){return n(a,b)})}function m(a,b){if(!Array.isArray(a)){var d=c("err")("Message parse error: %s expected array, got %s",b,h(a));throw d}return a.filter(Boolean).map(function(a){return n(a,b)})}function n(a,b){if(typeof a!=="string"||a===""){b=c("err")("Message parse error: %s expected non-empty string, got %s",b,h(a));throw b}return a}function o(a,b){if(a==null)return null;if(typeof a!=="string"||a===""){b=c("err")("Message parse error: %s expected optional non-empty string, got %s",b,h(a));throw b}return a}function p(a,b){if(a==null)return null;if(typeof a!=="string"){b=c("err")("Message parse error: %s expected optional string, got %s",b,h(a));throw b}return a}function q(a,b){if(a==null)return null;if(!(typeof a==="number"&&Number.isFinite(a)||typeof a==="string"&&a!=="")){b=c("err")("Message parse error: %s expected optional non-empty string or number, got %s",b,h(a));throw b}return a}function r(a,b){if(typeof a!=="number"||!Number.isFinite(a)){b=c("err")("Message parse error: %s expected finite number, got %s",b,h(a));throw b}return a}function e(a,b){if(a==null)return null;if(typeof a!=="number"||!Number.isFinite(a)){b=c("err")("Message parse error: %s expected optional finite number, got %s",b,h(a));throw b}return a}function f(a,b){return a==="true"||a===!0}function s(a,b,c){c===void 0&&(c=!1);return a==null?c:a===!0}function t(a,b){if(typeof a!=="boolean"){b=c("err")("Parse error: %s expected boolean, got %s",b,h(a));throw b}return a}function u(a,b){a=a!=null?j(a,b):null;if(a==null)return null;var c=n(a.uri,b+".uri"),d=r(a.width,b+".width");a=r(a.height,b+".height");return{height:a,uri:c,width:d}}function v(a,b){a=a!=null?j(a,b):null;if(a==null)return null;a=j(a.image,b+".image");a=n(a.uri,b+".image.uri");return{uri:a}}function w(a,b){if(a==null)return null;a=k(a,b);return a.map(function(a,b){return n(a,"["+b+"]")})}function x(a,b){return i(a,function(b,a){b=k(b,a);return b.map(function(b,c){c=a+"."+c;return z(j(b,c),c)})},b)}function y(a,b){return i(a,function(b,a){return z(j(b,a),a)},b)}function z(b,e){var f=n(b.access_token,e+".access_token"),g=String(q(b.app_id,e+".app_id")),h=p(b.app_version,e+".app_version"),i=u(b.background_image,e+".background_image"),j=o(b.channel_token,e+".channel_token"),k=o(b.channel_session_id,e+".channel_session_id"),r=p(b.end_cursor,e+".end_cursor")||null,t=s(b.from_next_video_query,e+".from_next_video_query"),x=s(b.is_ad,e+".is_ad"),y=w(b.dash_prefetched_representation_ids,e+".dash_prefetched_representation_ids"),z=o(b.entry_point,e+".entry_point"),A=o(b.player_origin===""?null:b.player_origin,e+".player_origin"),B=o(b.player_suborigin===""?null:b.player_suborigin,e+".player_suborigin"),C=v(b.preferred_thumbnail,e+".preferred_thumbnail"),D=o(b.video_channel_id,e+".video_channel_id"),E=n(b.root_video_id,e+".root_video_id"),F=c("getTV2DebuggingEnabled")()?/\bvideo_id=([0-9]+)\b/.exec(a.location.search):null;F=F&&F[1]?F[1]:n(b.video_id,e+".video_id");var G=c("gkx")("2172")?m:l;G=b.tracking_codes!=null?G(b.tracking_codes,e+".tracking_codes"):null;return{accessToken:f,appID:g,appVersion:h,backgroundImage:i,chainingEnabled:!1,channelSessionID:k,channelToken:j,dashPrefetchedRepresentationIDs:y,endCursor:r,entryPoint:z,fromNextVideoQuery:t,isAd:x,playerOrigin:A,playerSuborigin:B,preferredThumbnail:C,rootVideoID:E,startTimestamp:0,trackingCodes:G,videoCastRequestID:d("TV2UniqueIDs").makeTV2VideoCastRequestID(),videoChannelID:D,videoID:F}}function A(a,b){a=j(a,b);b=n(a.type,b+".type");switch(b){case"version_response":return a;case"version_launch_response":return a;case"experience_state":return a;case"command_result":return a;case"duration_change":return a;case"status_update":return a;case"experience_status_update":return a}b=c("err")("Parse error: %s expected response message type, got %s","parseTV2CommsFBAppOutboundMessageFromObject",h(a));throw b}function B(a){return i(a,A,".")}function C(a){a=B(a);switch(a.type){case"version_response":case"version_launch_response":case"experience_state":case"command_result":return a}a=c("err")("Parse error: %s expected response message type, got %s","parseCastingReceiverResponseMessageFromJSON",h(a));throw a}function D(a){return d("TV2PhotoAlbumReportedState").toTV2PhotoAlbumReportedState(a)}g.parseJSONString=i;g.parseObject=j;g.parseOptionalObject=b;g.parseArray=k;g.parseStringArray=l;g.parseTrackingCodes=m;g.parseNonEmptyString=n;g.parseOptionalNonEmptyString=o;g.parseOptionalString=p;g.parseNumber=r;g.parseOptionalNumber=e;g.parseOptionalStringishBoolean=f;g.parseOptionalBoolean=s;g.parseBoolean=t;g.parseVideoCastingPayloadBackgroundImage=u;g.parseVideoCastingPayloadPreferredThumbnail=v;g.parseVideoCastingPayloadListJSONAsTV2VideoCastRequestArray=x;g.parseVideoCastingPayloadJSONAsTV2VideoCastRequest=y;g.parseVideoCastingPayloadAsTV2VideoCastRequest=z;g.parseTV2CommsFBAppOutboundMessageFromJSON=B;g.parseCastingReceiverResponseMessageFromJSON=C;g.parseCastingReceiverPhotoAlbumReportedState=D}),98);
__d("fetchCtvCastPayload",["CometRelay","err","fetchCtvCastPayloadQuery.graphql","getErrorSafe","guid"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h!==void 0?h:h=b("fetchCtvCastPayloadQuery.graphql");function a(a){var b=a.castSessionID;a=a.environment;return d("CometRelay").fetchQuery(a,i,{castSessionID:b,mediaParameters:"{}",requestID:c("guid")()}).toPromise().then(function(a){if(a!=null&&a.ctv_cast_payload!=null&&typeof a.ctv_cast_payload==="string")return{payload:a.ctv_cast_payload,type:"loaded"};else return{error:c("err")("Payload was not string"),type:"error"}})["catch"](function(a){a=c("getErrorSafe")(a);return{error:a,type:"error"}})}function e(a){var b=a.albumID,e=a.castSessionID;a=a.environment;return d("CometRelay").fetchQuery(a,i,{castSessionID:e,mediaParameters:JSON.stringify({album_id:b}),requestID:c("guid")()}).toPromise().then(function(a){if(typeof (a==null?void 0:a.ctv_cast_payload)==="string")return{payload:a.ctv_cast_payload,type:"loaded"};else return{error:c("err")("Payload was not string"),type:"error"}})["catch"](function(a){a=c("getErrorSafe")(a);return{error:a,type:"error"}})}g.fetchPhotoCastPayload=a;g.fetchAlbumCastPayload=e}),98);
__d("fetchVideoCastPayload",["CometRelay","err","fetchVideoCastPayloadQuery.graphql","getErrorSafe"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h!==void 0?h:h=b("fetchVideoCastPayloadQuery.graphql");function a(a){var b=a.castSessionID,e=a.environment,f=a.playerOrigin,g=a.playerSubOrigin;a=a.videoID;return d("CometRelay").fetchQuery(e,i,{castSessionID:b,playerOrigin:f,playerSubOrigin:g,videoID:a}).toPromise().then(function(a){if(a==null||a.video==null||a.video.video_cast_payload==null)return{type:"video_cannot_be_casted"};else if(typeof a.video.video_cast_payload==="string")return{payload:a.video.video_cast_payload,type:"loaded"};else return{error:c("err")("Payload was not string"),type:"error"}})["catch"](function(a){a=c("getErrorSafe")(a);return{error:a,type:"error"}})}g["default"]=a}),98);
__d("CastingController",["CastingErrorUtils","CastingState","FBLogger","Promise","SubscriptionsHandler","TV2CommsParseUtils","err","fetchCtvCastPayload","fetchVideoCastPayload","getErrorSafe","performanceAbsoluteNow","promiseDone","recoverableViolation","removeFromArray","uuid"],(function(a,b,c,d,e,f,g){"use strict";var h=c("FBLogger")("fbtv"),i="PhotoAlbum",j="ChannelVideo",k="Photo";a=function(){function a(a,b){var e=this;this.$5=[];this.$6=[];this.$7=[];this.$9=function(){var a=d("CastingState").initialCastingState();e.$12(a);e.$13(null)};this.$10=function(a){switch(a.type){case"status_update":e.$16(a);break;case"experience_status_update":e.$17(a);break;default:break}};this.$11=function(a,b){var f;if(d("CastingErrorUtils").isChromecastError(a,"cancel"))h.warn("ChromecastError while casting. Received ChromecastError with cancel code.");else if(((f=e.$2)==null?void 0:f.type)==="video_channel"){f=(f=e.$2)==null?void 0:f.currentVideoID;f=d("CastingErrorUtils").appendCastingMetadataToExpandedError(d("CastingErrorUtils").getCastingErrorSafe(a),babelHelpers["extends"]({},f!=null?{videoID:f}:{}));c("recoverableViolation")("Receiver error at "+b+" while playing video channel","comet_cast_sender",{error:f});c("promiseDone")(e.$4.stopCasting())}else{f=d("CastingErrorUtils").appendCastingMetadataToExpandedError(d("CastingErrorUtils").getCastingErrorSafe(a),{});a=((a=e.$2)==null?void 0:a.type)||"";c("recoverableViolation")("Receiver error at "+b+" while playing in experience "+a,"comet_cast_sender",{error:f});c("promiseDone")(e.$4.stopCasting())}};this.$1=d("CastingState").initialCastingState();this.$2=null;this.$3=b;this.$4=a;this.$8=new(c("SubscriptionsHandler"))();this.$8.addSubscriptions(this.$4.onReceiverDisconnected(this.$9),this.$4.onSessionDisconnected(this.$9),this.$4.onSessionMessage(this.$10),this.$4.onError(this.$11))}var e=a.prototype;e.destroy=function(){this.$8.release()};e.getCastingState=function(){return this.$1};e.getCastingExperienceState=function(){return this.$2};e.setCastingState=function(a){this.$1=a};e.setCastingExperienceState=function(a){this.$2=a};e.subscribeToCastingStateChange=function(a){var b=this;this.$5.push(a);return function(){c("removeFromArray")(b.$5,a)}};e.subscribeToCastingExperienceStateChange=function(a){var b=this;this.$6.push(a);return function(){c("removeFromArray")(b.$6,a)}};e.subscribeToCastingEvent=function(a){var b=this;this.$7.push(a);return function(){c("removeFromArray")(b.$7,a)}};e.startPlayVideoNow=function(a){var e=this,f=a.environment,g=a.origin,h=a.position,i=a.subOrigin,k=a.videoID;if(this.$1.isCastPending)return;this.$12(babelHelpers["extends"]({},this.$1,{isCastPending:!0}));this.$13(null);this.$14({data:{type:"cast_requested",videoID:k},timestamp:c("performanceAbsoluteNow")()});c("promiseDone")(b("Promise").all([c("fetchVideoCastPayload")({castSessionID:this.$3,environment:f,playerOrigin:g,playerSubOrigin:i,videoID:k}),this.$4.getSession().then(function(a){e.$12(babelHelpers["extends"]({},e.$1,{receiverIsConnected:!0}));return a})]).then(function(a){var f=a[0];a[1];if(f.type==="video_cannot_be_casted"){c("recoverableViolation")("The video is not eligible to be casted. The cast request is ignored.","comet_cast_sender",{error:d("CastingErrorUtils").appendCastingMetadataToExpandedError(c("err")("video_cannot_be_casted"),{videoID:k})});return b("Promise").resolve()}else if(f.type==="error"){c("recoverableViolation")("There was a failure retrieving video cast payload. Video failed to play.","comet_cast_sender",{error:d("CastingErrorUtils").appendCastingMetadataToExpandedError(f.error,{videoID:k})});return b("Promise").resolve()}a=e.$4.isCasting(j);a?a=e.$4.playVideoNow({position:h},f.payload):a=e.$4.startCasting(j,{position:h},f.payload);return a.then(function(){var a=babelHelpers["extends"]({},e.$1,e.$15());e.$12(a);a=d("CastingState").initialVideoChannelExperienceState();e.$13(a)})})["catch"](function(a){e.$14({data:{type:"cast_failed",videoID:k},timestamp:c("performanceAbsoluteNow")()}),d("CastingErrorUtils").isChromecastError(a,"cancel")||c("recoverableViolation")("Failed to cast video.","comet_cast_sender",{error:d("CastingErrorUtils").appendCastingMetadataToExpandedError(c("getErrorSafe")(a),{videoID:k})})})["finally"](function(){var a=babelHelpers["extends"]({},e.$1,{isCastPending:!1});e.$12(a)}))};e.startPhotoCasting=function(a){var e=this;a=a.environment;if(this.$1.isCastPending)return;this.$12(babelHelpers["extends"]({},this.$1,{isCastPending:!0}));this.$13(null);this.$14({data:{type:"photo_cast_requested"},timestamp:c("performanceAbsoluteNow")()});c("promiseDone")(b("Promise").all([d("fetchCtvCastPayload").fetchPhotoCastPayload({castSessionID:this.$3,environment:a}),this.$4.getSession().then(function(a){e.$12(babelHelpers["extends"]({},e.$1,{receiverIsConnected:!0}));return a})]).then(function(a){var f=a[0];a[1];if(f.type==="error"){c("recoverableViolation")("There was a failure retrieving photo cast payload.","comet_cast_sender",{error:d("CastingErrorUtils").appendCastingMetadataToExpandedError(f.error,{})});return b("Promise").resolve()}a=e.$4.startCasting(k,{},f.payload);return a.then(function(){var a=babelHelpers["extends"]({},e.$1,e.$15());e.$12(a);e.$13(d("CastingState").initialPhotoExperienceState())})})["catch"](function(a){d("CastingErrorUtils").isChromecastError(a,"cancel")||c("recoverableViolation")("Failed to start photo casting session.","comet_cast_sender",{error:d("CastingErrorUtils").appendCastingMetadataToExpandedError(c("getErrorSafe")(a),{})})})["finally"](function(){var a=babelHelpers["extends"]({},e.$1,{isCastPending:!1});e.$12(a)}))};e.startAlbumSlideshow=function(a){var e=this,f=a.albumID;a=a.environment;if(this.$1.isCastPending)return;this.$12(babelHelpers["extends"]({},this.$1,{isCastPending:!0}));this.$13(null);c("promiseDone")(b("Promise").all([d("fetchCtvCastPayload").fetchAlbumCastPayload({albumID:f,castSessionID:this.$3,environment:a}),this.$4.getSession().then(function(a){e.$12(babelHelpers["extends"]({},e.$1,{receiverIsConnected:!0}));return a})]).then(function(a){var f=a[0];a[1];if(f.type==="album_cannot_be_casted"){c("recoverableViolation")("The album is not eligible to be casted.","comet_cast_sender",{error:d("CastingErrorUtils").appendCastingMetadataToExpandedError(c("err")("album_cannot_be_casted"),{})});return b("Promise").resolve()}else if(f.type==="error"){c("recoverableViolation")("There was a failure retrieving album cast payload.","comet_cast_sender",{error:d("CastingErrorUtils").appendCastingMetadataToExpandedError(f.error,{})});return b("Promise").resolve()}a=e.$4.startCasting(i,{},f.payload);return a.then(function(){var a=babelHelpers["extends"]({},e.$1,e.$15());e.$12(a);a=d("CastingState").initialPhotoAlbumExperienceState();e.$13(a)})})["catch"](function(a){d("CastingErrorUtils").isChromecastError(a,"cancel")||c("recoverableViolation")("Failed to cast album.","comet_cast_sender",{error:d("CastingErrorUtils").appendCastingMetadataToExpandedError(c("getErrorSafe")(a),{})})})["finally"](function(){var a=babelHelpers["extends"]({},e.$1,{isCastPending:!1});e.$12(a)}))};e.disconnect=function(){c("promiseDone")(this.$4.stopCasting())};e.play=function(){c("promiseDone")(this.$4.playVideo())};e.pause=function(){c("promiseDone")(this.$4.pauseVideo())};e.setVolume=function(a){c("promiseDone")(this.$4.setVolume(a))};e.mute=function(){c("promiseDone")(this.$4.mute())};e.unmute=function(){c("promiseDone")(this.$4.unmute())};e.seek=function(a){c("promiseDone")(this.$4.seekVideo(a))};e.showSingleMedia=function(a){var b=null;switch(a.type){case"photo":b={photo_id:a.photoID};break;case"video":b={video_id:a.videoID};break;default:a.type;return}c("promiseDone")(this.$4.showPhoto({media_parameters:b,request_id:c("uuid")()}))};e.playAlbumSlideshow=function(){c("promiseDone")(this.$4.playAlbumSlideshow())};e.pauseAlbumSlideshow=function(){c("promiseDone")(this.$4.pauseAlbumSlideshow())};e.nextPhotoAlbumSlideshow=function(){c("promiseDone")(this.$4.nextPhotoAlbumSlideshow())};e.previousPhotoAlbumSlideshow=function(){c("promiseDone")(this.$4.previousPhotoAlbumSlideshow())};e.$12=function(a){a!==this.$1&&(this.$1=a,this.$5.slice().forEach(function(b){b(a)}))};e.$13=function(a){a!==this.$2&&(this.$2=a,this.$6.slice().forEach(function(b){b(a)}))};e.$14=function(a){this.$7.slice().forEach(function(b){b(a)})};e.$16=function(a){var b=this.$1,d=this.$2;if(d!=null&&d.type==="video_channel"){var e=a.data.video_id,f=this.$4.getVolume()||0,g=this.$4.isMuted()||!1;e!=null&&this.$14({data:{playbackState:a.data.state,playerInfo:(a==null?void 0:a.player_info)||null,receiverInfo:(a==null?void 0:a.receiver_info)||null,type:"video_status_update",videoID:e},timestamp:c("performanceAbsoluteNow")()});g={receiverIsConnected:!0,receiverIsMuted:g,receiverVolume:f};if(e==null)this.$12(babelHelpers["extends"]({},b,g)),this.$13(babelHelpers["extends"]({},d,{currentDuration:null,currentPlaybackState:null,currentPosition:null,currentVideoID:null}));else{f=babelHelpers["extends"]({},b,g);this.$12(f);this.$13(babelHelpers["extends"]({},d,{currentDuration:a.data.duration!=null?a.data.duration:d.currentDuration,currentPlaybackState:a.data.state,currentPosition:a.data.position,currentVideoID:e}))}}};e.$17=function(a){var b=this.$2;if(b!=null&&b.type==="photo_album"&&a.data.name==="PhotoAlbum"){var c;a=d("TV2CommsParseUtils").parseCastingReceiverPhotoAlbumReportedState(a.data.payload);a=a.media_state;c=((c=(c=a.photo_state)==null?void 0:c.photo_id)!=null?c:(c=a.video_state)==null?void 0:c.video_id)||null;a=this.$18(a);this.$13(babelHelpers["extends"]({},b,{currentAssetID:c,currentPlaybackState:a}))}};e.$15=function(){return{receiverFriendlyName:this.$4.getFriendlyName()||null,receiverIsMuted:this.$4.isMuted()||null,receiverVolume:this.$4.getVolume()||0}};e.$18=function(a){if(a.photo_state!=null)return a.photo_state.photo_playback_state==="play"?"play":"paused";else if(a.video_state!=null)return["play","seeking"].includes(a.video_state.video_playback_state)?"play":"paused";else return null};return a}();g["default"]=a}),98);
__d("CastingEventReporter",["ConnectedTvLoggingFalcoEvent"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=this;this.$4=function(a){switch(a.data.type){case"cast_requested":b.logWithAvailableContext({event:"cast_requested",video_id_override:a.data.videoID});b.$5(a);break;case"photo_cast_requested":b.logWithAvailableContext({event:"photo_cast_requested"});b.$5(a);break;case"cast_failed":b.$5(a);break;case"video_status_update":b.$6(a.data.receiverInfo,a.data.playerInfo);b.$5(a);break;default:break}};this.$1=null;this.$2=null;this.$3={cast_session_id:a,is_google_cast_bg:null,third_party_app_id:null,tv_os_version:null,tv_player_instance_key:null,tv_player_version:null,tv_session_id:null,tv_web_client_revision:null}}var b=a.prototype;b.destroy=function(){this.$1!=null&&this.$1(),this.$1=null};b.bindToCastingController=function(a){this.$1=a.subscribeToCastingEvent(this.$4)};b.logWithAvailableContext=function(a){var b=this;c("ConnectedTvLoggingFalcoEvent").log(function(){return babelHelpers["extends"]({},b.$3,a)})};b.$5=function(a){var b=a.data;switch(b.type){case"cast_requested":this.$2={data:b,timestamp:a.timestamp};break;case"cast_failed":var c=this.$2;this.logWithAvailableContext({event:"cast_failed",perf_time_ms:Math.floor(c!=null?a.timestamp-c.timestamp:0),video_id_override:b.videoID});this.$2=null;break;case"video_status_update":c=this.$2;if(c==null)break;var d=c.data.videoID;b.videoID===d&&b.playbackState==="play"?(this.logWithAvailableContext({event:"cast_started",perf_time_ms:Math.floor(a.timestamp-c.timestamp)}),this.$2=null):b.videoID!==d&&(this.$2=null);break}};b.$6=function(a,b){var c=(a==null?void 0:a.third_party_app_id)||null,d=(a==null?void 0:a.cast_receiver_logger_session_id)||null,e=(a==null?void 0:a.is_google_cast_bg)||null,f=(a==null?void 0:a.os_version)||null;a=(a==null?void 0:a.web_client_revision)||null;var g=(b==null?void 0:b.player_instance_key)||null;b=(b==null?void 0:b.player_version)||null;this.$3=babelHelpers["extends"]({},this.$3,{is_google_cast_bg:e,third_party_app_id:c,tv_os_version:f,tv_player_instance_key:g,tv_player_version:b,tv_session_id:d,tv_web_client_revision:a})};return a}();g["default"]=a}),98);
__d("TV2MessageTypes",[],(function(a,b,c,d,e,f){"use strict";a="urn:x-cast:com.facebook.fb";b="urn:x-cast:com.google.cast.media";f.FBAPP_CAST_PROTOCOL_NAMESPACE=a;f.GOOGLE_CAST_MEDIA_PROTOCOL_NAMESPACE=b}),66);
__d("TV2PhotoShowRequest",[],(function(a,b,c,d,e,f){"use strict";function a(a){return k(JSON.parse(a),m("TV2PhotoShowRequest"))}function b(a){return JSON.stringify(l(a,m("TV2PhotoShowRequest")),null,2)}function g(a,b,c){c===void 0&&(c="");if(c)throw Error('Invalid value for key "'+c+'". Expected type '+JSON.stringify(a)+" but got "+JSON.stringify(b));throw Error("Invalid value "+JSON.stringify(b)+" for type "+JSON.stringify(a))}function h(a){if(a.jsonToJS===void 0){var b={};a.props.forEach(function(a){return b[a.json]={key:a.js,typ:a.typ}});a.jsonToJS=b}return a.jsonToJS}function i(a){if(a.jsToJSON===void 0){var b={};a.props.forEach(function(a){return b[a.js]={key:a.json,typ:a.typ}});a.jsToJSON=b}return a.jsToJSON}function j(a,b,c,d){d===void 0&&(d="");function e(b,a){return typeof b===typeof a?a:g(b,a,d)}function f(b,a){var d=b.length;for(var e=0;e<d;e++){var f=b[e];try{return j(a,f,c)}catch(a){}}return g(b,a)}function h(b,a){return b.indexOf(a)!==-1?a:g(b,a)}function i(b,a){return!Array.isArray(a)?g("array",a):a.map(function(a){return j(a,b,c)})}function k(a){if(a===null)return null;var b=new Date(a);return isNaN(b.valueOf())?g("Date",a):b}function l(b,d,a){if(a===null||typeof a!=="object"||Array.isArray(a))return g("object",a);var e={};Object.getOwnPropertyNames(b).forEach(function(d){var f=b[d];d=Object.prototype.hasOwnProperty.call(a,d)?a[d]:void 0;e[f.key]=j(d,f.typ,c,f.key)});Object.getOwnPropertyNames(a).forEach(function(f){Object.prototype.hasOwnProperty.call(b,f)||(e[f]=j(a[f],d,c,f))});return e}if(b==="any")return a;if(b===null)return a===null?a:g(b,a);if(b===!1)return g(b,a);while(typeof b==="object"&&b.ref!==void 0)b=n[b.ref];if(Array.isArray(b))return h(b,a);if(typeof b==="object")return Object.prototype.hasOwnProperty.call(b,"unionMembers")?f(b.unionMembers,a):Object.prototype.hasOwnProperty.call(b,"arrayItems")?i(b.arrayItems,a):Object.prototype.hasOwnProperty.call(b,"props")?l(c(b),b.additional,a):g(b,a);return b===Date&&typeof a!=="number"?k(a):e(b,a)}function k(a,b){return j(a,b,h)}function l(a,b){return j(a,b,i)}function c(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];return{unionMembers:b}}function d(a,b){return{props:a,additional:b}}function m(a){return{ref:a}}var n={TV2PhotoShowRequest:d([{json:"media_parameters",js:"media_parameters",typ:m("MediaParameters")},{json:"request_id",js:"request_id",typ:""}],"any"),MediaParameters:d([{json:"photo_id",js:"photo_id",typ:c(void 0,"")},{json:"video_id",js:"video_id",typ:c(void 0,"")}],"any")};e.exports={TV2PhotoShowRequestToJson:b,toTV2PhotoShowRequest:a}}),null);
__d("CastingReceiverManager",["CastingChromecastScanner","Promise","Random","SubscriptionsHandler","TV2CommsParseUtils","TV2MessageTypes","TV2PhotoShowRequest","promiseDone","removeFromArray","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h="1.2.0";a=function(){function a(a){var b=this;this.$5=null;this.$6=null;this.$10=null;this.$11=[];this.$12=[];this.$13=[];this.$14=[];this.$15=[];this.$16=[];this.$17=[];this.$18=[];this.$19=[];this.$4=new(c("CastingChromecastScanner"))(a,d("TV2MessageTypes").FBAPP_CAST_PROTOCOL_NAMESPACE);this.$2=null;this.$1=!1;this.$3=0;this.$6=null;this.$9=new Map();this.$20=new(c("SubscriptionsHandler"))();this.$20.addSubscriptions(this.$4.onStatusChanged(function(a){var c=a.foundReceiver;b.$15.slice().forEach(function(a){a(!!c)})}),this.$4.onSessionDisconnected(function(){b.$21(),b.$14.slice().forEach(function(a){a()})}),this.$4.onSessionStarted(function(a){b.$22(a)}),this.$4.onError(function(a,c){b.$11.slice().forEach(function(b){b(a,c)})}));this.$7=this.$4.init();c("promiseDone")(this.$7.then(function(){b.$2=!0,b.$1=!0,b.$13.slice().forEach(function(a){a()})},function(a){b.$2=!1,b.$12.slice().forEach(function(b){b(a)})}))}var e=a.prototype;e.ready=function(){return this.$7};e.hasSupport=function(){return this.$2};e.hasFoundReceiver=function(){return this.$4.hasFoundReceiver()};e.isCasting=function(a){var b=!!this.$5&&this.$5.isCasting();b&&a!=null&&(b=this.$6!=null&&this.$6.indexOf(a)>=0);return b};e.getSession=function(){var a=this;return this.ready().then(function(){var b=a.$5;b!=null&&!b.isConnected()&&a.$21()}).then(function(){if(a.$5)return a.$5;a.$8||(a.$8=a.$23());return a.$8})["catch"](function(b){a.$11.slice().forEach(function(a){a(b,"CastingReceiverManager.getSession")});throw b})["finally"](function(){a.$8=null})};e.startCasting=function(a,b,c){var d=this;return this.$24(a,b,c).then(function(a){a.success?d.$6=a.target:d.$6=null})};e.stopCasting=function(){var a=this;return!this.isCasting()?b("Promise").resolve():this.ready().then(function(){var b=a.$5;b!=null&&b.isDisconnected()&&a.$21();return a.$5}).then(function(a){return a==null?b("Promise").resolve(null):a.disconnect()}).then(function(){a.$21()})};e.playVideoNow=function(a,c){return!this.isCasting()?b("Promise").resolve():this.$25("next_video",babelHelpers["extends"]({},a,{auto_advance:!0}),c).then(function(){})};e.skipToNextVideo=function(){return!this.isCasting()?b("Promise").resolve():this.$25("skip_video").then(function(){})};e.playVideo=function(a){return!this.isCasting()?b("Promise").resolve():this.$25("play_video",{position:a||0}).then(function(){})};e.pauseVideo=function(){return!this.isCasting()?b("Promise").resolve():this.$25("pause_video").then(function(){})};e.seekVideo=function(a){return!this.isCasting()?b("Promise").resolve():this.$25("seek_video",{position:a}).then(function(){})};e.showPhoto=function(a){return!this.isCasting()?b("Promise").resolve():this.$25("show_photo",void 0,d("TV2PhotoShowRequest").TV2PhotoShowRequestToJson(a),"Photo").then(function(){})};e.stopVideo=function(){return!this.isCasting()?b("Promise").resolve():this.$25("stop_video").then(function(){})};e.playAlbumSlideshow=function(){return!this.isCasting()?b("Promise").resolve():this.$25("play_photo",void 0,void 0,"PhotoAlbum").then(function(){})};e.pauseAlbumSlideshow=function(){return!this.isCasting()?b("Promise").resolve():this.$25("pause_photo",void 0,void 0,"PhotoAlbum").then(function(){})};e.nextPhotoAlbumSlideshow=function(){return!this.isCasting()?b("Promise").resolve():this.$25("next_photo",void 0,void 0,"PhotoAlbum").then(function(){})};e.previousPhotoAlbumSlideshow=function(){return!this.isCasting()?b("Promise").resolve():this.$25("previous_photo",void 0,void 0,"PhotoAlbum").then(function(){})};e.getFriendlyName=function(){return this.$5==null?null:this.$5.getFriendlyName()};e.getVolume=function(){return this.$5==null?null:this.$5.getVolume()};e.setVolume=function(a){if(!this.isCasting())return b("Promise").resolve();return this.$5==null?b("Promise").resolve():this.$5.setVolume(a)};e.isMuted=function(){if(!this.isCasting())return null;return this.$5==null?null:this.$5.isMuted()};e.mute=function(){if(!this.isCasting())return b("Promise").resolve();return this.$5==null?b("Promise").resolve():this.$5.mute()};e.unmute=function(){if(!this.isCasting())return b("Promise").resolve();return this.$5==null?b("Promise").resolve():this.$5.unmute()};e.$26=function(){var a=this,b=this.$27();return this.$28(function(a){return{data:{client_cast_session:b,version:h},num:a,target:"version",timestamp:Date.now(),type:"version_request"}}).then(function(b){var c=b.messageNum;return a.$29(function(a){return a.response_num===c})}).then(function(a){if(a.type!=="version_response")throw c("unrecoverableViolation")('Response message was not a "version_response"',"comet_cast_sender");if(a.data==null)throw c("unrecoverableViolation")("Version response is missing data","comet_cast_sender");return a.data})};e.$24=function(a,b,d){var e=this,f=this.$27();return this.$28(function(c){return{data:{client_cast_session:f,name:a,params:b,payload:d,version:h},num:c,target:"version_launch",timestamp:Date.now(),type:"version_launch"}}).then(function(a){var b=a.messageNum;return e.$29(function(a){return a.response_num===b})}).then(function(a){if(a.type!=="version_launch_response")throw c("unrecoverableViolation")('Response message was not a "version_launch_response"',"comet_cast_sender");if(a.data==null)throw c("unrecoverableViolation")("Version launch response is missing data","comet_cast_sender");return a.data})};e.$30=function(){var a=this;return this.$6!=null?b("Promise").resolve(this.$6):this.getSession().then(function(b){return a.$26()}).then(function(b){var d=null;typeof b.currently_running_experience==="object"&&(d=b.currently_running_experience);if(d==null)throw c("unrecoverableViolation")("Session has no target","comet_cast_sender");a.$6=d;return a.$6})};e.$27=function(){var a=null;localStorage&&(a=localStorage.getItem("CastingSessionKey"));a==null&&(a=c("Random").uint32().toString(16),localStorage&&localStorage.setItem("CastingSessionKey",a));return a};e.$28=function(a){var b=this.$3+=2;return this.getSession().then(function(d){if(d==null)throw c("unrecoverableViolation")("The message can not be sent without a session","comet_cast_sender");var e=a(b);return d.sendMessage(e)}).then(function(){return{messageNum:b}})};e.$29=function(a){return this.getSession().then(function(e){if(e==null)throw c("unrecoverableViolation")("The message cannot be received without a session","comet_cast_sender");return new(b("Promise"))(function(b,c){var f=e.onMessage(function(e){try{e=d("TV2CommsParseUtils").parseTV2CommsFBAppOutboundMessageFromJSON(e);if(e.type==="version_response"||e.type==="version_launch_response"||e.type==="experience_state"||e.type==="command_result"){var g=!a||a(e);g&&(f.remove(),b(e))}}catch(a){f.remove(),c(a)}})})})};e.$25=function(a,b,d,e){var f=this;return this.$30().then(function(c){return f.$28(function(f){return{data:{cmd:a,name:e,params:b,payload:d},num:f,target:c,timestamp:Date.now(),type:"experience_command"}})}).then(function(a){var b=a.messageNum;return f.$29(function(a){return a.response_num===b})}).then(function(a){if(a.type!=="command_result")throw c("unrecoverableViolation")('Response message was not a "command_result"',"comet_cast_sender");return a.data})};e.$23=function(){var a=this;return this.$4.getSession().then(function(b){a.$5==null&&(a.$5=b);return a.$5})};e.$22=function(a){var b=this;this.$5=a;var e="extension";this.$8&&(e="site");c("promiseDone")(this.$26().then(function(c){var f=c.success;if(!f)return;var g=null;typeof c.currently_running_experience==="object"&&(g=c.currently_running_experience);g!=null&&(b.$6=g);b.$18.slice().forEach(function(c){c(a,{session:a,source:e,success:f,target:b.$6})});b.$10=a.onMessage(function(a){try{var c=d("TV2CommsParseUtils").parseTV2CommsFBAppOutboundMessageFromJSON(a);b.$17.slice().forEach(function(a){a(c)})}catch(a){b.$11.slice().forEach(function(b){b(a,"CastingReceiverManager._onSessionStartedHandler")})}})}))};e.$21=function(){this.$10!=null&&(this.$10.remove(),this.$10=null);var a=this.$5;a!=null&&a.destroy();this.$5=null;this.$6=null};e.onError=function(a){var b=this.$11;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onExperienceNotSupported=function(a){var b=this.$12;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onExperienceReady=function(a){var b=this.$13;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onReceiverDisconnected=function(a){var b=this.$14;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onReceiverStatusChanged=function(a){var b=this.$15;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onSessionDisconnected=function(a){var b=this.$16;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onSessionMessage=function(a){var b=this.$17;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onSessionStarted=function(a){var b=this.$18;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};e.onStopView=function(a){var b=this.$19;b.push(a);return{remove:function(){c("removeFromArray")(b,a)}}};return a}();g["default"]=a}),98);
__d("CastingControllerHooks",["CastingContext","CastingController","CastingEventReporter","CastingReceiverManager","CurrentUser","ExecutionEnvironment","Promise","guid","qex","react","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";f=d("react");var h=f.useContext,i=f.useEffect,j=f.useState,k=null,l=c("qex")._("1648");function m(){if(k!=null)return k;if(l==null)throw c("unrecoverableViolation")("Use useIsCastAvailable first to check if casting feature is available in this browser.","comet_cast_sender");var a=new(c("CastingReceiverManager"))(l),b=c("guid")(),d=new(c("CastingController"))(a,b);b=new(c("CastingEventReporter"))(b);b.bindToCastingController(d);k={castingController:d,castingEventReporter:b,castingReceiverManager:a};return k}function n(){var a=o();a=a.castingReceiverManager;return a}function o(){if(c("ExecutionEnvironment").canUseDOM&&c("CurrentUser").isLoggedIn())return m();throw new(b("Promise"))(function(){})}function p(){var a=o();a=a.castingController;return a}function a(){var a=n(),b=h(d("CastingContext").SetCastingControllerContext),c=j(!1),e=c[0],f=c[1];c=j(!1);var g=c[0],k=c[1];i(function(){var b=a.onExperienceReady(function(){f(a.hasSupport()||!1)});f(a.hasSupport()||!1);return function(){return b.remove()}},[a]);i(function(){var b=a.onReceiverStatusChanged(function(){k(a.hasFoundReceiver()||!1)});k(a.hasFoundReceiver()||!1);return function(){return b.remove()}},[a]);if(l==null)return!1;if(b==null)return!1;if(!e)return!1;return!g?!1:!0}function e(){var a=p(),b=h(d("CastingContext").SetCastingControllerContext);if(b==null)throw c("unrecoverableViolation")("Casting has to be initialized inside CastingProvider.","comet_cast_sender");i(function(){b(a)},[b,a])}g.useCastingController=p;g.useIsCastAvailable=a;g.useCastingInitializeIfNecessary=e}),98);
__d("VideoPlayerSettingsMenuQualityPaneToggle.react",["fbt","ix","CometImage.react","CometPressable.react","VideoPlayerSettingsMenu.react","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react"),k={chevronRight:{display:"x3nfvp2",marginBottom:"xmgb6t1",marginStart:"x12mruv9",$$css:!0},label:{cursor:"x1ypdohk",fontWeight:"x1s688f",$$css:!0},option:{alignItems:"x6s0dn4",color:"x14ctfv",cursor:"x1ypdohk",display:"x78zum5",flexGrow:"x1bhwmg6",justifyContent:"x13a6bvl",marginStart:"x1i64zmx",minWidth:"x450l9j",$$css:!0},pressableOption:{width:"xh8yej3",$$css:!0}};function a(a){var b=a.selectedVideoQuality,e=a.setPane;a=a.targetVideoQuality;return j.jsxs(c("CometPressable.react"),{onPress:function(){e(d("VideoPlayerSettingsMenu.react").VideoPlayerSettingsMenuPaneType.QUALITY)},testid:void 0,xstyle:k.pressableOption,children:[j.jsx("div",{className:"x1ypdohk x1s688f",children:h._("__JHASH__0EdCFWvij7o__JHASH__")}),j.jsxs("div",{className:"x6s0dn4 x14ctfv x1ypdohk x78zum5 x1bhwmg6 x13a6bvl x1i64zmx x450l9j",children:[b==="notselected"?j.jsx("span",{"data-testid":void 0,children:"\xa0"}):b==="auto"?j.jsxs(j.Fragment,{children:[j.jsx("span",{"data-testid":void 0,children:h._("__JHASH__hdERtczUAO6__JHASH__")}),a!=null?j.jsxs(j.Fragment,{children:[j.jsx("span",{children:"\xa0"}),j.jsx("span",{"data-testid":void 0,children:a})]}):null]}):j.jsx("span",{"data-testid":void 0,children:b}),j.jsx("span",{className:"x3nfvp2 xmgb6t1 x12mruv9",children:j.jsx(c("CometImage.react"),{src:i("480587")})})]})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("LiveVideoLatencyMenu.react",["fbt","CometRelay","LiveVideoLatencyMenuContextProvider_video.graphql","VideoPlayerHooks","gkx","react","recoverableViolation","useSelectedLatencySetting"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=d("react"),k=d("react").useMemo,l=h._("__JHASH__bTzlM2_yLZR__JHASH__"),m=c("gkx")("3681")?[o("ultra-low"),o("low"),o("normal")]:[o("low"),o("normal")],n=j.createContext({liveVideoLatencyMenuPaneMatchPointer:null,liveVideoLatencyMenuPaneToggleMatchPointer:null});function o(a){switch(a){case"low":return{description:h._("__JHASH__Wdbuy3igQMj__JHASH__"),title:h._("__JHASH__dCQb4PMifya__JHASH__"),value:a};case"normal":return{description:h._("__JHASH__dcU5TOtw40F__JHASH__"),title:h._("__JHASH__PL-fSmiQjO2__JHASH__"),value:a};case"ultra-low":return{description:h._("__JHASH__99h8y4YbicW__JHASH__"),title:h._("__JHASH__U6zABNuSUIw__JHASH__"),value:a};default:a;c("recoverableViolation")("Setting "+a+" is not valid","gaming_video");return{description:h._("__JHASH__TWLERIjePxH__JHASH__"),title:h._("__JHASH__TWLERIjePxH__JHASH__"),value:a}}}function a(a,b){var e=d("VideoPlayerHooks").useController(),f=d("VideoPlayerHooks").useLatencyLevel();a=c("useSelectedLatencySetting")(a,b);a[0];var g=a[1];b=o(f);a=b.title;b=function(a){f!==a&&(g(a),e.setLatencyLevel(a))};return{selectedLatencySetting:f,selectedLatencySettingTitle:a,setSelectedLatencySetting:b}}var p=i!==void 0?i:i=b("LiveVideoLatencyMenuContextProvider_video.graphql");function e(a){var b=a.children;a=a.video;var c=d("CometRelay").useFragment(p,a);a=k(function(){return c==null?{liveVideoLatencyMenuPaneMatchPointer:null,liveVideoLatencyMenuPaneToggleMatchPointer:null}:{liveVideoLatencyMenuPaneMatchPointer:c.if_viewer_can_use_latency_menu,liveVideoLatencyMenuPaneToggleMatchPointer:c.if_viewer_can_use_latency_menu_toggle}},[c]);return j.jsx(n.Provider,{value:a,children:b})}e.displayName=e.name+" [from "+f.id+"]";g.LATENCY_MENU_TITLE=l;g.LATENCY_SETTING_OPTIONS=m;g.LiveVideoLatencyMenuContext=n;g.getLiveVideoLatencySettingToInfoMapping=o;g.useLatencySettingState=a;g.LiveVideoLatencyMenuContextProvider=e}),98);
__d("VideoPlayerSettingsMenu.react",["fbt","$InternalEnum","CometErrorBoundary.react","CometKeys","CometPlaceholder.react","CometRelay","LiveVideoLatencyMenu.react","PlaybackSpeedExperiments","VideoPlayerHooks","VideoPlayerSettingsMenuMainPane.react","VideoPlayerSettingsMenuPlaybackSpeedPane.react","VideoPlayerSettingsMenuQualityPane.react","cr:564","react","recoverableViolation","useLayerKeyCommands"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");e=d("react");var j=e.useCallback,k=e.useContext,l=e.useEffect,m=e.useMemo,n=e.useRef,o=e.useState,p=b("$InternalEnum")({LATENCY:"latency",MAIN:"main",PLAYBACK_SPEED:"playbackSpeed",QUALITY:"quality",SEARCH_CAPTIONS:"searchCaptions"});function a(a){var e=a.children;e=e===void 0?null:e;var f=a.onClose;a=d("VideoPlayerHooks").useCaptionsLoaded();var g=d("VideoPlayerHooks").useCaptionsVisible(),q=d("VideoPlayerHooks").useSelectedVideoQuality(),r=d("VideoPlayerHooks").useInbandCaptionsAutogenerated(),s=d("VideoPlayerHooks").useTargetVideoQuality(),t=o(p.MAIN),u=t[0],v=t[1];t=o(g);g=t[0];t=t[1];var w=d("VideoPlayerHooks").usePlaybackRate(),x=d("VideoPlayerHooks").useIsLive(),y=d("VideoPlayerHooks").useIsLiveRewindActive(),z=k(d("LiveVideoLatencyMenu.react").LiveVideoLatencyMenuContext);z=z.liveVideoLatencyMenuPaneMatchPointer;var A=d("VideoPlayerHooks").useShouldShowPlaybackRateControl();A=!!d("PlaybackSpeedExperiments").enableCometPlaybackSpeedControlPublicTest()&&A;l(function(){x&&!y&&u===p.PLAYBACK_SPEED&&v(p.MAIN)},[y,v,x,u]);var B=n(null),C=n(null),D=j(function(a){B.current&&C.current&&a.target instanceof HTMLElement&&document.contains(a.target)&&!B.current.contains(a.target)&&C.current.contains(a.target)&&f()},[f]);l(function(){document.addEventListener("click",D);return function(){document.removeEventListener("click",D)}},[D]);var E=m(function(){return[{command:{key:c("CometKeys").ESCAPE},description:h._("__JHASH__hGEFqYmPW2a__JHASH__"),handler:function(){f()}}]},[f]);c("useLayerKeyCommands")(E);E=i.jsx(c("VideoPlayerSettingsMenuMainPane.react"),{captionsLoaded:a,captionsVisibleOptimistic:g,inbandCaptionsAutogenerated:r,playbackRate:w,selectedVideoQuality:q,setIsCaptionsVisible:t,setPane:v,shouldEnablePlaybackRateSupport:A,targetVideoQuality:s,children:e});switch(u){case p.LATENCY:if(z==null){c("recoverableViolation")("Latency components should not be null","gaming_video");break}E=i.jsx(c("CometErrorBoundary.react"),{children:i.jsx(c("CometPlaceholder.react"),{fallback:null,children:i.jsx(d("CometRelay").MatchContainer,{match:z,props:{setPane:v}})})});break;case p.MAIN:break;case p.PLAYBACK_SPEED:E=i.jsx(c("VideoPlayerSettingsMenuPlaybackSpeedPane.react"),{playbackRate:w,setPane:v});break;case p.QUALITY:E=i.jsx(c("VideoPlayerSettingsMenuQualityPane.react"),{selectedVideoQuality:q,setPane:v});break;case p.SEARCH_CAPTIONS:b("cr:564")!=null&&(E=i.jsx(b("cr:564"),{setPane:v,children:e}));break}return i.jsxs(i.Fragment,{children:[i.jsx("div",{ref:B,children:E}),i.jsx("div",{className:"xjbqb8w x5yr21d xg6iff7 x1g81zrj xixxii4 x17qophe x13vifvy xh8yej3 x8knxv4","data-testid":void 0,ref:C})]})}a.displayName=a.name+" [from "+f.id+"]";g.VideoPlayerSettingsMenuPaneType=p;g.VideoPlayerSettingsMenu=a}),98);
__d("VideoPlayerSettingsMenuMainPane.react",["CometErrorBoundary.react","CometPlaceholder.react","CometRelay","FocusRegion.react","LiveVideoLatencyMenu.react","VideoPlayerSettingsMenuPlaybackPaneToggle.react","VideoPlayerSettingsMenuQualityPaneToggle.react","cr:565","focusScopeQueries","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=d("react").useContext;function a(a){var e=a.children,f=a.playbackRate,g=a.selectedVideoQuality,j=a.setPane,k=a.shouldEnablePlaybackRateSupport;a=a.targetVideoQuality;var l=i(d("LiveVideoLatencyMenu.react").LiveVideoLatencyMenuContext);l=l.liveVideoLatencyMenuPaneToggleMatchPointer;return h.jsx(d("FocusRegion.react").FocusRegion,{autoFocusQuery:d("focusScopeQueries").headerFirstTabbableSecondScopeQuery,recoverFocusQuery:d("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:h.jsxs("div",{"data-testid":void 0,children:[h.jsx("div",{className:"x14ctfv x78zum5 x1hoihq8 x1lku1pv",children:b("cr:565")&&h.jsx(b("cr:565"),{setPane:j})}),h.jsx("div",{className:"x14ctfv x78zum5 x1hoihq8 x1lku1pv",children:h.jsx(c("VideoPlayerSettingsMenuQualityPaneToggle.react"),{selectedVideoQuality:g,setPane:j,targetVideoQuality:a})}),h.jsx("div",{className:"x14ctfv x78zum5 x1hoihq8 x1lku1pv",children:h.jsx(c("VideoPlayerSettingsMenuPlaybackPaneToggle.react"),{playbackRate:f,setPane:j,shouldEnablePlaybackRateSupport:k})}),l!=null&&h.jsx("div",{className:"x14ctfv x78zum5 x1hoihq8 x1lku1pv",children:h.jsx(c("CometErrorBoundary.react"),{children:h.jsx(c("CometPlaceholder.react"),{fallback:null,children:h.jsx(d("CometRelay").MatchContainer,{match:l,props:{setPane:j}})})})}),e]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerSettingsMenuPlaybackPaneToggle.react",["fbt","ix","CometImage.react","CometPressable.react","VideoPlayerSettingsMenu.react","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react"),k={chevronRight:{display:"x3nfvp2",marginBottom:"xmgb6t1",marginStart:"x12mruv9",$$css:!0},label:{cursor:"x1ypdohk",fontWeight:"x1s688f",$$css:!0},option:{alignItems:"x6s0dn4",color:"x14ctfv",cursor:"x1ypdohk",display:"x78zum5",flexGrow:"x1bhwmg6",justifyContent:"x13a6bvl",marginStart:"x1i64zmx",minWidth:"x450l9j",$$css:!0},pressableOption:{width:"xh8yej3",$$css:!0}};function a(a){var b=a.playbackRate,e=a.setPane;a=a.shouldEnablePlaybackRateSupport;return!a?null:j.jsxs(c("CometPressable.react"),{onPress:function(){e(d("VideoPlayerSettingsMenu.react").VideoPlayerSettingsMenuPaneType.PLAYBACK_SPEED)},testid:void 0,xstyle:k.pressableOption,children:[j.jsx("div",{className:"x1ypdohk x1s688f",children:h._("__JHASH__8IenQAQlVCL__JHASH__")}),j.jsxs("div",{className:"x6s0dn4 x14ctfv x1ypdohk x78zum5 x1bhwmg6 x13a6bvl x1i64zmx x450l9j",children:[j.jsx("span",{"data-testid":void 0,children:b}),j.jsx("span",{className:"x3nfvp2 xmgb6t1 x12mruv9",children:j.jsx(c("CometImage.react"),{src:i("480587")})})]})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerSettingsMenuPlaybackSpeedPane.react",["fbt","ix","CometImage.react","CometPressable.react","FocusRegion.react","VideoPlayerHooks","VideoPlayerSettingsMenu.react","focusScopeQueries","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react"),k={chevronLeft:{display:"x3nfvp2",marginBottom:"xmgb6t1",marginStart:"x139jcc6",$$css:!0},menuHeading:{alignItems:"x6s0dn4",color:"x14ctfv",cursor:"x1ypdohk",display:"x78zum5",fontWeight:"x1s688f",":hover_textDecoration":"x1lku1pv",$$css:!0},menuLabel:{cursor:"x1ypdohk",display:"x1rg5ohu",$$css:!0},menuOption:{marginStart:"x17adc0v",marginTop:"x1anpbxc",$$css:!0},menuOptionRow:{color:"x14ctfv",display:"x1lliihq",minWidth:"xfvyar9",outline:"x1a2a7pz",paddingTop:"xyqdw3p",paddingEnd:"x4uap5",paddingBottom:"xg8j3zb",paddingStart:"xkhd6sd",textAlign:"x1yc453h",$$css:!0},pressableOption:{width:"xh8yej3",$$css:!0},radio:{backgroundColor:"x17j41np",borderTopStartRadius:"x1ykpwxx",borderTopEndRadius:"x118zf8b",borderBottomEndRadius:"xnwxkdh",borderBottomStartRadius:"xfocsrx",display:"x1rg5ohu",marginBottom:"xmgb6t1",marginEnd:"xmo9yow",paddingTop:"x1yrsyyn",paddingEnd:"xsyo7zv",paddingBottom:"x10b6aqq",paddingStart:"x16hj40l",$$css:!0},radioDot:{backgroundColor:"x14hiurz",borderTopStartRadius:"x8u2fvd",borderTopEndRadius:"x1ht7hnu",borderBottomEndRadius:"x1quq95r",borderBottomStartRadius:"x5yzy4c",display:"x1rg5ohu",height:"xqu0tyb",marginStart:"x8182xy",marginTop:"x1kgmq87",position:"x10l6tqk",width:"x51ohtg",$$css:!0},selectedOption:{fontWeight:"x1s688f",$$css:!0}};function a(a){var b=a.playbackRate,e=a.setPane,f=d("VideoPlayerHooks").useController();return j.jsx(d("FocusRegion.react").FocusRegion,{autoFocusQuery:d("focusScopeQueries").headerFirstTabbableSecondScopeQuery,recoverFocusQuery:d("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:j.jsxs("div",{"data-testid":void 0,children:[j.jsx("div",{className:"x6s0dn4 x14ctfv x1ypdohk x78zum5 x1s688f x1lku1pv",children:j.jsxs(c("CometPressable.react"),{onPress:function(){return e(d("VideoPlayerSettingsMenu.react").VideoPlayerSettingsMenuPaneType.MAIN)},testid:void 0,xstyle:k.pressableOption,children:[" ",j.jsx("span",{className:"x3nfvp2 xmgb6t1 x139jcc6",children:j.jsx(c("CometImage.react"),{src:i("480579")})}),h._("__JHASH__8IenQAQlVCL__JHASH__")]})}),j.jsx("div",{className:"x17adc0v x1anpbxc","data-testid":void 0,children:[.5,.75,1,1.25,1.5,1.75,2].map(function(a){var d=b===a;return j.jsx("div",{children:j.jsxs(c("CometPressable.react"),{onPress:function(){f.setPlaybackRate(a)},testid:void 0,xstyle:k.menuOptionRow,children:[j.jsx("div",{className:"x17j41np x1ykpwxx x118zf8b xnwxkdh xfocsrx x1rg5ohu xmgb6t1 xmo9yow x1yrsyyn xsyo7zv x10b6aqq x16hj40l",children:d&&j.jsx("div",{className:"x14hiurz x8u2fvd x1ht7hnu x1quq95r x5yzy4c x1rg5ohu xqu0tyb x8182xy x1kgmq87 x10l6tqk x51ohtg","data-testid":void 0})}),j.jsx("div",{className:"x1ypdohk x1rg5ohu"+(d?" x1s688f":""),"data-testid":void 0,children:a})]})},a)})})]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerSettingsMenuQualityPane.react",["fbt","ix","CometImage.react","CometPressable.react","FocusRegion.react","VideoPlayerHooks","VideoPlayerSettingsMenu.react","focusScopeQueries","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react"),k={chevronLeft:{alignItems:"x6s0dn4",display:"x3nfvp2",marginBottom:"xmgb6t1",marginStart:"x139jcc6",$$css:!0},menuHeading:{alignItems:"x6s0dn4",color:"x14ctfv",cursor:"x1ypdohk",display:"x78zum5",fontWeight:"x1s688f",":hover_textDecoration":"x1lku1pv",$$css:!0},menuLabel:{cursor:"x1ypdohk",display:"x1rg5ohu",$$css:!0},menuOption:{marginStart:"x17adc0v",marginTop:"x1anpbxc",$$css:!0},menuOptionRow:{color:"x14ctfv",display:"x1lliihq",minWidth:"xfvyar9",outline:"x1a2a7pz",paddingTop:"xyqdw3p",paddingEnd:"x4uap5",paddingBottom:"xg8j3zb",paddingStart:"xkhd6sd",textAlign:"x1yc453h",$$css:!0},pressableOption:{width:"xh8yej3",$$css:!0},radio:{backgroundColor:"xiakxrv",borderTopStartRadius:"x1ykpwxx",borderTopEndRadius:"x118zf8b",borderBottomEndRadius:"xnwxkdh",borderBottomStartRadius:"xfocsrx",display:"x1rg5ohu",marginBottom:"xmgb6t1",marginEnd:"xmo9yow",paddingTop:"x1yrsyyn",paddingEnd:"xsyo7zv",paddingBottom:"x10b6aqq",paddingStart:"x16hj40l",$$css:!0},radioDot:{backgroundColor:"x14hiurz",borderTopStartRadius:"x8u2fvd",borderTopEndRadius:"x1ht7hnu",borderBottomEndRadius:"x1quq95r",borderBottomStartRadius:"x5yzy4c",display:"x1rg5ohu",height:"xqu0tyb",marginStart:"x8182xy",marginTop:"x1kgmq87",position:"x10l6tqk",width:"x51ohtg",$$css:!0},selectedOption:{fontWeight:"x1s688f",$$css:!0}};function a(a){var b=a.selectedVideoQuality,e=a.setPane;a=d("VideoPlayerHooks").useAvailableVideoQualities();var f=d("VideoPlayerHooks").useIsAbrEnabled(),g=d("VideoPlayerHooks").useController();return j.jsx(d("FocusRegion.react").FocusRegion,{autoFocusQuery:d("focusScopeQueries").headerFirstTabbableSecondScopeQuery,recoverFocusQuery:d("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:j.jsxs("div",{"data-testid":void 0,children:[j.jsx("div",{className:"x6s0dn4 x14ctfv x1ypdohk x78zum5 x1s688f x1lku1pv",children:j.jsxs(c("CometPressable.react"),{onPress:function(){return e(d("VideoPlayerSettingsMenu.react").VideoPlayerSettingsMenuPaneType.MAIN)},testid:void 0,xstyle:k.pressableOption,children:[j.jsx("span",{className:"x6s0dn4 x3nfvp2 xmgb6t1 x139jcc6",children:j.jsx(c("CometImage.react"),{src:i("480579")})}),h._("__JHASH__0EdCFWvij7o__JHASH__")]})}),j.jsxs("div",{className:"x17adc0v x1anpbxc","data-testid":void 0,children:[f?j.jsx("div",{children:j.jsxs(c("CometPressable.react"),{onPress:function(){g.selectVideoQuality("auto")},testid:void 0,xstyle:k.menuOptionRow,children:[j.jsx("div",{className:"xiakxrv x1ykpwxx x118zf8b xnwxkdh xfocsrx x1rg5ohu xmgb6t1 xmo9yow x1yrsyyn xsyo7zv x10b6aqq x16hj40l",children:b==="auto"&&j.jsx("div",{className:"x14hiurz x8u2fvd x1ht7hnu x1quq95r x5yzy4c x1rg5ohu xqu0tyb x8182xy x1kgmq87 x10l6tqk x51ohtg","data-testid":void 0})}),j.jsx("div",{className:"x1ypdohk x1rg5ohu"+(b==="auto"?" x1s688f":""),"data-testid":void 0,children:h._("__JHASH__pan0Y10zXIi__JHASH__")})]})},"auto"):null,a.map(function(a){var d=b===a;return j.jsx("div",{children:j.jsxs(c("CometPressable.react"),{onPress:function(){g.selectVideoQuality(a)},testid:void 0,xstyle:k.menuOptionRow,children:[j.jsx("div",{className:"xiakxrv x1ykpwxx x118zf8b xnwxkdh xfocsrx x1rg5ohu xmgb6t1 xmo9yow x1yrsyyn xsyo7zv x10b6aqq x16hj40l",children:d&&j.jsx("div",{className:"x14hiurz x8u2fvd x1ht7hnu x1quq95r x5yzy4c x1rg5ohu xqu0tyb x8182xy x1kgmq87 x10l6tqk x51ohtg","data-testid":void 0})}),j.jsx("div",{className:"x1ypdohk x1rg5ohu"+(d?" x1s688f":""),"data-testid":void 0,children:a})]})},a)}).reverse()]})]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerSettingsControl.react",["fbt","ix","VideoPlayerControlIcon.react","VideoPlayerDefaultControlsProperties","VideoPlayerSettingsMenu.react","VideoPlayerUserInteractionCounter","fbicon","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react"),k=d("react").useState;a=j.forwardRef(function(a,b){var e=a.alignMenuToIcon;e=e===void 0?!1:e;var f=a.children;f=f===void 0?null:f;var g=a.compactMenu,l=a.icon,m=a.menuOpened,n=a.onMenuOpen,o=a.onUserInteraction,p=a.setMenuOpened;a=k(!1);var q=a[0],r=a[1];a=h._("__JHASH__uL7pUaxPcnz__JHASH__");var s=p!=null;d("VideoPlayerUserInteractionCounter").useVideoPlayerUserInteraction("video_settings_menu",s?m===d("VideoPlayerDefaultControlsProperties").VideoMenuType.VIDEO_SETTINGS_MENU:q,o);var t=s?m===d("VideoPlayerDefaultControlsProperties").VideoMenuType.VIDEO_SETTINGS_MENU:q;return j.jsxs("div",{className:"x1rg5ohu x1k70j0n x1w0mnb xzueoph x1mnrxsn"+(e===!0?" x1n2onr6 xuxw1ft":""),ref:b,children:[t&&j.jsx("div",{className:"xjb1437 xacj9c0 x14ctfv x89ytp0 x889kno x1ou2tus x1a8lsjc x1egjynq x10l6tqk"+(e===!0?" x3m8u43":""+(g===!0?" xwjie4w":" x1fwd5yv")),children:j.jsx(d("VideoPlayerSettingsMenu.react").VideoPlayerSettingsMenu,{onClose:function(){s?p!=null&&p(null):r(!1)},children:f})}),j.jsx(c("VideoPlayerControlIcon.react"),{icon:l==null?d("fbicon")._(i("497567"),20):l,label:a,onPress:function(){s?p!=null&&p(t?null:d("VideoPlayerDefaultControlsProperties").VideoMenuType.VIDEO_SETTINGS_MENU):r(!q),!t&&n!=null&&n()},tooltip:a})]})});a.displayName="VideoPlayerSettingsControl";b=a;g["default"]=b}),98);
__d("VideoPlayerCometFeedStoryControlsImplLive.react",["CometRelay","VideoPlayerCometFeedStoryControlsImplLive_video.graphql","VideoPlayerLiveVideoControls.react","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react");function a(a){var e=a.disablePlaybackControls,f=a.expandControl,g=a.isAdVideo,j=a.isControlsVisible,k=a.isExpandControlVisible,l=a.isVolumeControlVisible,m=a.isWatchAndScrollControlVisible,n=a.isWatchAndScrollDisabled,o=a.onUserInteraction,p=a.reactionVideoChannelType,q=a.shouldHideRewindControls,r=a.subOrigin,s=a.video;a=a.videoTahoeUrl;s=d("CometRelay").useFragment(h!==void 0?h:h=b("VideoPlayerCometFeedStoryControlsImplLive_video.graphql"),s);var t=c("gkx")("976093");return i.jsx(c("VideoPlayerLiveVideoControls.react"),{disablePlaybackControls:e,expandControl:f,isControlsVisible:j,isExpandControlVisible:k,isVolumeControlVisible:l,isWatchAndScrollControlVisible:m,onUserInteraction:o,reactionVideoChannelType:p,shouldHideRewindControls:q,shouldRenderCastControl:!g,shouldRenderWatchAndScrollControl:!t&&!g&&n!==!0,subOrigin:r,video:s,videoTahoeUrl:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerNPCPlaybackControl.react",["fbt","ix","CometImage.react","CometPressable.react","VideoHomeTypedLoggerLite","VideoPlayerHooks","react","useFeedClickEventHandler","useVideoPlayerControllerSubscription"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react"),k=d("react").useEffect;function a(a){var b=a.isVisible;a=a.unmuteOnPlay;var e=a===void 0?!1:a;k(function(){c("VideoHomeTypedLoggerLite").log({event:"npc_control_large_playback_button_impression"})},[]);a=c("useVideoPlayerControllerSubscription")(function(a,b){var c=a.getCurrentState(),d=c.ended,e=c.paused,f=c.playing,g=c.stalling;a=a.getPlayheadPosition();c=c.duration;e=!e&&(f||g);g=!f&&d&&a>=c;return b!=null&&b.showPauseButton===e&&b.showReplayButton===g?b:{showPauseButton:e,showReplayButton:g}});var f=a.showPauseButton;a=a.showReplayButton;var g=d("VideoPlayerHooks").useController(),l=c("useFeedClickEventHandler")(function(){c("VideoHomeTypedLoggerLite").log({click_point:"npc_control_large_playback_button",event:"click",event_target:"video"}),f?g.pause("user_initiated"):(e&&g.setMuted(!1,"user_initiated"),g.play("user_initiated"))});a=f?"pause":a?"replay":"play";var m="",n=null;a==="pause"?(m=h._("__JHASH__neZzFA-dHLC__JHASH__"),n=j.jsx(c("CometImage.react"),{src:i("1343456")})):a==="replay"?(m=h._("__JHASH__HFCl7btmLVQ__JHASH__"),n=j.jsx(c("CometImage.react"),{src:i("215005")})):a==="play"&&(m=h._("__JHASH__Pdft-1wnTrL__JHASH__"),n=j.jsx(c("CometImage.react"),{src:i("101640")}));a=l!=null?j.jsx(c("CometPressable.react"),{display:"inline",label:m,onPress:l,overlayDisabled:!0,children:n}):n;return j.jsx("i",{className:"x14yjl9h xudhj91 x18nykt9 xww2gxu x1ypdohk xsdox4t xafmxuu x11i5rnm xat24cr x4mskuk x10l6tqk xtzzx4i x16l2wyv x1useyqa"+(b?" x1hc1fzr":" xg01cxk xlshs6z"),children:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerNPCSkipControlBase.react",["fbt","ix","VideoPlayerControlIcon.react","fbicon","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react");function a(a){a=a.onPress;var b=h._("__JHASH__SXm3xlVNnJv__JHASH__"),e=d("fbicon")._(i("1052613"),20);return j.jsx(c("VideoPlayerControlIcon.react"),{icon:e,label:b,onPress:a,tooltip:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerNPCSkipControl.react",["CometVideoHomeFeedAutoAdvanceAPIContext","VideoHomeTypedLoggerLite","VideoPlayerNPCSkipControlBase.react","react","useFeedClickEventHandler"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=d("react");var i=b.useContext,j=b.useEffect;function a(){j(function(){c("VideoHomeTypedLoggerLite").log({event:"control_npc_skip_video_impression"})},[]);var a=i(c("CometVideoHomeFeedAutoAdvanceAPIContext")),b=c("useFeedClickEventHandler")(function(){c("VideoHomeTypedLoggerLite").log({click_point:"control_npc_skip_video",event:"click",event_target:"video"}),a.advance(1)});return h.jsx(c("VideoPlayerNPCSkipControlBase.react"),{onPress:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerScrubberBottomWithPreview.react",["VideoPlayerScrubber.react","VideoPlayerScrubberPreview.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.onUserInteraction,d=a.video;return h.jsx("i",{className:"x1ypdohk x1hc1fzr x10l6tqk x17qophe x13e46mh xh8yej3",children:h.jsx(c("VideoPlayerScrubber.react"),{onUserInteraction:b,renderTooltip:function(a){return h.jsx(c("VideoPlayerScrubberPreview.react"),{timestampSec:a,video:d})}})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerScrubberWithPreview.react",["VideoPlayerScrubber.react","VideoPlayerScrubberPreview.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.onUserInteraction,d=a.video;return h.jsx(c("VideoPlayerScrubber.react"),{onUserInteraction:b,renderTooltip:function(a){return h.jsx(c("VideoPlayerScrubberPreview.react"),{timestampSec:a,video:d})}})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerTimeSkipBackwardLargeBase.react",["fbt","ix","CometPressable.react","TetraIcon.react","fbicon","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react");function a(a){var b=a.isVisible;b=b===void 0?!1:b;a=a.onPress;var e=h._("__JHASH__gz-XrCJ89xu__JHASH__"),f=d("fbicon")._(i("214057"),24);e=a!=null?j.jsx(c("CometPressable.react"),{display:"inline",label:e,onPress:a,overlayDisabled:!0,children:j.jsx(c("TetraIcon.react"),{color:"white",icon:f})}):j.jsx(c("TetraIcon.react"),{color:"white",icon:f});return j.jsx("i",{className:"x14yjl9h xudhj91 x18nykt9 xww2gxu x1ypdohk xxk0z11 xafmxuu x11i5rnm xat24cr x4mskuk x10l6tqk x1vek098 xic2vs9 xvy4d1p"+(b?" x1hc1fzr":" xg01cxk xlshs6z"),children:e})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerTimeSkipControlBase.react",["fbt","ix","VideoPlayerControlIcon.react","fbicon","react","unrecoverableViolation"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react");function a(a){var b=a.onPress;a=a.timeskipIcon;var e,f;switch(a){case"skip_backward":e=h._("__JHASH__FYc5UGqeztq__JHASH__");f=d("fbicon")._(i("213496"),20);break;case"skip_forward":e=h._("__JHASH__UlJlhbo4QHP__JHASH__");f=d("fbicon")._(i("213498"),20);break;default:a;throw c("unrecoverableViolation")("The timeskip icon is unsupported "+a,"comet_video_player")}return j.jsx(c("VideoPlayerControlIcon.react"),{icon:f,label:e,onPress:b,tooltip:e})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerTimeSkipBackwardControl.react",["VideoHomeTypedLoggerLite","VideoPlayerHooks","VideoPlayerTimeSkipBackwardLargeBase.react","VideoPlayerTimeSkipControlBase.react","react","useFeedClickEventHandler"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=d("react").useEffect,j=10;function a(a){var b=a.isLarge;b=b===void 0?!1:b;a=a.isVisible;a=a===void 0?!1:a;var e="npc_control_time_skip_backward_impression",f="control_time_skip_backward";b&&(e="npc_control_time_skip_backward_large_impression",f="control_time_skip_backward_large");i(function(){c("VideoHomeTypedLoggerLite").log({event:e})},[e]);var g=d("VideoPlayerHooks").useController(),k=c("useFeedClickEventHandler")(function(){c("VideoHomeTypedLoggerLite").log({click_point:f,event:"click",event_target:"video"});var a=g.getCurrentState().seekableRanges;a=(a=a==null?void 0:a.start(0))!=null?a:0;a=Math.max(g.getPlayheadPosition()-j,a);g.seek(a)});return b?h.jsx(c("VideoPlayerTimeSkipBackwardLargeBase.react"),{isVisible:a,onPress:k}):h.jsx(c("VideoPlayerTimeSkipControlBase.react"),{onPress:k,timeskipIcon:"skip_backward"})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerTimeSkipForwardLargeBase.react",["fbt","ix","CometPressable.react","TetraIcon.react","fbicon","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react");function a(a){var b=a.isVisible;b=b===void 0?!1:b;a=a.onPress;var e=h._("__JHASH__UlJlhbo4QHP__JHASH__"),f=d("fbicon")._(i("214059"),24);e=a!=null?j.jsx(c("CometPressable.react"),{display:"inline",label:e,onPress:a,overlayDisabled:!0,children:j.jsx(c("TetraIcon.react"),{color:"white",icon:f})}):j.jsx(c("TetraIcon.react"),{color:"white",icon:f});return j.jsx("i",{className:"x14yjl9h xudhj91 x18nykt9 xww2gxu x1ypdohk xxk0z11 xafmxuu x11i5rnm xat24cr x4mskuk x10l6tqk x1gcshxn xic2vs9 xvy4d1p"+(b?" x1hc1fzr":" xg01cxk xlshs6z"),children:e})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerTimeSkipForwardControl.react",["VideoHomeTypedLoggerLite","VideoPlayerHooks","VideoPlayerTimeSkipControlBase.react","VideoPlayerTimeSkipForwardLargeBase.react","react","useFeedClickEventHandler"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i=d("react").useEffect,j=10;function a(a){var b=a.isLarge;b=b===void 0?!1:b;a=a.isVisible;a=a===void 0?!1:a;var e="npc_control_time_skip_forward_impression",f="control_time_skip_forward";b&&(e="npc_control_time_skip_forward_large_impression",f="control_time_skip_forward_large");i(function(){c("VideoHomeTypedLoggerLite").log({event:e})},[e]);var g=d("VideoPlayerHooks").useController(),k=d("VideoPlayerHooks").useDuration(),l=c("useFeedClickEventHandler")(function(){c("VideoHomeTypedLoggerLite").log({click_point:f,event:"click",event_target:"video"});var a=Math.min(g.getPlayheadPosition()+j,k);g.seek(a)});return b?h.jsx(c("VideoPlayerTimeSkipForwardLargeBase.react"),{isVisible:a,onPress:l}):h.jsx(c("VideoPlayerTimeSkipControlBase.react"),{onPress:l,timeskipIcon:"skip_forward"})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useVideoPlayerPlaybackRateControlNUX",["cr:11881"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:11881")}),98);
__d("VideoPlayerCometFeedStoryControlsImplNotLive.react",["fbt","CometRelay","CometTrackingNodeProvider.react","PlaybackSpeedExperiments","VideoPlayerCaptionsControl.react","VideoPlayerCastControlShim.react","VideoPlayerCometFeedStoryControlsImplNotLive_video.graphql","VideoPlayerControlsContainerOverlay.react","VideoPlayerControlsGroups.react","VideoPlayerHooks","VideoPlayerJoinOnPortalControl.react","VideoPlayerNPCPlaybackControl.react","VideoPlayerNPCSkipControl.react","VideoPlayerPlaybackControl.react","VideoPlayerPlaybackTimer.react","VideoPlayerScrubberBottomWithPreview.react","VideoPlayerScrubberWithPreview.react","VideoPlayerSettingsControl.react","VideoPlayerTimeSkipBackwardControl.react","VideoPlayerTimeSkipForwardControl.react","VideoPlayerVolumeControl.react","VideoPlayerWatchAndScrollControl.react","cr:1790881","cr:1809777","emptyFunction","gkx","nux:31","qex","react","useCurrentRouteBuilder","useVideoPlayerBigPlayButtonOverlay","useVideoPlayerPlaybackRateControlNUX"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=d("react"),k=d("react").useState,l=d("PlaybackSpeedExperiments").isInCometHeadroomTest()?b("cr:1790881"):null,m=d("PlaybackSpeedExperiments").isInCometHeadroomTest()?b("cr:1809777"):null,n={nux:{maxWidth:"xw5ewwj",$$css:!0}};function a(a){var e,f=a.disablePlaybackControls,g=a.expandControl,o=a.isAdVideo,p=a.isControlsVisible,q=a.isExpandControlVisible,r=a.isVolumeControlVisible,s=a.isWatchAndScrollControlVisible,t=a.isWatchAndScrollDisabled,u=a.onUserInteraction,v=a.subOrigin,w=a.video;a=a.videoTahoeUrl;w=d("CometRelay").useFragment(i!==void 0?i:i=b("VideoPlayerCometFeedStoryControlsImplNotLive_video.graphql"),w);var x=d("VideoPlayerHooks").useShouldShowPlaybackRateControl();x=d("PlaybackSpeedExperiments").enableCometPlaybackSpeedControlNUX()&&["discover","entry_point"].includes(v)&&x;x=c("useVideoPlayerPlaybackRateControlNUX")(x);var y=x[0];x=x[1];var z=(w==null?void 0:w.recipient_group)!=null&&(w==null?void 0:w.captions_url)!=null;z=z;e=(e=b("nux:31")==null?void 0:b("nux:31")("comet_group_video_caption_setting"))!=null?e:c("emptyFunction");e=e({align:"end",arrowStyle:"inset",hasCloseButton:!0,label:h._("__JHASH__hNkQA-7yz1h__JHASH__"),position:"above",type:"accent",xstyle:n.nux},z);z=c("useVideoPlayerBigPlayButtonOverlay")();z=z.bigPlayButtonIsVisible;var A=!e&&x||p;s=s||A||f===!0&&!z;q=q||f===!0&&!o&&!z;z=c("gkx")("976093");var B=c("gkx")("4614"),C=d("VideoPlayerHooks").useCaptionsLoaded(),D=d("VideoPlayerHooks").useCaptionsVisible(),E=c("useCurrentRouteBuilder")();E=E==null?void 0:E.buildURL().toString();a=f!==!0&&a==null&&(E==null?void 0:E.includes("/watch/"))===!0;E=a&&c("qex")._("121");var F=a&&c("qex")._("261"),G=a&&F===!1&&c("qex")._("262"),H=F===!0&&c("qex")._("262"),I=a&&c("qex")._("263");t=!z&&!o&&t!==!0&&w!=null?j.jsx(d("VideoPlayerControlsGroups.react").Contracted,{isVisible:s,children:j.jsx(c("VideoPlayerWatchAndScrollControl.react"),{subOrigin:v,video:w})}):null;s=j.jsx(d("VideoPlayerControlsGroups.react").Contracted,{isVisible:A,noPaddingEnd:!0,children:j.jsx(c("VideoPlayerJoinOnPortalControl.react"),{isVisible:A})});x=j.jsx(d("VideoPlayerControlsGroups.react").Contracted,{isVisible:!e&&x||q,noPaddingEnd:!0,noPaddingStart:!0,children:g});q=k(null);g=q[0];q=q[1];return j.jsxs(c("VideoPlayerControlsContainerOverlay.react"),{isBackgroundVisible:A,children:[H===!0?j.jsx(c("VideoPlayerTimeSkipBackwardControl.react"),{isLarge:!0,isVisible:p}):null,F===!0?j.jsx(c("VideoPlayerNPCPlaybackControl.react"),{isVisible:p}):null,H===!0?j.jsx(c("VideoPlayerTimeSkipForwardControl.react"),{isLarge:!0,isVisible:p}):null,j.jsxs(d("VideoPlayerControlsGroups.react").Contracted,{isVisible:A,children:[G===!0?j.jsx(c("VideoPlayerTimeSkipBackwardControl.react"),{}):null,F===!1||z?j.jsx(c("VideoPlayerPlaybackControl.react"),{isNPC:a}):null,G===!0?j.jsx(c("VideoPlayerTimeSkipForwardControl.react"),{}):null,E===!0?j.jsx(c("VideoPlayerNPCSkipControl.react"),{}):null,f===!0?null:j.jsx(c("VideoPlayerPlaybackTimer.react"),{}),l!=null?j.jsx(d("VideoPlayerControlsGroups.react").Contracted,{isVisible:A&&!f,children:j.jsx(l,{onUserInteraction:u})}):null]}),j.jsx(d("VideoPlayerControlsGroups.react").Expanded,{isVisible:(I===!1||z)&&A&&!f,children:j.jsx(c("VideoPlayerScrubberWithPreview.react"),{onUserInteraction:u,video:w})}),j.jsx(d("VideoPlayerControlsGroups.react").Contracted,{isVisible:I===!0&&A&&!f,children:j.jsx(c("VideoPlayerScrubberBottomWithPreview.react"),{onUserInteraction:u,video:w})}),j.jsx(d("VideoPlayerControlsGroups.react").Contracted,{isVisible:A&&!f,noPaddingEnd:!0,children:j.jsx(c("CometTrackingNodeProvider.react"),{trackingNode:257,children:j.jsx(c("VideoPlayerSettingsControl.react"),{menuOpened:g,onUserInteraction:u,ref:(H=e)!=null?H:y,setMenuOpened:q})})}),C||B?j.jsx(d("VideoPlayerControlsGroups.react").Contracted,{isVisible:A&&!f,children:j.jsx(c("VideoPlayerCaptionsControl.react"),{captionsVisible:D,menuOpened:g,onUserInteraction:u,setMenuOpened:q,video:w})}):null,!o&&w!=null?j.jsx(c("VideoPlayerCastControlShim.react"),{isVisible:A&&!f,subOrigin:v}):null,x,s,t,m!=null?j.jsx(d("VideoPlayerControlsGroups.react").Contracted,{isVisible:!0,children:j.jsx(m,{enableNUX:d("PlaybackSpeedExperiments").enableCometPlaybackSpeedControlHeadroomTestNUX()&&["discover","entry_point"].includes(v),onUserInteraction:u})}):null,j.jsx(d("VideoPlayerControlsGroups.react").Contracted,{isVisible:m?!0:r,noPaddingStart:!0,children:j.jsx(c("CometTrackingNodeProvider.react"),{trackingNode:114,children:j.jsx(c("VideoPlayerVolumeControl.react"),{onUserInteraction:u})})})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MusicClipPlayerPlaybackTimer.react",["VideoPlayerHooks","getFormattedTimestamp","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.endTimeSeconds,e=a.startTimeSeconds,f=a.timerTextXStyle;a=a.timerXStyle;var g=d("VideoPlayerHooks").useCurrentTimeThrottled(200);g=g-e;b=b-e;e=d("VideoPlayerHooks").usePlaying();e=g<=0&&!e?b:g;return h.jsx("div",{className:c("stylex")(a),children:h.jsx("span",{className:c("stylex")(f),children:c("getFormattedTimestamp")(e)})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerDefaultControlsImplMusicClipConvertBoundsLogic",[],(function(a,b,c,d,e,f){"use strict";var g=1e3,h=0,i=30,j=30;function a(a,b){var c=h,d=i;a!=null&&b!=null&&(c=Math.round(a/g),d=Math.round(b/g));d>c+j&&(d=c+j);return{lower_s:c,upper_s:d}}f["default"]=a}),66);
__d("VideoPlayerDefaultControlsImplMusicClip.react",["CometRelay","MusicClipPlayerPlaybackTimer.react","VideoPlayerControlsContainerOverlay.react","VideoPlayerControlsGroups.react","VideoPlayerDefaultControlsImplMusicClipConvertBoundsLogic","VideoPlayerDefaultControlsImplMusicClip_video.graphql","VideoPlayerHooks","VideoPlayerPlaybackControl.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react");e=d("react");var j=e.useEffect,k=e.useRef,l={controls:{alignItems:"x6s0dn4",bottom:"xn0vg7t",display:"x78zum5",end:"x1f00ac0",flexDirection:"x1q0g3np",justifyContent:"xl56j7k",position:"x10l6tqk",$$css:!0},timer:{color:"x14ctfv",display:"x1rg5ohu",fontSize:"x1pg5gke",fontVariantNumeric:"xss6m8b",lineHeight:"x7h9g57",marginEnd:"x1t4t16n",marginStart:"x8j4wrb",minWidth:"x9hgts1",textAlign:"x2b8uid",textShadow:"x27saw0",verticalAlign:"x3ajldb",$$css:!0},timerText:{fontWeight:"x1s688f",minWidth:"x15hfatp",$$css:!0}};function a(a){var e;a=a.video;a=d("CometRelay").useFragment(h!==void 0?h:h=b("VideoPlayerDefaultControlsImplMusicClip_video.graphql"),a);e=a==null?void 0:(e=a.music_attachment_metadata)==null?void 0:e.start_time_ms;a=a==null?void 0:(a=a.music_attachment_metadata)==null?void 0:a.end_time_ms;e=c("VideoPlayerDefaultControlsImplMusicClipConvertBoundsLogic")(e,a);var f=e.lower_s,g=e.upper_s,m=d("VideoPlayerHooks").useController();j(function(){m.seek(f),m.pause("product_initiated")},[m,f]);var n=k(null);j(function(){var a=m.subscribe(function(){var a=m.getPlayheadPosition();a!==n.current&&(n.current=a,a>g&&(m.seek(f),m.pause("product_initiated")))});return function(){a.remove()}},[m,f,g]);a=i.jsxs(d("VideoPlayerControlsGroups.react").Contracted,{isVisible:!0,children:[i.jsx(c("MusicClipPlayerPlaybackTimer.react"),{endTimeSeconds:g,startTimeSeconds:f,timerTextXStyle:l.timerText,timerXStyle:l.timer}),i.jsx(c("VideoPlayerPlaybackControl.react"),{unmuteOnPlay:!0})]});return i.jsx("div",{className:"x6s0dn4 xn0vg7t x78zum5 x1f00ac0 x1q0g3np xl56j7k x10l6tqk",children:i.jsx(c("VideoPlayerControlsContainerOverlay.react"),{isVisible:!0,children:a})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("VideoPlayerWithVideoCardsOverlay.react",["CometPlaceholder.react","CometRelay","VideoPlayerWithVideoCardsOverlay_video.graphql","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react");function a(a){var e=a.cardsHidden,f=a.surface;a=a.video;a=d("CometRelay").useFragment(h!==void 0?h:h=b("VideoPlayerWithVideoCardsOverlay_video.graphql"),a);return i.jsx(c("CometPlaceholder.react"),{fallback:null,children:i.jsx(d("CometRelay").MatchContainer,{match:a==null?void 0:a.comet_video_player_with_video_card_renderer,props:{cardsHidden:e,surface:f}})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("LSBeginHandlingFireForgetTasksForQueue",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return c[0]=b.createArray(),b.fe(b.ftr(b.db.table(5).fetch(),function(b){return b.queueName===a[0]}),function(a){a=a.item;return c[3]=new b.Map(),c[3].set("label",a.context),c[3].set("payload",a.taskValue),c[3].set("queue_name",a.queueName),c[3].set("task_id",a.taskId),c[3].set("failure_count",b.i64.eq([0,0],[0,0])?e:[0,0]),c[4]=(c[0].push(c[3]),c[0])})},function(f){return c[1]=new b.Map(),c[1].set("tasks",c[0]),c[1].set("epoch_id",e),c[2]=new b.Map(),c[2].set("queue_name",a[0]),c[2].set("next_sync_ms",e),c[2].set("work_item_type",[0,5]),c[2].set("network_payload",c[1]),c[2].set("http_url_override",e),c[2].set("skip_realtime_gateway",!1),d[0]=c[2]}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSSerializeBackupPayloadIndirection.bs",["bs_curry","cr:280","cr:4152","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a,d,e,f,g){if(b("cr:4152")==null)if(b("cr:280")==null)return c("unrecoverableViolation")("LSSerializeBackupPayloadIndirection.res: messenger_armadillo_web:enable_armadillo OR messenger_armadillo_web:enable_encrypted_backups_shadow_test is not defined","labyrinth_web");else return c("bs_curry")._5(b("cr:280").call,a,d,e,f,g).then(function(a){return a});else return c("bs_curry")._5(b("cr:4152").call,a,d,e,f,g).then(function(a){return a})}d=a;g.$LSSerializeBackupPayloadConditional$requireCond=b("cr:280");g.$LSSerializeBackupPayloadConditional$requireCondXplat=b("cr:4152");g.call=d}),98);
__d("LSSerializeBackupPayloadIndirection.nop",["LSSerializeBackupPayloadIndirection.bs"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b,c,e,f){return d("LSSerializeBackupPayloadIndirection.bs").call(a,b,c,e,f)};g["default"]=a}),98);
__d("LSDeleteBackupOnClient",["LSAppendDataTraceAddon","LSFlushDataTrace.nop","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(d){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure]Beginning execution."),a[3]!==f?c.sp(b("LSAppendDataTraceAddon"),a[3],[0,1423],[0,2],f,f):c.resolve()},function(a){return d[0]=!1,d[0]?d[1]=!0:d[1]=!1,d[1]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),d[2]=c.createArray(),f!==f?d[3]=(d[2].push(f),d[2]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[2],[0,3])):c.resolve()},function(b){return c.i64.neq(a[0],f)?c.fe(c.db.table(168).fetch([[[a[0]]]]),function(a){return a["delete"]()}):c.fe(c.db.table(168).fetch(),function(a){return a["delete"]()})},function(b){return c.i64.neq(a[0],f)?c.fe(c.db.table(169).fetch([[[a[0]]],"fk_secure_encrypted_backups_client_state"]),function(a){return a["delete"]()}):c.fe(c.db.table(169).fetch(),function(a){return a["delete"]()})},function(a){return c.fe(c.db.table(190).fetch(),function(a){return a["delete"]()})},function(a){return c.fe(c.db.table(174).fetch(),function(a){return a["delete"]()})},function(b){return a[1]==="fetch_virtual_device"?c.db.table(178).put({pk:[0,1],recoveryCodeStatus:[0,4]}):c.resolve()},function(b){return a[2]?c.seq([function(a){return c.fe(c.db.table(172).fetch([[[[0,1]]]]),function(a){var b=a.update;a.item;return b({backupId:f})})},function(b){return c.i64.neq(a[0],f)?c.fe(c.ftr(c.db.table(184).fetch(),function(b){return c.i64.eq(b.backupId,a[0])}),function(a){return a["delete"]()}):c.fe(c.db.table(184).fetch(),function(a){return a["delete"]()})},function(b){return c.i64.neq(a[0],f)?c.fe(c.db.table(196).fetch([[[a[0]]]]),function(a){return a["delete"]()}):c.fe(c.db.table(196).fetch(),function(a){return a["delete"]()})}]):c.resolve()},function(e){return a[5]?c.seq([function(e){return a[5]?c.seq([function(d){return a[3]!==f?c.sp(b("LSAppendDataTraceAddon"),a[3],[0,84],[0,2],f,f):c.resolve()},function(a){return d[4]=!1,d[4]?d[5]=!0:d[5]=!1,d[5]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),d[6]=c.createArray(),f!==f?d[7]=(d[6].push(f),d[6]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[6],[0,3])):c.resolve()}]):a[3]!==f?c.seq([function(d){return a[3]!==f?c.sp(b("LSAppendDataTraceAddon"),a[3],[0,85],[0,2],"The flow did not succeed",f):c.resolve()},function(a){return d[4]=!1,d[4]?d[5]=!0:d[5]=!1,d[5]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),d[6]=c.createArray(),f!==f?d[7]=(d[6].push(f),d[6]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[6],[0,3])):c.resolve()}]):c.resolve()},function(d){return a[3]!==f?c.nop(b("LSFlushDataTrace.nop"),a[3]):c.resolve()},function(a){return d[2]=!1,d[2]?d[3]=!0:d[3]=!1,d[3]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),d[4]=c.createArray(),f!==f?d[5]=(d[4].push(f),d[4]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[4],[0,3])):c.resolve()}]):a[4]!==f?c.seq([function(e){return d[5]=["[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure]","",a[4]].join(""),function(a){c.logger(a).mustfix(a)}(d[5]),d[2]=c.createArray(),a[3]!==f?d[6]=(d[2].push(a[3]),d[2]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDeleteBackupOnClientStoredProcedure",a[4],d[2],[0,3])},function(e){return a[3]!==f?c.seq([function(e){return a[3]!==f?c.sp(b("LSAppendDataTraceAddon"),a[3],[0,85],[0,2],d[5],f):c.resolve()},function(a){return d[6]=!1,d[6]?d[7]=!0:d[7]=!1,d[7]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),d[8]=c.createArray(),f!==f?d[9]=(d[8].push(f),d[8]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[8],[0,3])):c.resolve()}]):c.resolve()},function(d){return a[3]!==f?c.nop(b("LSFlushDataTrace.nop"),a[3]):c.resolve()},function(a){return d[3]=!1,d[3]?d[4]=!0:d[4]=!1,d[4]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),d[6]=c.createArray(),f!==f?d[7]=(d[6].push(f),d[6]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[6],[0,3])):c.resolve()}]):c.seq([function(e){return a[3]!==f?c.seq([function(d){return a[3]!==f?c.sp(b("LSAppendDataTraceAddon"),a[3],[0,85],[0,2],["[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure]","",""].join(""),f):c.resolve()},function(a){return d[4]=!1,d[4]?d[5]=!0:d[5]=!1,d[5]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),d[6]=c.createArray(),f!==f?d[7]=(d[6].push(f),d[6]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[6],[0,3])):c.resolve()}]):c.resolve()},function(d){return a[3]!==f?c.nop(b("LSFlushDataTrace.nop"),a[3]):c.resolve()},function(a){return d[2]=!1,d[2]?d[3]=!0:d[3]=!1,d[3]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),d[4]=c.createArray(),f!==f?d[5]=(d[4].push(f),d[4]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[4],[0,3])):c.resolve()}])},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure]Finishing execution.")}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSSyncEpochs",["LSAppendDataTraceAddon","LSCreateDataTraceID.nop","LSDeleteBackupOnClient","LSFlushDataTrace.nop","LSIssueNewTask","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function g(){var a=babelHelpers.taggedTemplateLiteralLoose(["0"]);g=function(){return a};return a}function a(){var a=arguments,c=a[a.length-1],d=c.n,e=[],f=[],h;return c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Beginning execution."),c.islc(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])&&c.i64.eq(a.backupTenancy,[0,2])}),0,c.i64.to_float([0,1])).next().then(function(a,b){b=a.done;a=a.value;return b?e[0]=!1:(a.item,e[0]=!0)})},function(a){return e[0]?e[2]=c.i64.or_([0,78],[0,128]):e[2]=[0,78],c.nop(b("LSCreateDataTraceID.nop")).then(function(a){return a=a,e[3]=a[0],a})},function(a){return e[4]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils]",e[4],"EncryptedBackups MCD Trace ID",e[4],c.i64.to_string(e[2])].join("")),c.db.table(153).add({traceId:e[3],initTimestampMs:c.i64.of_float(Date.now()),traceType:e[2],shouldFlush:!1,contextThree:"synch_epochs"})},function(a){return e[5]=!1,e[5]?e[6]=!0:e[6]=!1,e[6]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),e[11]=c.createArray(),h!==h?e[12]=(e[11].push(h),e[11]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[11],[0,3])):c.resolve()},function(a){return e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,1436],[0,2],h,h):c.resolve()},function(a){return e[7]=!1,e[7]?e[8]=!0:e[8]=!1,e[8]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),e[11]=c.createArray(),h!==h?e[12]=(e[11].push(h),e[11]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[11],[0,3])):c.resolve()},function(a){return c.ftr(c.db.table(2).fetch(),function(a){return a.context===c.i64.to_string([0,50013])}).next().then(function(a,b){b=a.done;a=a.value;return b?e[9]=!1:(a.item,e[9]=!0)})},function(a){return e[9]?(e[11]="Another sync job is already in progress. Terminating this.",e[11]!==h?c.seq([function(a){return e[15]=["[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]","",e[11]].join(""),function(a){c.logger(a).mustfix(a)}(e[15]),e[12]=c.createArray(),e[3]!==h?e[16]=(e[12].push(e[3]),e[12]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsSyncEpochsStoredProcedure",e[11],e[12],[0,3])},function(a){return e[3]!==h?c.seq([function(a){return e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,85],[0,2],e[15],h):c.resolve()},function(a){return e[16]=!1,e[16]?e[17]=!0:e[17]=!1,e[17]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),e[18]=c.createArray(),h!==h?e[19]=(e[18].push(h),e[18]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[18],[0,3])):c.resolve()}]):c.resolve()},function(a){return e[3]!==h?c.nop(b("LSFlushDataTrace.nop"),e[3]):c.resolve()},function(a){return e[13]=!1,e[13]?e[14]=!0:e[14]=!1,e[14]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),e[16]=c.createArray(),h!==h?e[17]=(e[16].push(h),e[16]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[16],[0,3])):c.resolve()}]):c.seq([function(a){return e[3]!==h?c.seq([function(a){return e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,85],[0,2],["[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]","",""].join(""),h):c.resolve()},function(a){return e[14]=!1,e[14]?e[15]=!0:e[15]=!1,e[15]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),e[16]=c.createArray(),h!==h?e[17]=(e[16].push(h),e[16]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[16],[0,3])):c.resolve()}]):c.resolve()},function(a){return e[3]!==h?c.nop(b("LSFlushDataTrace.nop"),e[3]):c.resolve()},function(a){return e[12]=!1,e[12]?e[13]=!0:e[13]=!1,e[13]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),e[14]=c.createArray(),h!==h?e[15]=(e[14].push(h),e[14]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[14],[0,3])):c.resolve()}])):c.seq([function(a){return c.ct(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])})).then(function(a){return e[11]=a})},function(a){return c.i64.eq(e[11],[0,1])?c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])}).next().then(function(a,f){var i=a.done;a=a.value;return i?0:(f=a.item,e[13]=f.backupId,e[12]=f.deviceId,c.i64.neq(e[12],h)?c.seq([function(a){return c.ct(c.db.table(169).fetch()).then(function(a){return e[14]=a})},function(a){return c.i64.neq(e[14],d(g()))?e[15]=!0:e[15]=!1,e[15]?(e[16]=new c.Map(),e[16].set("backup_id",e[13]),e[16].set("device_id",e[12]),e[16].set("trace_id",e[3]),e[17]=c.toJSON(e[16]),c.sp(b("LSIssueNewTask"),"messenger_encrypted_backups",[0,50013],e[17],h,h,[0,0],[0,0],h,h,[0,0])):c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]epochs table is null/empty. Cleaning backup on client"),e[3]!==h?c.seq([function(a){return e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,85],[0,2],"[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]epochs table is null/empty. Cleaning backup on client",h):c.resolve()},function(a){return e[17]=!1,e[17]?e[18]=!0:e[18]=!1,e[18]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),e[19]=c.createArray(),h!==h?e[20]=(e[19].push(h),e[19]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[19],[0,3])):c.resolve()}]):c.resolve()},function(a){return e[16]=c.createArray(),e[3]!==h?e[17]=(e[16].push(e[3]),e[16]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsSyncEpochsStoredProcedure","epochs table is null/empty. Cleaning backup on client",e[16],[0,3])},function(a){return c.sp(b("LSDeleteBackupOnClient"),e[13],"synch_epochs",!0,e[3],"epochs table is null/empty. Cleaning backup on client",!1)}])}]):c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]device_id is null. Cleaning backup on client"),e[3]!==h?c.seq([function(a){return e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,85],[0,2],"[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]device_id is null. Cleaning backup on client",h):c.resolve()},function(a){return e[15]=!1,e[15]?e[16]=!0:e[16]=!1,e[16]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),e[17]=c.createArray(),h!==h?e[18]=(e[17].push(h),e[17]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[17],[0,3])):c.resolve()}]):c.resolve()},function(a){return e[14]=c.createArray(),e[3]!==h?e[15]=(e[14].push(e[3]),e[14]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsSyncEpochsStoredProcedure","device_id is null. Cleaning backup on client",e[14],[0,3])},function(a){return c.sp(b("LSDeleteBackupOnClient"),e[13],"synch_epochs",!0,e[3],"device_id is null. Cleaning backup on client",!1)}]))}):c.seq([function(a){return e[17]="Exactly 1 entry is expected in client_state_table",e[17]!==h?c.seq([function(a){return e[21]=["[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]","",e[17]].join(""),function(a){c.logger(a).mustfix(a)}(e[21]),e[18]=c.createArray(),e[3]!==h?e[22]=(e[18].push(e[3]),e[18]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsSyncEpochsStoredProcedure",e[17],e[18],[0,3])},function(a){return e[3]!==h?c.seq([function(a){return e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,85],[0,2],e[21],h):c.resolve()},function(a){return e[22]=!1,e[22]?e[23]=!0:e[23]=!1,e[23]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),e[24]=c.createArray(),h!==h?e[25]=(e[24].push(h),e[24]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[24],[0,3])):c.resolve()}]):c.resolve()},function(a){return e[3]!==h?c.nop(b("LSFlushDataTrace.nop"),e[3]):c.resolve()},function(a){return e[19]=!1,e[19]?e[20]=!0:e[20]=!1,e[20]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),e[22]=c.createArray(),h!==h?e[23]=(e[22].push(h),e[22]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[22],[0,3])):c.resolve()}]):c.seq([function(a){return e[3]!==h?c.seq([function(a){return e[3]!==h?c.sp(b("LSAppendDataTraceAddon"),e[3],[0,85],[0,2],["[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]","",""].join(""),h):c.resolve()},function(a){return e[20]=!1,e[20]?e[21]=!0:e[21]=!1,e[21]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),e[22]=c.createArray(),h!==h?e[23]=(e[22].push(h),e[22]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[22],[0,3])):c.resolve()}]):c.resolve()},function(a){return e[3]!==h?c.nop(b("LSFlushDataTrace.nop"),e[3]):c.resolve()},function(a){return e[18]=!1,e[18]?e[19]=!0:e[19]=!1,e[19]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),e[20]=c.createArray(),h!==h?e[21]=(e[20].push(h),e[20]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[20],[0,3])):c.resolve()}])},function(a){return e[14]="Exactly 1 entry is expected in client_state_table. Found = ",c.ct(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])})).then(function(a){return e[12]=a})},function(a){return e[15]=c.i64.to_string(e[12]),e[13]="",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]",e[13],e[14],e[13],e[15]].join("")),e[16]=c.createArray(),h!==h?e[18]=(e[16].push(h),e[16]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsSyncEpochsStoredProcedure",[e[14],",",e[15]].join(""),e[16],[0,3])}])}])},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Finishing execution.")}])},function(a){return c.resolve(f)}])}e.exports=a}),null);
__d("LSTaskSerializerMuteThreadV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,f){var g=d.done;d=d.value;return g?(c[3]=b.createArray(),c[4]=(c[3].push("TaskSerializerMuteThreadV2: Task ID not found"),c[3]),c[5]=(c[3].push(a[0]),c[3]),c[6]=b.toJSON(c[3]),function(a){b.logger(a).mustfix(a)}(c[6]),g=[e,e],c[0]=g[0],c[1]=g[1],g):(f=d.item,b.seq([function(a){return c[6]=f.threadKey,b.db.table(9).fetch([[[c[6]]]]).next().then(function(d,f){var a=d.done;d=d.value;return a?(c[7]=b.createArray(),c[8]=(c[7].push("TaskSerializerMuteThreadV2: Thread not found"),c[7]),c[9]=(c[7].push(c[6]),c[7]),c[10]=b.toJSON(c[7]),function(a){b.logger(a).mustfix(a)}(c[10]),a=[e,e],c[3]=a[0],c[4]=a[1],a):(f=d.item,b.seq([function(a){return b.db.table(9).fetch([[[c[6]]]]).next().then(function(d,f){var a=d.done;d=d.value;return a?c[7]=[0,1]:(f=d.item,c[12]=f.syncGroup,b.i64.neq(c[12],e)?c[11]=c[12]:c[11]=[0,1],c[7]=c[11])})},function(a){return c[9]=new b.Map(),c[9].set("thread_key",c[6]),c[9].set("mailbox_type",[0,0]),c[9].set("mute_expire_time_ms",f.muteExpireTimeMs),c[9].set("sync_group",c[7]),c[10]=b.toJSON(c[9]),a=[c[10],[0,144]],c[3]=a[0],c[4]=a[1],a}]))})},function(a){return a=[c[3],c[4]],c[0]=a[0],c[1]=a[1],a}]))})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSTaskSerializerRemoveThread",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,f){var g=d.done;d=d.value;return g?(c[3]=b.createArray(),c[4]=(c[3].push("TaskSerializerRemoveThreadV2: Task ID not found"),c[3]),c[5]=(c[3].push(a[0]),c[3]),c[6]=b.toJSON(c[3]),function(a){b.logger(a).mustfix(a)}(c[6]),g=[e,e],c[0]=g[0],c[1]=g[1],g):(f=d.item,c[5]=f.removeType,b.i64.neq(c[5],e)?(c[6]=new b.Map(),c[6].set("thread_key",f.threadKey),c[6].set("remove_type",c[5]),c[6].set("sync_group",f.syncGroup==null?[0,1]:f.syncGroup),c[7]=b.toJSON(c[6]),g=[c[7],[0,146]],c[3]=g[0],c[4]=g[1],g):(d=[e,e],c[3]=d[0],c[4]=d[1],d),f=[c[3],c[4]],c[0]=f[0],c[1]=f[1],f)})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("EncryptedBackupsSymmetricEncryptionUtils.bs",[],(function(a,b,c,d,e,f){"use strict";a=16;b=28;c=16;d=128;f.hChaCha20SubKeyNonceLengthInBytes=a;f.totalNonceLengthInBytes=b;f.aesGcmTagLengthInBytes=c;f.aesGcmTagLength=d}),66);
__d("HChaCha20",["err"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){}a.fromHexString=function(a){var b=a.match(/[A-Fa-f0-9]{1,2}/g);if(a.length===0||a.length%2!==0||b==null)throw c("err")('The string "'+a+'" is not valid hex.');return new Uint8Array(b.map(function(a){return parseInt(a,16)}))};a.bufferToUint32Array=function(a){var b=new DataView(a),c=[];a=a.byteLength/4;for(var d=0;d<a;d++)c.push(new DataView(b.buffer.slice(d*4,d*4+4)).getInt32(0));return Uint32Array.from(c)};a.rotate=function(a,b){a=a&4294967295;b=b&31;return(a<<b|a>>>32-b)>>>0};a.quarterRound=function(b,c,d,e){b=b;c=c;d=d;e=e;b=b+c&4294967295;e=a.rotate(e^b,16);d=d+e&4294967295;c=a.rotate(c^d,12);b=b+c&4294967295;e=a.rotate(e^b,8);d=d+e&4294967295;c=a.rotate(c^d,7);return[b>>>0,c>>>0,d>>>0,e>>>0]};var b=a.prototype;b.createHCtx=function(b,d){var e=new Uint32Array(16),f=a.fromHexString("657870616e642033322d62797465206b");if(f.byteLength!==16)throw c("err")("Could not create context. Invalid constant buffer length of "+f.byteLength+". Expected a length of 16");else if(b.byteLength!==32)throw c("err")("Could not create context. Invalid key buffer length of "+b.byteLength+". Expected a length of 32");else if(d.byteLength!==16)throw c("err")("Could not create context. Invalid nonce buffer length of "+d.byteLength+". Expected a length of 16");f=a.bufferToUint32Array(f.buffer);b=a.bufferToUint32Array(b);d=a.bufferToUint32Array(d);e.set(f);e.set(b,f.length);e.set(d,f.length+b.length);return e.buffer};b.hChaCha20Bytes=function(b,c){c=new DataView(this.createHCtx(c,b));b=c.getInt32(0);var d=c.getInt32(1<<2),e=c.getInt32(2<<2),f=c.getInt32(3<<2),g=c.getInt32(4<<2),h=c.getInt32(5<<2),i=c.getInt32(6<<2),j=c.getInt32(7<<2),k=c.getInt32(8<<2),l=c.getInt32(9<<2),m=c.getInt32(10<<2),n=c.getInt32(11<<2),o=c.getInt32(12<<2),p=c.getInt32(13<<2),q=c.getInt32(14<<2);c=c.getInt32(15<<2);for(var r=0;r<10;r++){var s=a.quarterRound(b,g,k,o);b=s[0];g=s[1];k=s[2];o=s[3];s=a.quarterRound(d,h,l,p);d=s[0];h=s[1];l=s[2];p=s[3];s=a.quarterRound(e,i,m,q);e=s[0];i=s[1];m=s[2];q=s[3];s=a.quarterRound(f,j,n,c);f=s[0];j=s[1];n=s[2];c=s[3];s=a.quarterRound(b,h,m,c);b=s[0];h=s[1];m=s[2];c=s[3];s=a.quarterRound(d,i,n,o);d=s[0];i=s[1];n=s[2];o=s[3];s=a.quarterRound(e,j,k,p);e=s[0];j=s[1];k=s[2];p=s[3];s=a.quarterRound(f,g,l,q);f=s[0];g=s[1];l=s[2];q=s[3]}return Uint32Array.from([b,d,e,f,o,p,q,c]).buffer};return a}();g.HChaCha20=a}),98);
__d("SymmetricEncryptionPaddingUtils.bs",["TextEncoder.bs","bs_caml_option","bs_js_math","bs_pervasives"],(function(a,b,c,d,e,f,g){"use strict";function h(a){if(a<10)return 10-a|0;var b=c("bs_js_math").floor_int(Math.log2(a)),d=c("bs_js_math").floor_int(Math.log2(b))+1|0;b=b-d|0;d=(1<<b)-1|0;b=a+d&c("bs_pervasives").lnot(d);return b-a|0}function i(a){var b=Uint32Array.BYTES_PER_ELEMENT,c=a.byteLength,d=h(c);d=(b+c|0)+d|0;d=new DataView(new ArrayBuffer(d));d.setUint32(0,c);c=new Uint8Array(d.buffer);c.set(new Uint8Array(a),b);return c.buffer}function a(a){var b=new TextEncoder();return i(d("TextEncoder.bs").encodeToArrayBuffer(b,a))}function b(a){var b=Uint32Array.BYTES_PER_ELEMENT,d=new DataView(a);if(d.byteLength<b)return;var e=a.byteLength;d=d.getUint32(0);e=e-b|0;if(d>=0&&d<=e)return c("bs_caml_option").some(a.slice(b,b+d|0))}g.getPaddingLength=h;g.padData=i;g.pad=a;g.stripPadding=b}),98);
__d("LSSymmetricEncryptionCreateEncryptedData.bs",["Crypto.bs","CryptoLogger.bs","EncryptedBackupsSymmetricEncryptionUtils.bs","HChaCha20","LSResult.bs","Promise","Promise.bs","SymmetricEncryptionPaddingUtils.bs","bs_caml_option"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e,f,g,h){var i=d("CryptoLogger.bs").make("symmetric_encryption_create_encrypted_data"),j=d("SymmetricEncryptionPaddingUtils.bs").padData(h),k=d("Crypto.bs").getRandomValues(new Uint8Array(d("EncryptedBackupsSymmetricEncryptionUtils.bs").totalNonceLengthInBytes));a=new(d("HChaCha20").HChaCha20)();e=a.hChaCha20Bytes(k.slice(0,d("EncryptedBackupsSymmetricEncryptionUtils.bs").hChaCha20SubKeyNonceLengthInBytes).buffer,f);return d("Promise.bs").$$catch(d("Crypto.bs").importKey("raw",e,{NAME:"Aes",VAL:"AES-GCM"},!1,["encrypt"]).then(function(a){return d("Crypto.bs").encrypt({additionalData:c("bs_caml_option").some(g),iv:k.slice(d("EncryptedBackupsSymmetricEncryptionUtils.bs").hChaCha20SubKeyNonceLengthInBytes).buffer,name:"AES-GCM",tagLength:d("EncryptedBackupsSymmetricEncryptionUtils.bs").aesGcmTagLength},a,j)}).then(function(a){var e=k.byteLength+a.byteLength|0;e=new Uint8Array(e);e.set(k);e.set(new Uint8Array(a),d("EncryptedBackupsSymmetricEncryptionUtils.bs").totalNonceLengthInBytes);return b("Promise").resolve(d("LSResult.bs").make(c("bs_caml_option").some(e.buffer)))}),function(a){d("CryptoLogger.bs").captureError(i,a).mustfix("symmetric data encryption failed");return b("Promise").resolve(d("LSResult.bs").make())})}e=a;g.call=e}),98);
__d("PromiseOptional.bs",["Promise","bs_caml_option","bs_curry"],(function(a,b,c,d,e,f,g){"use strict";function h(a,d){return a.then(function(a){if(a!==void 0)return c("bs_curry")._1(d,c("bs_caml_option").valFromOption(a));else return b("Promise").resolve()})}function i(a){return b("Promise").resolve(c("bs_caml_option").some(a))}function a(a){return a.then(i)}function d(a){return b("Promise").resolve(a)}function e(a,d){var e=function(a){a=c("bs_curry")._1(d,a);return b("Promise").resolve(c("bs_caml_option").some(a))};return h(a,e)}function f(a,d){var e=function(a){return b("Promise").resolve(c("bs_curry")._1(d,a))};return h(a,e)}function j(a){return b("Promise").reject(a)}g.$$then=h;g.resolve=i;g.fromPromise=a;g.wrapOption=d;g.thenSome=e;g.thenResolve=f;g.reject=j}),98);
__d("LSSymmetricEncryptionCreateEncryptedString.bs",["Base64.bs","Crypto.bs","CryptoLogger.bs","LSResult.bs","LSSymmetricEncryptionCreateEncryptedData.bs","Promise","Promise.bs","PromiseOptional.bs"],(function(a,b,c,d,e,f,g){"use strict";function a(a,c,e,f,g){var h=d("CryptoLogger.bs").make("symmetric_encryption_create_encrypted_string");return d("Promise.bs").$$catch(d("PromiseOptional.bs").thenSome(d("LSSymmetricEncryptionCreateEncryptedData.bs").call(a,c,e,f,d("Crypto.bs").Utils.strToBuf(g)).then(function(a){return a[0]}),d("Base64.bs").fromArrayBuffer).then(d("LSResult.bs").make),function(a){d("CryptoLogger.bs").captureError(h,a).mustfix("symmetric string encryption failed");return b("Promise").resolve(d("LSResult.bs").make())})}c=a;g.call=c}),98);
__d("LSSymmetricEncryptionCreateEncryptedString.nop",["LSSymmetricEncryptionCreateEncryptedString.bs"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b,c,e,f){return d("LSSymmetricEncryptionCreateEncryptedString.bs").call(a,b,c,e,f)};g["default"]=a}),98);
__d("LSTaskSerializerSendMessageV2",["LSSymmetricEncryptionCreateEncryptedString.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(31).fetch([[[a[0]]]]).next().then(function(d,f){var g=d.done;d=d.value;return g?(c[3]=b.createArray(),c[4]=(c[3].push("task ID not found"),c[3]),c[5]=(c[3].push(a[0]),c[3]),c[6]=b.toJSON(c[3]),function(a){b.logger(a).mustfix(a)}(c[6]),g=[e,e],c[0]=g[0],c[1]=g[1],g):(f=d.item,b.seq([function(d){return c[9]=f.offlineThreadingId,c[10]=f.messageId,c[15]=f.threadAttributionSource,c[7]=f.platformRef,c[8]=f.platformToken,c[6]=f.replySourceId,c[11]=f.replySourceType,c[14]=f.sendType,c[12]=f.initiatingSource,c[13]=f.skipUrlPreviewGen,b.db.table(12).fetch([[[c[9]]],"optimistic"]).next().then(function(f,h){var d=f.done;f=f.value;return d?(c[16]=b.createArray(),c[17]=(c[16].push("OTID not found"),c[16]),c[18]=(c[16].push(c[9]),c[16]),c[19]=b.toJSON(c[16]),function(a){b.logger(a).mustfix(a)}(c[19]),d=[e,e],c[3]=d[0],c[4]=d[1],d):(h=f.item,b.seq([function(d){return c[22]=h.text,c[19]=h.threadKey,c[23]=h.messageId,c[21]=h.stickerId,c[25]=h.mentionOffsets,c[26]=h.mentionLengths,c[20]=h.mentionIds,c[27]=h.mentionTypes,c[30]=h.replyType,c[28]=h.isForwarded,c[24]=h.forwardScore,c[29]=h.hotEmojiSize,b.db.table(9).fetch([[[c[19]]]]).next().then(function(f,i){var d=f.done;f=f.value;return d?(c[31]=b.createArray(),c[32]=(c[31].push("thread not found"),c[31]),c[33]=(c[31].push(c[19]),c[31]),c[34]=b.toJSON(c[31]),function(a){b.logger(a).mustfix(a)}(c[34]),d=[e,e],c[16]=d[0],c[17]=d[1],d):(i=f.item,b.seq([function(d){return b.db.table(2).fetch([[[a[0]]]]).next().then(function(e,f){var d=e.done;e=e.value;return d?c[31]=!1:(f=e.item,b.seq([function(d){return b.islc(b.db.table(2).fetch([[[f.queueName]],"queueNameTaskId"]),0,b.i64.to_float([0,1])).next().then(function(e,f){var d=e.done;e=e.value;return d?c[35]=!1:(f=e.item,c[35]=b.i64.eq(f.taskId,a[0]))})},function(a){return c[31]=c[35]}]))})},function(a){return b.i64.eq(i.authorityLevel,[0,20])&&b.i64.eq(i.threadType,[0,2])&&c[31]?b.seq([function(a){return c[38]=c[14]==null?[0,1]:c[14],b.db.table(9).fetch([[[c[19]]]]).next().then(function(d,f){var a=d.done;d=d.value;return a?c[35]=[0,1]:(f=d.item,c[47]=f.syncGroup,b.i64.neq(c[47],e)?c[46]=c[47]:c[46]=[0,1],c[35]=c[46])})},function(a){return c[37]=new b.Map(),c[37].set("thread_id",c[19]),c[37].set("otid",c[9]),c[37].set("source",c[15]==null?[0,0]:c[15]),c[37].set("send_type",[0,1]),c[37].set("sync_group",c[35]),b.i64.eq(c[38],[0,1])?b.resolve(c[37].set("text",c[22])):b.i64.eq(c[38],[0,2])?b.resolve(b.i64.neq(c[21],e)?(c[37].set("sticker_id",c[21]),c[37].set("send_type",c[38])):0):b.i64.eq(c[38],[0,7])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[23]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[46]=a[0],c[47]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[46]=a[0],c[47]=a[1],a)})},function(a){return c[46]!==e?b.i64.neq(c[47],e)?(c[37].set("url",c[46]),c[37].set("attribution_app_id",c[47]),c[37].set("send_type",c[38])):0:0}]):b.i64.eq(c[38],[0,3])?b.seq([function(a){return c[37].set("text",c[22]),c[46]=b.createArray(),c[47]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[23]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[48]=a.offlineAttachmentId,c[49]=(c[46].push(b.i64.from_string(a.attachmentFbid)),c[46]),c[48]!==e?c[49]=(c[47].push(c[48]),c[47]):0})},function(a){return c[37].set("attachment_fbids",c[46]),b.i64.eq(c[38],[0,9])?c[37].set("offline_attachment_ids",c[47]):0,c[37].set("send_type",c[38])}]):b.i64.eq(c[38],[0,9])?b.seq([function(a){return c[37].set("text",c[22]),c[46]=b.createArray(),c[47]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[23]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[48]=a.offlineAttachmentId,c[49]=(c[46].push(b.i64.from_string(a.attachmentFbid)),c[46]),c[48]!==e?c[49]=(c[47].push(c[48]),c[47]):0})},function(a){return c[37].set("attachment_fbids",c[46]),b.i64.eq(c[38],[0,9])?c[37].set("offline_attachment_ids",c[47]):0,c[37].set("send_type",c[38])}]):b.i64.eq(c[38],[0,10])?b.seq([function(a){return c[37].set("text",c[22]),c[46]=b.createArray(),c[47]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[23]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[48]=a.offlineAttachmentId,c[49]=(c[46].push(b.i64.from_string(a.attachmentFbid)),c[46]),c[48]!==e?c[49]=(c[47].push(c[48]),c[47]):0})},function(a){return c[37].set("attachment_fbids",c[46]),b.i64.eq(c[38],[0,9])?c[37].set("offline_attachment_ids",c[47]):0,c[37].set("send_type",c[38])}]):b.i64.eq(c[38],[0,4])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[23]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?c[46]=e:(d=b.item,c[46]=d.attachmentFbid)})},function(a){return c[46]!==e?(c[37].set("text",c[22]),c[37].set("forwarded_share_id",c[46]),c[37].set("send_type",c[38])):0}]):b.i64.eq(c[38],[0,5])?b.resolve(c[10]!==e?(c[37].set("forwarded_msg_id",c[10]),c[37].set("send_type",c[38]),b.i64.neq(c[24],e)?c[37].set("forward_score",c[24]):0,c[37].set("strip_forwarded_msg_caption",!1)):0):b.i64.eq(c[38],[0,6])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[23]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[46]=a[0],c[47]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[46]=a[0],c[47]=a[1],a)})},function(a){return c[46]!==e?(c[37].set("url",c[46]),c[37].set("text",c[22]),c[37].set("send_type",c[38])):0}]):b.resolve(0)},function(a){return c[42]=c[6]===""?e:c[6],c[42]!==e?b.i64.neq(c[11],e)?(c[46]=new b.Map(),c[46].set("reply_source_id",c[42]),c[46].set("reply_source_type",c[11]),c[46].set("reply_type",c[30]==null?[0,0]:c[30]),c[37].set("reply_metadata",c[46])):0:0,c[43]=c[20]===""?e:c[20],c[43]!==e?(c[46]=c[25]===""?e:c[25],c[46]!==e?(c[47]=c[26]===""?e:c[26],c[47]!==e?(c[48]=new b.Map(),c[48].set("mention_ids",c[43]),c[48].set("mention_offsets",c[46]),c[48].set("mention_lengths",c[47]),c[48].set("mention_types",c[27]===""?e:c[27]),c[37].set("mention_data",c[48])):0):0):0,c[28]!==e?c[37].set("is_forwarded",c[28]):0,c[44]=c[7]===""?e:c[7],c[44]!==e?c[37].set("platform_ref",c[44]):0,c[45]=c[8]===""?e:c[8],c[45]!==e?c[37].set("platform_token",c[45]):0,[[0,1],[0,2]].some(function(a){return b.i64.eq(c[38],a)})?b.i64.neq(c[29],e)?c[37].set("hot_emoji_size",c[29]):0:0,b.i64.neq(c[12],e)?c[37].set("initiating_source",c[12]):0,c[13]!==e?c[37].set("skip_url_preview_gen",c[13]):0,b.resolve()},function(a){return c[39]=b.createArray(),b.fe(b.db.table(14).fetch([[[c[19]]]]),function(a){a=a.item;return c[46]=(c[39].push(a.contactId),c[39])})},function(a){return c[40]=new b.Map(),c[40].set("participants",c[39]),c[40].set("send_payload",c[37]),b.fe(b.db.table(9).fetch([[[i.threadKey]]]),function(a){var b=a.update;a.item;return b({otidOfFirstMessage:h.offlineThreadingId})})},function(a){return c[41]=b.toJSON(c[40]),a=[c[41],[0,130]],c[33]=a[0],c[34]=a[1],a}]):b.seq([function(a){return c[38]=c[14]==null?[0,1]:c[14],b.db.table(9).fetch([[[c[19]]]]).next().then(function(d,f){var a=d.done;d=d.value;return a?c[35]=[0,1]:(f=d.item,c[45]=f.syncGroup,b.i64.neq(c[45],e)?c[44]=c[45]:c[44]=[0,1],c[35]=c[44])})},function(a){return c[37]=new b.Map(),c[37].set("thread_id",c[19]),c[37].set("otid",c[9]),c[37].set("source",c[15]==null?[0,0]:c[15]),c[37].set("send_type",[0,1]),c[37].set("sync_group",c[35]),b.i64.eq(c[38],[0,1])?b.resolve(c[37].set("text",c[22])):b.i64.eq(c[38],[0,2])?b.resolve(b.i64.neq(c[21],e)?(c[37].set("sticker_id",c[21]),c[37].set("send_type",c[38])):0):b.i64.eq(c[38],[0,7])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[23]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[44]=a[0],c[45]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[44]=a[0],c[45]=a[1],a)})},function(a){return c[44]!==e?b.i64.neq(c[45],e)?(c[37].set("url",c[44]),c[37].set("attribution_app_id",c[45]),c[37].set("send_type",c[38])):0:0}]):b.i64.eq(c[38],[0,3])?b.seq([function(a){return c[37].set("text",c[22]),c[44]=b.createArray(),c[45]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[23]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[46]=a.offlineAttachmentId,c[47]=(c[44].push(b.i64.from_string(a.attachmentFbid)),c[44]),c[46]!==e?c[47]=(c[45].push(c[46]),c[45]):0})},function(a){return c[37].set("attachment_fbids",c[44]),b.i64.eq(c[38],[0,9])?c[37].set("offline_attachment_ids",c[45]):0,c[37].set("send_type",c[38])}]):b.i64.eq(c[38],[0,9])?b.seq([function(a){return c[37].set("text",c[22]),c[44]=b.createArray(),c[45]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[23]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[46]=a.offlineAttachmentId,c[47]=(c[44].push(b.i64.from_string(a.attachmentFbid)),c[44]),c[46]!==e?c[47]=(c[45].push(c[46]),c[45]):0})},function(a){return c[37].set("attachment_fbids",c[44]),b.i64.eq(c[38],[0,9])?c[37].set("offline_attachment_ids",c[45]):0,c[37].set("send_type",c[38])}]):b.i64.eq(c[38],[0,10])?b.seq([function(a){return c[37].set("text",c[22]),c[44]=b.createArray(),c[45]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[23]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[46]=a.offlineAttachmentId,c[47]=(c[44].push(b.i64.from_string(a.attachmentFbid)),c[44]),c[46]!==e?c[47]=(c[45].push(c[46]),c[45]):0})},function(a){return c[37].set("attachment_fbids",c[44]),b.i64.eq(c[38],[0,9])?c[37].set("offline_attachment_ids",c[45]):0,c[37].set("send_type",c[38])}]):b.i64.eq(c[38],[0,4])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[23]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?c[44]=e:(d=b.item,c[44]=d.attachmentFbid)})},function(a){return c[44]!==e?(c[37].set("text",c[22]),c[37].set("forwarded_share_id",c[44]),c[37].set("send_type",c[38])):0}]):b.i64.eq(c[38],[0,5])?b.resolve(c[10]!==e?(c[37].set("forwarded_msg_id",c[10]),c[37].set("send_type",c[38]),b.i64.neq(c[24],e)?c[37].set("forward_score",c[24]):0,c[37].set("strip_forwarded_msg_caption",!1)):0):b.i64.eq(c[38],[0,6])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[23]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[44]=a[0],c[45]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[44]=a[0],c[45]=a[1],a)})},function(a){return c[44]!==e?(c[37].set("url",c[44]),c[37].set("text",c[22]),c[37].set("send_type",c[38])):0}]):b.resolve(0)},function(a){return c[40]=c[6]===""?e:c[6],c[40]!==e?b.i64.neq(c[11],e)?(c[44]=new b.Map(),c[44].set("reply_source_id",c[40]),c[44].set("reply_source_type",c[11]),c[44].set("reply_type",c[30]==null?[0,0]:c[30]),c[37].set("reply_metadata",c[44])):0:0,c[41]=c[20]===""?e:c[20],c[41]!==e?(c[44]=c[25]===""?e:c[25],c[44]!==e?(c[45]=c[26]===""?e:c[26],c[45]!==e?(c[46]=new b.Map(),c[46].set("mention_ids",c[41]),c[46].set("mention_offsets",c[44]),c[46].set("mention_lengths",c[45]),c[46].set("mention_types",c[27]===""?e:c[27]),c[37].set("mention_data",c[46])):0):0):0,c[28]!==e?c[37].set("is_forwarded",c[28]):0,c[42]=c[7]===""?e:c[7],c[42]!==e?c[37].set("platform_ref",c[42]):0,c[43]=c[8]===""?e:c[8],c[43]!==e?c[37].set("platform_token",c[43]):0,[[0,1],[0,2]].some(function(a){return b.i64.eq(c[38],a)})?b.i64.neq(c[29],e)?c[37].set("hot_emoji_size",c[29]):0:0,b.i64.neq(c[12],e)?c[37].set("initiating_source",c[12]):0,c[13]!==e?c[37].set("skip_url_preview_gen",c[13]):0,b.resolve()},function(a){return c[39]=b.toJSON(c[37]),a=[c[39],[0,46]],c[33]=a[0],c[34]=a[1],a}])},function(a){return a=[c[33],c[34]],c[16]=a[0],c[17]=a[1],a}]))})},function(a){return a=[c[16],c[17]],c[3]=a[0],c[4]=a[1],a}]))})},function(a){return a=[c[3],c[4]],c[0]=a[0],c[1]=a[1],a}]))})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSBeginHandlingPendingTasksForQueue",["LSAppendDataTraceAddon","LSFlushDataTrace.nop","LSLogMebClientEvent.nop","LSSerializeBackupPayloadIndirection.nop","LSSyncEpochs","LSTaskSerializerMuteThreadV2","LSTaskSerializerRemoveThread","LSTaskSerializerSendMessageV2","gkx","qex"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(b){return c.ftr(c.db.table(3).fetch([[[a[0]]]]),function(b){return c.i64.neq(b.epochId,f)&&b.taskQueueName===a[0]}).next().then(function(a,b){b=a.done;a=a.value;return b?d[0]=!1:(a.item,d[0]=!0)})},function(e){return d[2]=new c.Map(),d[2].set("queue_name",a[0]),d[2].set("next_sync_ms",f),d[2].set("work_item_type",[0,4]),d[2].set("network_payload",f),d[2].set("http_url_override",f),d[2].set("skip_realtime_gateway",!1),d[3]=d[2],d[0]?c.resolve():c.seq([function(b){return c.islc(c.db.table(2).fetch([[[a[0]]],"queueNameTaskId"]),0,c.i64.to_float([0,1])).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=["",[-1,4294967295],[0,0],[-1,4294967295],f,f],d[4]=c[0],d[5]=c[1],d[6]=c[2],d[7]=c[3],d[8]=c[4],d[9]=c[5],c):(b=a.item,c=[b.queueName,b.minTimeToSyncTimestampMs,b.pluginType,b.failureCount,b.context,b.httpUrlOverride],d[4]=c[0],d[5]=c[1],d[6]=c[2],d[7]=c[3],d[8]=c[4],d[9]=c[5],c)})},function(b){return c.db.table(3).fetch([[[a[0]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[11]=[0,0]:(b=a.item,d[11]=b.lastSyncRequestTimestampMs)})},function(e){return d[14]=c.i64.sub(d[5],c.i64.of_float(Date.now())),c.i64.le(d[14],[0,0])?(c.i64.eq(d[7],[0,0])||a[1]?d[15]=[0,0]:(c.i64.gt(d[7],[0,7])?d[17]=c.i64.sub(d[7],[0,7]):d[17]=d[7],d[18]=c.i64.sub(d[17],[0,1]),d[19]=c.i64.mul(c.i64.lsl_([0,1],c.i64.to_int32(c.i64.lt(d[18],[0,7])?d[18]:[0,7])),[0,500]),d[15]=c.i64.lt(d[19],[0,3e4])?d[19]:[0,3e4]),d[16]=c.i64.sub(c.i64.add(d[11],d[15]),c.i64.of_float(Date.now())),d[13]=c.i64.gt(d[16],[0,0])?d[16]:[0,0]):d[13]=d[14],c.i64.neq(d[13],[0,0])?c.resolve((d[15]=new c.Map(),d[15].set("queue_name",a[0]),d[15].set("next_sync_ms",d[13]),d[15].set("work_item_type",[0,3]),d[15].set("network_payload",f),d[15].set("http_url_override",f),d[15].set("skip_realtime_gateway",!1),d[3]=d[15])):c.seq([function(a){return c.i64.neq(d[6],[0,0])||d[8]==="16"||d[8]==="4"?c.resolve((a=[d[4],f,[0,2],f,f,!1],d[15]=a[0],d[16]=a[1],d[17]=a[2],d[18]=a[3],d[19]=a[4],d[20]=a[5],a)):c.seq([function(a){return d[22]=c.createArray(),d[23]=!0,c.islc(c.db.table(2).fetch([[[d[4]]],"queueNameTaskId"]),0,c.i64.to_float([0,1])).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=["",[-1,4294967295],[0,0],[-1,4294967295],f,f],d[24]=c[0],d[25]=c[1],d[26]=c[2],d[27]=c[3],d[28]=c[4],d[29]=c[5],c):(b=a.item,c=[b.queueName,b.minTimeToSyncTimestampMs,b.pluginType,b.failureCount,b.context,b.httpUrlOverride],d[24]=c[0],d[25]=c[1],d[26]=c[2],d[27]=c[3],d[28]=c[4],d[29]=c[5],c)})},function(a){return c.db.table(2).fetch([[[d[4]]],"queueNameTaskId"]).next().then(function(a,b){b=a.done;a=a.value;return b?d[31]=!0:(a.item,d[31]=!0)})},function(a){return c.fe(c.db.table(2).fetch([[[d[4]]],"queueNameTaskId"]),function(a){var e=a.item;return d[42]=e.taskId,d[40]=e.context,d[43]=e.failureCount,d[41]=e.timeoutTimestampMs,d[23]=e.httpUrlOverride===d[29]&&!0===d[31]&&d[23],d[23]?c.seq([function(a){return d[40]===f?c.seq([function(a){return c.fe(c.db.table(2).fetch([[[d[42]]]]),function(a){return a["delete"]()})},function(a){return d[44]=f}]):c.seq([function(a){return c.i64.neq(d[41],f)?d[49]=c.i64.ge(c.i64.of_float(Date.now()),d[41]):d[49]=!1,d[49]?c.seq([function(a){return c.fe(c.db.table(2).fetch([[[d[42]]]]),function(a){return a["delete"]()})},function(a){return d[50]=f}]):c.seq([function(a){return c.seq([function(a){return d[40]==="46"?c.seq([function(a){return c.sp(b("LSTaskSerializerSendMessageV2"),d[42]).then(function(a){return a=a,d[61]=a[0],d[62]=a[1],a})},function(a){return a=[d[61],c.i64.to_string(d[62]),f],d[55]=a[0],d[56]=a[1],d[57]=a[2],a}]):c.seq([function(a){return d[40]==="144"?c.seq([function(a){return c.sp(b("LSTaskSerializerMuteThreadV2"),d[42]).then(function(a){return a=a,d[64]=a[0],d[65]=a[1],a})},function(a){return a=[d[64],c.i64.to_string(d[65]),f],d[61]=a[0],d[62]=a[1],d[63]=a[2],a}]):c.seq([function(a){return d[40]==="146"?c.seq([function(a){return c.sp(b("LSTaskSerializerRemoveThread"),d[42]).then(function(a){return a=a,d[67]=a[0],d[68]=a[1],a})},function(a){return a=[d[67],c.i64.to_string(d[68]),f],d[64]=a[0],d[65]=a[1],d[66]=a[2],a}]):c.seq([function(a){return d[40]==="32"?c.seq([function(a){return c.seq([function(a){return c.db.table(32).fetch([[[d[42]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[75]=c.createArray(),d[76]=(d[75].push("taskSerializerUpdateThreadName: Task ID not found"),d[75]),d[77]=(d[75].push(d[42]),d[75]),d[78]=c.toJSON(d[75]),function(a){c.logger(a).mustfix(a)}(d[78]),e=[f,f],d[72]=e[0],d[73]=e[1],e):(b=a.item,c.seq([function(a){return d[78]=b.threadKey,c.db.table(9).fetch([[[d[78]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[79]=c.createArray(),d[80]=(d[79].push("taskSerializerUpdateThreadName: Thread not found"),d[79]),d[81]=(d[79].push(d[78]),d[79]),d[82]=c.toJSON(d[79]),function(a){c.logger(a).mustfix(a)}(d[82]),a=[f,f],d[75]=a[0],d[76]=a[1],a):(e=b.item,c.seq([function(a){return c.db.table(9).fetch([[[d[78]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[79]=[0,1]:(e=b.item,d[84]=e.syncGroup,c.i64.neq(d[84],f)?d[83]=d[84]:d[83]=[0,1],d[79]=d[83])})},function(a){return d[81]=new c.Map(),d[81].set("thread_key",d[78]),d[81].set("thread_name",e.threadName==null?"":e.threadName),d[81].set("sync_group",d[79]),d[82]=c.toJSON(d[81]),a=[d[82],[0,32]],d[75]=a[0],d[76]=a[1],a}]))})},function(a){return a=[d[75],d[76]],d[72]=a[0],d[73]=a[1],a}]))})},function(a){return a=[d[72],d[73]],d[70]=a[0],d[71]=a[1],a}])},function(a){return a=[d[70],c.i64.to_string(d[71]),f],d[67]=a[0],d[68]=a[1],d[69]=a[2],a}]):c.seq([function(a){return d[40]==="362"?c.resolve((a=[f,f],d[73]=a[0],d[74]=a[1],a,a=[d[73],c.i64.to_string(d[74]),f],d[70]=a[0],d[71]=a[1],d[72]=a[2],a)):c.seq([function(a){return d[40]==="50015"?c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]Beginning execution."),c.db.table(168).fetch().next().then(function(a,e){var h=a.done;a=a.value;return h?(h=[f,f],d[78]=h[0],d[79]=h[1],h):(e=a.item,c.seq([function(a){return d[83]=e.deviceId,c.i64.neq(d[83],f)?c.seq([function(a){return c.db.table(190).fetch([[[d[42]]]]).next().then(function(e,i){var a=e.done;e=e.value;return a?c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]No restore payload context found."),d[87]=c.createArray(),f!==f?d[88]=(d[87].push(f),d[87]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure","No restore payload context found.",d[87],[0,3])},function(a){return a=[f,f],d[84]=a[0],d[85]=a[1],a}]):(i=e.item,c.seq([function(a){return d[93]=i.traceId,d[93]!==f?c.sp(b("LSAppendDataTraceAddon"),d[93],[0,3603],[0,2],f,f):c.resolve()},function(a){return d[87]=!1,d[87]?d[88]=!0:d[88]=!1,d[88]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),d[94]=c.createArray(),f!==f?d[95]=(d[94].push(f),d[94]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[94],[0,3])):c.resolve()},function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure]Beginning execution."),c.ct(c.ftr(c.db.table(169).fetch(),function(a){return c.i64.eq(a.epochStatus,[0,1])&&c.i64.eq(a.authorityLevel,[0,80])})).then(function(a){return d[94]=a})},function(a){return c.i64.le(d[94],[0,1])?c.seq([function(a){return c.ftr(c.db.table(169).fetch(),function(a){return c.i64.eq(a.epochStatus,[0,1])&&c.i64.eq(a.authorityLevel,[0,80])}).next().then(function(e,i){var a=e.done;e=e.value;return a?c.seq([function(a){return d[99]=function(a){return a==f?f:a}(b("qex")._("1221")),d[99]!==f?d[98]=d[99]:d[98]=!1,d[98]===!1?function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure]Epoch rotation is disabled but open epoch count is not 1. Executing sync"):0,c.sp(b("LSSyncEpochs"))},function(a){return d[96]=f}]):(i=e.item,d[98]=new c.Map(),d[98].set("epoch_id",i.epochId),d[98].set("epoch_root_key",i.epochRootKeyBlob),d[98].set("epoch_anon_id",i.epochAnonIdBlob),d[96]=d[98])})},function(a){return d[95]=d[96]}]):c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsSecureEncryptedBackupsEpochsTable]Error! More than 1 open epoch was found. Calling the sync flow and returning empty results"),d[96]=c.createArray(),f!==f?d[99]=(d[96].push(f),d[96]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsSecureEncryptedBackupsEpochsTable","Error! More than 1 open epoch was found. Calling the sync flow and returning empty results",d[96],[0,3])},function(a){return c.sp(b("LSSyncEpochs"))},function(a){return c.ftr(c.db.table(169).fetch(),function(a){return!1}).next().then(function(e,i){var a=e.done;e=e.value;return a?c.seq([function(a){return d[100]=function(a){return a==f?f:a}(b("qex")._("1221")),d[100]!==f?d[99]=d[100]:d[99]=!1,d[99]===!1?function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure]Epoch rotation is disabled but open epoch count is not 1. Executing sync"):0,c.sp(b("LSSyncEpochs"))},function(a){return d[97]=f}]):(i=e.item,d[99]=new c.Map(),d[99].set("epoch_id",i.epochId),d[99].set("epoch_root_key",i.epochRootKeyBlob),d[99].set("epoch_anon_id",i.epochAnonIdBlob),d[97]=d[99])})},function(a){return d[95]=d[97]}])},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure]Finishing execution."),d[89]=d[95]}])},function(a){return d[89]!==f?(d[94]=d[89].get("epoch_id"),d[89],d[90]=d[94]):d[90]=f,d[91]=new c.Map(),d[91].set("content_type",i.contentType),d[91].set("device_id",d[83]),d[91].set("epoch_id",d[90]),d[91].set("list_id",i.listId),d[91].set("num_items",i.numItems),d[91].set("start_sort_key",i.startSortKey),d[91].set("mailbox_partial_id",i.mailboxPartialId),d[91].set("trace_id",d[93]),d[91].set("message_partial_id",i.messagePartialId),d[91].set("newer_num_items",i.newerNumItems),d[92]=c.toJSON(d[91]),a=[d[92],[0,50015]],d[84]=a[0],d[85]=a[1],a}]))})},function(a){return a=[d[84],d[85]],d[81]=a[0],d[82]=a[1],a}]):c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]Unexpected error: Device ID is null."),d[84]=c.createArray(),f!==f?d[85]=(d[84].push(f),d[84]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure","Unexpected error: Device ID is null.",d[84],[0,3])},function(a){return a=[f,f],d[81]=a[0],d[82]=a[1],a}])},function(a){return a=[d[81],d[82]],d[78]=a[0],d[79]=a[1],a}]))})},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]Finishing execution."),a=[d[78],d[79]],d[76]=a[0],d[77]=a[1],a}])},function(a){return a=[d[76],c.i64.to_string(d[77]),f],d[73]=a[0],d[74]=a[1],d[75]=a[2],a}]):c.seq([function(a){return d[40]==="319"?c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Beginning execution."),c.db.table(177).fetch([[[d[42]]],"fk_pending_tasks"]).next().then(function(a,e){var h=a.done;a=a.value;return h?c.seq([function(a){return c.db.table(2).fetch([[[d[42]]]]).next().then(function(e,i){var a=e.done;e=e.value;return a?c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Task not found."),d[93]=c.createArray(),f!==f?d[94]=(d[93].push(f),d[93]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure","Task not found.",d[93],[0,3])},function(a){return d[90]=f}]):(i=e.item,d[90]=i.dataTraceId)})},function(a){return d[92]="Pending backup context not found",d[92]!==f?c.seq([function(a){return d[96]=["[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]","",d[92]].join(""),function(a){c.logger(a).mustfix(a)}(d[96]),d[93]=c.createArray(),d[90]!==f?d[97]=(d[93].push(d[90]),d[93]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure",d[92],d[93],[0,3])},function(a){return d[90]!==f?c.seq([function(a){return d[90]!==f?c.sp(b("LSAppendDataTraceAddon"),d[90],[0,85],[0,2],d[96],f):c.resolve()},function(a){return d[97]=!1,d[97]?d[98]=!0:d[98]=!1,d[98]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),d[99]=c.createArray(),f!==f?d[100]=(d[99].push(f),d[99]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[99],[0,3])):c.resolve()}]):c.resolve()},function(a){return d[90]!==f?c.nop(b("LSFlushDataTrace.nop"),d[90]):c.resolve()},function(a){return d[94]=!1,d[94]?d[95]=!0:d[95]=!1,d[95]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),d[97]=c.createArray(),f!==f?d[98]=(d[97].push(f),d[97]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[97],[0,3])):c.resolve()}]):c.seq([function(a){return d[90]!==f?c.seq([function(a){return d[90]!==f?c.sp(b("LSAppendDataTraceAddon"),d[90],[0,85],[0,2],["[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]","",""].join(""),f):c.resolve()},function(a){return d[95]=!1,d[95]?d[96]=!0:d[96]=!1,d[96]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),d[97]=c.createArray(),f!==f?d[98]=(d[97].push(f),d[97]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[97],[0,3])):c.resolve()}]):c.resolve()},function(a){return d[90]!==f?c.nop(b("LSFlushDataTrace.nop"),d[90]):c.resolve()},function(a){return d[93]=!1,d[93]?d[94]=!0:d[94]=!1,d[94]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),d[95]=c.createArray(),f!==f?d[96]=(d[95].push(f),d[95]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[95],[0,3])):c.resolve()}])},function(a){return d[81]=f}]):(e=a.item,d[81]=e.lsTraceId)})},function(a){return d[81]!==f?c.sp(b("LSAppendDataTraceAddon"),d[81],[0,1451],[0,2],f,f):c.resolve()},function(a){return d[83]=!1,d[83]?d[84]=!0:d[84]=!1,d[84]?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils]LSDataTraceMciTraceLog native op not supported"),d[90]=c.createArray(),f!==f?d[91]=(d[90].push(f),d[90]):0,c.nop(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[90],[0,3])):c.resolve()},function(a){return d[85]=c.createArray(),d[81]!==f?d[90]=(d[85].push(d[81]),d[85]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure","backup upload serializer started",d[85],[0,4])},function(a){return d[81]!==f?c.resolve(0):(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Trace ID is null"),d[90]=c.createArray(),f!==f?d[91]=(d[90].push(f),d[90]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure","Trace ID is null",d[90],[0,3]))},function(a){return c.db.table(177).fetch([[[d[42]]],"fk_pending_tasks"]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[86]=f:(b=a.item,d[86]=b.echoContent)})},function(a){return d[88]=c.createArray(),d[81]!==f?d[90]=(d[88].push(d[81]),d[88]):0,c.nop(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure","LSSerializeBackupPayloadIndirection op called",d[88],[0,4])},function(a){return c.nop(b("LSSerializeBackupPayloadIndirection.nop"),d[42],d[86],d[81]).then(function(a){return a=a,d[89]=a[0],a})},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Finishing execution."),a=[d[89],[0,319]],d[79]=a[0],d[80]=a[1],a}])},function(a){return a=[d[79],c.i64.to_string(d[80]),f],d[76]=a[0],d[77]=a[1],d[78]=a[2],a}]):c.resolve((d[40]==="700"?(a=[f,[0,700]],d[82]=a[0],d[83]=a[1],a,a=[d[82],c.i64.to_string(d[83]),f],d[79]=a[0],d[80]=a[1],d[81]=a[2],a):(d[40]==="705"?(a=[f,[0,705]],d[85]=a[0],d[86]=a[1],a,a=[d[85],c.i64.to_string(d[86]),f],d[82]=a[0],d[83]=a[1],d[84]=a[2],a):(a=[e.taskValue,d[40],f],d[82]=a[0],d[83]=a[1],d[84]=a[2],a),a=[d[82],d[83],d[84]],d[79]=a[0],d[80]=a[1],d[81]=a[2],a),a=[d[79],d[80],d[81]],d[76]=a[0],d[77]=a[1],d[78]=a[2],a))},function(a){return a=[d[76],d[77],d[78]],d[73]=a[0],d[74]=a[1],d[75]=a[2],a}])},function(a){return a=[d[73],d[74],d[75]],d[70]=a[0],d[71]=a[1],d[72]=a[2],a}])},function(a){return a=[d[70],d[71],d[72]],d[67]=a[0],d[68]=a[1],d[69]=a[2],a}])},function(a){return a=[d[67],d[68],d[69]],d[64]=a[0],d[65]=a[1],d[66]=a[2],a}])},function(a){return a=[d[64],d[65],d[66]],d[61]=a[0],d[62]=a[1],d[63]=a[2],a}])},function(a){return a=[d[61],d[62],d[63]],d[55]=a[0],d[56]=a[1],d[57]=a[2],a}])},function(a){return d[31]?(a=[d[55],d[56],d[57]],d[58]=a[0],d[59]=a[1],d[60]=a[2],a):(a=[f,f],d[61]=a[0],d[62]=a[1],a,a=[d[61],c.i64.to_string(d[62]),f],d[58]=a[0],d[59]=a[1],d[60]=a[2],a),a=[d[58],d[59],d[60]],d[51]=a[0],d[52]=a[1],d[53]=a[2],a}])},function(a){return d[51]!==f?(d[55]=new c.Map(),d[55].set("label",d[52]),d[55].set("payload",d[51]),d[55].set("queue_name",e.queueName),d[55].set("task_id",d[42]),d[55].set("failure_count",c.i64.eq(d[43],[0,0])?f:d[43]),d[54]=d[55]):d[54]=f,d[50]=d[54]}])},function(a){return d[44]=d[50]}])},function(a){return d[44]?d[45]=!1:d[45]=!0,d[45]?0:d[49]=(d[22].push(d[44]),d[22]),d[46]=c.i64.of_int32(d[22].length),b("gkx")("6280")?d[47]=[0,50]:d[47]=[0,5],d[40]!==f?d[48]=["90","130","153"].includes(d[40]):d[48]=!1,d[23]=!(c.i64.ge(d[46],d[47])||d[48])}]):c.resolve()})},function(a){return d[33]=c.i64.of_int32(d[22].length),c.i64.eq(d[33],[0,0])?c.resolve((a=[d[4],f,[0,4],f,f,!1],d[34]=a[0],d[35]=a[1],d[36]=a[2],d[37]=a[3],d[38]=a[4],d[39]=a[5],a)):c.seq([function(a){return d[40]=c.i64.random(),d[50]=c.i64.and_(c.i64.or_(c.i64.lsl_(c.i64.of_float(Date.now()),c.i64.to_int32([0,22])),c.i64.and_(d[40],[0,4194303])),[2147483647,4294967295]),c.db.table(3).fetch([[[d[4],[-1,4294967295]]]]).next().then(function(a,b){b=a.done;a=a.value;return b?c.db.table(3).add({syncDatabaseId:[-1,4294967295],taskQueueName:d[4],failureCount:[0,0],lastSentTimestampMs:[0,0],lastSyncRequestTimestampMs:c.i64.of_float(Date.now()),epochId:d[50]}):(a.item,c.fe(c.db.table(3).fetch([[[d[4],[-1,4294967295]]]]),function(a){var b=a.update;a.item;return b({epochId:d[50],lastSyncRequestTimestampMs:c.i64.of_float(Date.now())})}))})},function(a){return c.islc(c.db.table(2).fetch([[[d[4]]],"queueNameTaskId"]),0,c.i64.to_float([0,1])).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=["",[-1,4294967295],[0,0],[-1,4294967295],f,f],d[42]=c[0],d[43]=c[1],d[44]=c[2],d[45]=c[3],d[46]=c[4],d[47]=c[5],c):(b=a.item,c=[b.queueName,b.minTimeToSyncTimestampMs,b.pluginType,b.failureCount,b.context,b.httpUrlOverride],d[42]=c[0],d[43]=c[1],d[44]=c[2],d[45]=c[3],d[46]=c[4],d[47]=c[5],c)})},function(a){return d[49]=new c.Map(),d[49].set("tasks",d[22]),d[49].set("epoch_id",d[50]),a=[d[4],f,[0,1],d[49],d[47],!(d[47]===f)||c.i64.gt(d[45],[0,7])],d[34]=a[0],d[35]=a[1],d[36]=a[2],d[37]=a[3],d[38]=a[4],d[39]=a[5],a}])},function(a){return a=[d[34],d[35],d[36],d[37],d[38],d[39]],d[15]=a[0],d[16]=a[1],d[17]=a[2],d[18]=a[3],d[19]=a[4],d[20]=a[5],a}])},function(a){return d[21]=new c.Map(),d[21].set("queue_name",d[15]),d[21].set("next_sync_ms",d[16]),d[21].set("work_item_type",d[17]),d[21].set("network_payload",d[18]),d[21].set("http_url_override",d[19]),d[21].set("skip_realtime_gateway",d[20]),d[3]=d[21]}])}])},function(a){return e[0]=d[3]}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSBeginHandlingSyncForSyncGroup",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(1).fetch([[[a[0]]]]).next().then(function(a,d){var f=a.done;a=a.value;return f?c[0]=e:(d=a.item,c[9]=new b.Map(),c[9].set("group_id",d.groupId),c[9].set("current_cursor",d.currentCursor),c[9].set("sync_status",d.syncStatus),c[9].set("sync_params",d.syncParams),c[9].set("send_sync_params",d.sendSyncParams),c[9].set("min_time_to_sync_timestamp_ms",d.minTimeToSyncTimestampMs),c[9].set("can_ignore_timestamp",d.canIgnoreTimestamp),c[9].set("sync_channel",d.syncChannel),c[9].set("last_sync_request_timestamp_ms",d.lastSyncRequestTimestampMs),c[0]=c[9])})},function(d){return c[0]?c[2]=!1:c[2]=!0,c[2]?b.resolve((d=[a[0],e,[0,4],e,!1],c[3]=d[0],c[4]=d[1],c[5]=d[2],c[6]=d[3],c[7]=d[4],d)):b.seq([function(a){return c[9]=c[0].get("group_id"),c[0],b.ftr(b.db.table(3).fetch(),function(a){return b.i64.neq(a.epochId,e)&&b.i64.eq(a.syncDatabaseId,c[9])}).next().then(function(a,b){b=a.done;a=a.value;return b?c[10]=!1:(a.item,c[10]=!0)})},function(d){return c[10]?b.resolve((c[17]=c[0].get("group_id"),c[0],d=[c[17],e,[0,4],e,!1],c[12]=d[0],c[13]=d[1],c[14]=d[2],c[15]=d[3],c[16]=d[4],d)):b.seq([function(d){return c[27]=b.i64.of_float(Date.now()),c[17]=c[0].get("min_time_to_sync_timestamp_ms"),c[0],c[18]=c[0].get("last_sync_request_timestamp_ms"),c[0],c[19]=c[0].get("can_ignore_timestamp"),c[0],c[19]&&a[1]||b.i64.ge(c[27],c[17])?b.seq([function(d){return a[1]?b.resolve(c[28]=[0,0]):b.seq([function(a){return c[29]=c[0].get("group_id"),c[0],b.db.table(3).fetch([[["",c[29]]]]).next().then(function(a,b){var d=a.done;a=a.value;return d?c[30]=[0,0]:(b=a.item,c[30]=b.failureCount)})},function(a){return c[32]=b.i64.mul(b.i64.sub(b.i64.lsl_([0,1],b.i64.to_int32(b.i64.lt([0,15],c[30])?[0,15]:c[30])),[0,1]),[0,500]),c[33]=b.i64.sub(b.i64.add(c[18]==null?[0,0]:c[18],b.i64.lt(c[32],[0,3e4])?c[32]:[0,3e4]),c[27]),c[28]=b.i64.gt(c[33],[0,0])?c[33]:[0,0]}])},function(a){return c[20]=c[28]}]):b.resolve(c[20]=b.i64.sub(c[17],c[27]))},function(a){return c[21]=c[0].get("group_id"),c[0],b.i64.gt(c[20],[0,0])?b.seq([function(a){return b.fe(b.ftr(b.db.table(3).fetch(),function(a){return b.i64.eq(a.syncDatabaseId,c[21])}),function(a){var c=a.update;a.item;return c({lastDelayedRequestTimestampMs:b.i64.of_float(Date.now())})})},function(a){return a=[c[21],c[20],[0,3],e,!1],c[22]=a[0],c[23]=a[1],c[24]=a[2],c[25]=a[3],c[26]=a[4],a}]):b.seq([function(a){return b.fe(b.db.table(1).fetch([[[c[21]]]]),function(a){var c=a.update;a.item;return c({lastSyncRequestTimestampMs:b.i64.of_float(Date.now())})})},function(a){return b.fe(b.ftr(b.db.table(3).fetch(),function(a){return b.i64.eq(a.syncDatabaseId,c[21])}),function(a){var c=a.update;a.item;return c({lastSyncRequestTimestampMs:b.i64.of_float(Date.now())})})},function(a){return c[28]=c[0].get("group_id"),c[0],c[29]=b.i64.random(),c[42]=b.i64.and_(b.i64.or_(b.i64.lsl_(b.i64.of_float(Date.now()),b.i64.to_int32([0,22])),b.i64.and_(c[29],[0,4194303])),[2147483647,4294967295]),b.db.table(3).fetch([[["",c[28]]]]).next().then(function(a,d){d=a.done;a=a.value;return d?b.db.table(3).add({syncDatabaseId:c[28],taskQueueName:"",failureCount:[0,0],lastSentTimestampMs:[0,0],lastSyncRequestTimestampMs:[0,0],epochId:c[42]}):(a.item,b.fe(b.db.table(3).fetch([[["",c[28]]]]),function(a){var b=a.update;a.item;return b({epochId:c[42]})}))})},function(a){return c[31]=c[0].get("group_id"),c[0],b.db.table(3).fetch([[["",c[31]]]]).next().then(function(a,b){var d=a.done;a=a.value;return d?c[32]=[0,0]:(b=a.item,c[32]=b.failureCount)})},function(a){return c[34]=c[0].get("send_sync_params"),c[0],c[35]=c[0].get("sync_params"),c[0],c[36]=c[0].get("current_cursor"),c[0],c[37]=new b.Map(),c[37].set("database",c[31]),c[37].set("version",[-1,4294967295]),c[37].set("epoch_id",c[42]),c[37].set("last_applied_cursor",c[36]),c[37].set("sync_params",c[34]?c[35]:e),c[37].set("failure_count",b.i64.gt(c[32],[0,0])?c[32]:e),c[38]=c[0].get("current_cursor"),c[0],e===c[38]?c[39]=[0,1]:c[39]=[0,2],c[40]=new b.Map(),c[40].set("type",c[39]),c[40].set("request_payload",c[37]),c[41]=c[0].get("sync_channel"),c[0],a=[c[28],e,[0,1],c[40],b.i64.eq(c[41],[0,2])],c[22]=a[0],c[23]=a[1],c[24]=a[2],c[25]=a[3],c[26]=a[4],a}])},function(a){return a=[c[22],c[23],c[24],c[25],c[26]],c[12]=a[0],c[13]=a[1],c[14]=a[2],c[15]=a[3],c[16]=a[4],a}])},function(a){return a=[c[12],c[13],c[14],c[15],c[16]],c[3]=a[0],c[4]=a[1],c[5]=a[2],c[6]=a[3],c[7]=a[4],a}])},function(a){return c[8]=new b.Map(),c[8].set("sync_group_id",c[3]),c[8].set("next_sync_ms",c[4]),c[8].set("work_item_type",c[5]),c[8].set("network_payload",c[6]),c[8].set("skip_realtime_gateway",c[7]),d[0]=c[8]}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSBeginHandlingSync",["LSBeginHandlingSyncForSyncGroup"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[];return c.seq([function(f){return c.seq([function(e){return d[0]=c.createArray(),c.fe(c.db.table(1).fetch(),function(e){var f=e.item;return c.seq([function(e){return c.sp(b("LSBeginHandlingSyncForSyncGroup"),f.groupId,a[0]).then(function(a){return a=a,d[1]=a[0],a})},function(a){return d[2]=(d[0].push(d[1]),d[0])}])})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSHandleTaskSendFailureForQueue",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(d){return b.seq([function(d){return b.islc(b.db.table(2).fetch([[[a[0]]],"queueNameTaskId"]),0,b.i64.to_float([0,1])).next().then(function(a,d){var f=a.done;a=a.value;return f?0:(d=a.item,b.db.table(2).fetch([[[d.taskId]]]).next().then(function(d,f){var a=d.done;d=d.value;return a?0:(f=d.item,b.i64.neq(e,e)?c[1]=b.i64.add(b.i64.of_float(Date.now()),e):c[1]=f.minTimeToSyncTimestampMs,b.fe(b.db.table(2).fetch([[[f.taskId]]]),function(a){var d=a.update;a.item;return d({failureCount:b.i64.add(f.failureCount,[0,1]),minTimeToSyncTimestampMs:c[1]})}))}))})},function(c){return b.fe(b.db.table(3).fetch([[[a[0],[-1,4294967295]]]]),function(a){var c=a.update;a=a.item;return c({failureCount:b.i64.add(a.failureCount,[0,1])})})},function(c){return b.fe(b.db.table(3).fetch([[[a[0],[-1,4294967295]]]]),function(a){var b=a.update;a.item;return b({epochId:e,networkTaskIdentifier:e})})}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSHandleTaskSendSuccessForQueue",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d;return b.seq([function(c){return b.fe(b.ftr(b.db.table(3).fetch([[[a[0],[-1,4294967295]]]]),function(c){return c.taskQueueName===a[0]&&b.i64.eq(c.syncDatabaseId,[-1,4294967295])&&!b.i64.eq(c.epochId,d)}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}e.exports=a}),null);
__d("MAWTTRC.bs",["MAWTTRC"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("MAWTTRC").fail(a)}function b(a){d("MAWTTRC").markEvent(a)}g.fail=a;g.markEvent=b}),98);
__d("LSShape",["LSDict"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return c("LSDict").fromObject(a)}function b(a){return c("LSDict").shapeToRecord(a)}g.ofRecord=a;g.toRecord=b}),98);
__d("LSDataTraceFlushDeferred.bs",["Promise","killswitch","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("LSDataTraceFlush.bs").__setRef("LSDataTraceFlushDeferred.bs");function a(a){if(c("killswitch")("MESSENGER_WEB_DATA_TRACE_ID"))return b("Promise").resolve(function(a){});else return h.load().then(function(b){return b.flushExpiredDataTraces(a)})}g.$LSDataTraceFlush$Deferred=h;g.watchForExpiredTraces=a}),98);
__d("LSPlatformDataTraceCheckPoint",["I64"],(function(a,b,c,d,e,f,g){"use strict";a=d("I64").of_int32(5e4);g.CLIENT_SEND_TASK_PAYLOAD=a}),98);
__d("LSClearEpochBeforeResumeSync.bs",["LSPersistedDbGating","LSTransaction.bs","Promise","ReQL.bs","killswitch"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(!c("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&d("LSPersistedDbGating").allTablesPersisted)return d("LSTransaction.bs").run(a,function(a){return d("ReQL.bs").toArray(d("ReQL.bs").mergeJoin(d("ReQL.bs").fromTableAscending(a.table("sync_groups")),d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("network_requests")),{hd:"",tl:0}))).then(function(c){return b("Promise").all(c.map(function(b){b=b[1];return a.table("network_requests").put({epochId:void 0,failureCount:b.failureCount,lastDelayedRequestTimestampMs:b.lastDelayedRequestTimestampMs,lastSentTimestampMs:b.lastSentTimestampMs,lastSyncRequestTimestampMs:b.lastSyncRequestTimestampMs,networkTaskIdentifier:b.networkTaskIdentifier,syncDatabaseId:b.syncDatabaseId,taskQueueName:b.taskQueueName})}))}).then(function(c){return d("ReQL.bs").toArray(d("ReQL.bs").filter(d("ReQL.bs").fromTableAscending(a.table("network_requests")),function(a){return a.taskQueueName!==""})).then(function(c){return b("Promise").all(c.map(function(b){return a.table("network_requests").put({epochId:void 0,failureCount:b.failureCount,lastDelayedRequestTimestampMs:b.lastDelayedRequestTimestampMs,lastSentTimestampMs:b.lastSentTimestampMs,lastSyncRequestTimestampMs:b.lastSyncRequestTimestampMs,networkTaskIdentifier:b.networkTaskIdentifier,syncDatabaseId:b.syncDatabaseId,taskQueueName:b.taskQueueName})}))})})},"readWrite").then(function(a){return b("Promise").resolve()});else return b("Promise").resolve()}g.call=a}),98);
__d("LSPlatformGraphQLTransport.bs",["FBLogger","LSDynamicDependencies","LSLogHistory","Promise","Promise.bs","bs_belt_Option","bs_caml_exceptions","bs_caml_int64","bs_caml_option","bs_int64"],(function(a,b,c,d,e,f,g){"use strict";var h=c("bs_caml_exceptions").create("LSPlatformGraphQLTransport.ServerError");function a(a,e,f,g,i){return d("Promise.bs").$$catch(i(a,e,g,c("bs_caml_int64").to_int32(f)),function(a){if(a.RE_EXN_ID===d("Promise.bs").JsError){a=a._1;var b=a.message;d("LSLogHistory").log("Error sending Graphql Request. Type: "+c("bs_int64").to_string(f)+" Message: "+(b!==void 0?b:"None"),"error");c("FBLogger")("messenger_web_product").catching(a).debug("Relay or Graphql Server error in LSPlatformGraphqlTransport")}throw{Error:new Error(),RE_EXN_ID:h}}).then(function(e){e=c("bs_belt_Option").getExn(e==null?void 0:c("bs_caml_option").some(e));var a=c("bs_belt_Option").getExn(c("bs_caml_option").nullable_to_opt(e.payload)),f=e.dependencies;f=f==null?b("Promise").resolve():d("LSDynamicDependencies").downloadRelayDependencies(f);return[f,a,c("bs_caml_option").nullable_to_opt(e.experiments)]})}g.ServerError=h;g.publish=a}),98);
__d("LSPlatformHardcodedInitSync.bs",["CurrentUser","LSDatabaseType.bs","LSDict","LSJson","LSPersistedDbGating","LSPlatformGraphQLTransport.bs","LSPlatformLsInitLog","LSRequestType.bs","LSTransaction.bs","MAWTTRC.bs","MWPBumpEntityKey","Promise","Promise.bs","QuickPerformanceLogger","ReQL.bs","bs_belt_Option","bs_caml_format","bs_caml_int64","bs_caml_option","bs_curry","bs_js_dict","cr:4194","cr:4654","justknobx","qpl","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=b("bs_caml_int64").zero;c=b("cr:4654")==null?void 0:b("bs_caml_option").some(b("cr:4654"));var h=b("cr:4654")==null?!1:b("bs_curry")._1(b("cr:4654").isArmadillo)&&b("bs_curry")._1(b("cr:4654").isOccamadillo),i=b("bs_belt_Option").mapWithDefault(c,!1,function(a){return b("bs_curry")._1(a.isArmadillo)});function j(a){return b("LSTransaction.bs").run(a,function(a){var c;return b("Promise").all([a.table("network_requests").put({epochId:void 0,failureCount:(c=b("bs_caml_int64")).zero,lastDelayedRequestTimestampMs:void 0,lastSentTimestampMs:c.zero,lastSyncRequestTimestampMs:c.zero,networkTaskIdentifier:void 0,syncDatabaseId:b("LSDatabaseType.bs").mailbox,taskQueueName:""}),a.table("network_requests").put({epochId:void 0,failureCount:c.zero,lastDelayedRequestTimestampMs:void 0,lastSentTimestampMs:c.zero,lastSyncRequestTimestampMs:c.zero,networkTaskIdentifier:void 0,syncDatabaseId:b("LSDatabaseType.bs").contact,taskQueueName:""}),h?a.table("network_requests").put({epochId:void 0,failureCount:b("bs_caml_int64").zero,lastDelayedRequestTimestampMs:void 0,lastSentTimestampMs:b("bs_caml_int64").zero,lastSyncRequestTimestampMs:b("bs_caml_int64").zero,networkTaskIdentifier:void 0,syncDatabaseId:b("LSDatabaseType.bs").e2eeMessagingMetadataMailbox,taskQueueName:""}):b("Promise").resolve()])},"readWrite").then(function(a){return b("Promise").resolve()})}function k(a){return b("LSTransaction.bs").run(a,function(a){var c;return b("Promise").all([(c=b("ReQL.bs")).first(c.getKeyRange(c.fromTableAscending(a.table("network_requests")),{hd:"",tl:{hd:b("LSDatabaseType.bs").mailbox,tl:0}})),c.first(c.getKeyRange(c.fromTableAscending(a.table("network_requests")),{hd:"",tl:{hd:b("LSDatabaseType.bs").contact,tl:0}})),h?b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("network_requests")),{hd:"",tl:{hd:b("LSDatabaseType.bs").e2eeMessagingMetadataMailbox,tl:0}})):b("Promise").resolve()]).then(function(c){var d=c[2],e=c[1];c=c[0];c=c!==void 0&&e!==void 0?b("Promise").all([a.table("network_requests").put({epochId:g,failureCount:c.failureCount,lastDelayedRequestTimestampMs:c.lastDelayedRequestTimestampMs,lastSentTimestampMs:c.lastSentTimestampMs,lastSyncRequestTimestampMs:c.lastSyncRequestTimestampMs,networkTaskIdentifier:c.networkTaskIdentifier,syncDatabaseId:c.syncDatabaseId,taskQueueName:c.taskQueueName}),a.table("network_requests").put({epochId:g,failureCount:e.failureCount,lastDelayedRequestTimestampMs:e.lastDelayedRequestTimestampMs,lastSentTimestampMs:e.lastSentTimestampMs,lastSyncRequestTimestampMs:e.lastSyncRequestTimestampMs,networkTaskIdentifier:e.networkTaskIdentifier,syncDatabaseId:e.syncDatabaseId,taskQueueName:e.taskQueueName})]).then(function(a){}):b("Promise").resolve();e=h&&d!==void 0?a.table("network_requests").put({epochId:g,failureCount:d.failureCount,lastDelayedRequestTimestampMs:d.lastDelayedRequestTimestampMs,lastSentTimestampMs:d.lastSentTimestampMs,lastSyncRequestTimestampMs:d.lastSyncRequestTimestampMs,networkTaskIdentifier:d.networkTaskIdentifier,syncDatabaseId:d.syncDatabaseId,taskQueueName:d.taskQueueName}):b("Promise").resolve();return b("Promise").all([c,e]).then(function(a){})})},"readWrite")}function l(a){if(b("LSPersistedDbGating").allTablesPersisted&&b("justknobx")._("207"))return a.runInTransaction(function(a){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("network_requests")),{hd:"",tl:{hd:b("LSDatabaseType.bs").mailbox,tl:0}})).then(function(c){if(c!==void 0)return a.table("network_requests").put({epochId:void 0,failureCount:c.failureCount,lastDelayedRequestTimestampMs:c.lastDelayedRequestTimestampMs,lastSentTimestampMs:c.lastSentTimestampMs,lastSyncRequestTimestampMs:c.lastSyncRequestTimestampMs,networkTaskIdentifier:c.networkTaskIdentifier,syncDatabaseId:c.syncDatabaseId,taskQueueName:c.taskQueueName});else return b("Promise").resolve()})},"readwrite","ui");else return b("Promise").resolve()}function a(a,c,d,e){var f=b("CurrentUser").isWorkUser();return k(d).then(function(k){return b("Promise.bs").$$catch(b("Promise").all([(k=b("ReQL.bs")).first(k.getKeyRange(k.fromTableAscending(d.table("sync_groups")),{hd:b("LSDatabaseType.bs").mailbox,tl:0})),k.first(k.getKeyRange(k.fromTableAscending(d.table("sync_groups")),{hd:b("LSDatabaseType.bs").contact,tl:0})),h?b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(d.table("sync_groups")),{hd:b("LSDatabaseType.bs").e2eeMessagingMetadataMailbox,tl:0})):b("Promise").resolve()]).then(function(i){var j,k=(j=b("bs_belt_Option")).mapWithDefault(i[0],void 0,function(a){return a.currentCursor}),m=j.mapWithDefault(i[1],void 0,function(a){return a.currentCursor});i=j.mapWithDefault(i[2],void 0,function(a){return a.currentCursor});var n=new(b("LSDict"))().set("database",b("LSDatabaseType.bs").mailbox).set("epoch_id",g).set("last_applied_cursor",k).set("sync_params",j.getExn(b("bs_js_dict").get(a.syncParams,"mailbox"))).set("version",b("bs_caml_format").caml_int64_of_string(a.schemaVersion));j=new(b("LSDict"))().set("database",b("LSDatabaseType.bs").contact).set("epoch_id",g).set("last_applied_cursor",m).set("sync_params",j.getExn(b("bs_js_dict").get(a.syncParams,"contact"))).set("version",b("bs_caml_format").caml_int64_of_string(a.schemaVersion));var o=b("bs_js_dict").get(a.syncParams,"e2ee");o=new(b("LSDict"))().set("database",b("LSDatabaseType.bs").e2eeMessagingMetadataMailbox).set("epoch_id",g).set("last_applied_cursor",i).set("sync_params",o!==void 0?o:"{}").set("version",b("bs_caml_format").caml_int64_of_string(a.schemaVersion));f&&(b("QuickPerformanceLogger").markerPoint(b("qpl")._(1036588047,"310"),"start_mailbox"),b("QuickPerformanceLogger").markerPoint(b("qpl")._(1036588047,"310"),"start_contact"));b("LSPlatformLsInitLog").addPoint("ls_sync_starts",{string:{contactsSync:b("bs_belt_Option").isSome(m)?"resume":"init",mailboxSync:b("bs_belt_Option").isSome(k)?"resume":"init"}});return b("Promise").all([b("LSPlatformGraphQLTransport.bs").publish(e,0,b("bs_belt_Option").isSome(k)?b("LSRequestType.bs").resumeSync:b("LSRequestType.bs").initSync,b("LSJson").stringify(n),a.executeGraphQLLightSpeedRequest).then(function(a){f&&b("QuickPerformanceLogger").markerPoint(b("qpl")._(1036588047,"310"),"mailbox_synced");return b("Promise").resolve([a[0],a[1],a[2]])}),b("LSPlatformGraphQLTransport.bs").publish(e,1,b("bs_belt_Option").isSome(m)?b("LSRequestType.bs").resumeSync:b("LSRequestType.bs").initSync,b("LSJson").stringify(j),a.executeGraphQLLightSpeedRequest).then(function(a){f&&b("QuickPerformanceLogger").markerPoint(b("qpl")._(1036588047,"310"),"contact_synced");return b("Promise").resolve([a[0],a[1],a[2]])}),h?b("LSPlatformGraphQLTransport.bs").publish(e,2,b("bs_belt_Option").isSome(i)?b("LSRequestType.bs").resumeSync:b("LSRequestType.bs").initSync,b("LSJson").stringify(o),a.executeGraphQLLightSpeedRequest):b("Promise").resolve([b("Promise").resolve(),"",void 0])]).then(function(a){var d=a[2],e=d[2],f=d[1],g=a[1],i=g[2],j=g[1];a=a[0];var k=a[2],l=a[1];b("LSPlatformLsInitLog").addPoint("gql_payload_received");h&&b("LSPlatformLsInitLog").addPointForEvent(b("qpl")._(25310776,"6155"),"gql_payload_received");return b("Promise").all([a[0],g[0],d[0]]).then(function(a){b("LSPlatformLsInitLog").addPoint("gql_deps_downloaded");h&&b("LSPlatformLsInitLog").addPointForEvent(b("qpl")._(25310776,"6155"),"gql_deps_downloaded");return b("bs_curry")._1(c,{experiments:k,syncScript:l})}).then(function(a){return b("bs_curry")._1(c,{experiments:i,syncScript:j})}).then(function(a){if(!h)return b("Promise").resolve();a=f.split("updateOrInsertThread").length-1|0;b("cr:4194")==null||b("bs_curry")._1(b("cr:4194").initSync,a);return b("bs_curry")._1(c,{experiments:e,syncScript:f})})}).then(function(a){if(k!==void 0)return l(d);else return b("Promise").resolve()})}).then(function(a){f&&b("QuickPerformanceLogger").markerPoint(b("qpl")._(1036588047,"310"),"sync_completed"),i&&b("MAWTTRC.bs").markEvent("ls_init_end"),h&&b("LSPlatformLsInitLog").addPointForEvent(b("qpl")._(25310776,"6155"),"success_with_init_sync"),b("LSPlatformLsInitLog").addPoint("success_with_init_sync"),b("LSPlatformLsInitLog").endSuccess(),b("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw_graphql","init_sync.success"),b("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw_ls","init_sync.success")}),function(a){b("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw_ls","init_sync.fail");f&&b("QuickPerformanceLogger").markerPoint(b("qpl")._(1036588047,"310"),"sync_failed");b("LSPlatformLsInitLog").fail("failure_during_init_sync");b("LSPlatformLsInitLog").failEvent(b("qpl")._(25310776,"6155"),"failure_during_init_sync");b("MAWTTRC.bs").fail("ls_init_fail");a.RE_EXN_ID===b("LSPlatformGraphQLTransport.bs").ServerError||a.RE_EXN_ID!==b("Promise.bs").JsError||b("recoverableViolation")("Encountered an error while performining preloaded init sync request via graphql","messenger_web_product",{error:b("bs_caml_option").some(a._1)});return j(d)})})}d={epochId:void 0,failureCount:b("bs_caml_int64").zero,lastDelayedRequestTimestampMs:void 0,lastSentTimestampMs:b("bs_caml_int64").zero,lastSyncRequestTimestampMs:b("bs_caml_int64").zero,networkTaskIdentifier:void 0,syncDatabaseId:b("bs_caml_int64").zero,taskQueueName:""};f.defaultNetworkRequest=d;f.initialEpochId=g;f.$MAWGating$requireCondXplat=b("cr:4654");f.mawGating=c;f.isArmadilloAndOccamadillo=h;f.isArmadillo=i;f.handlePreloadedSyncFailure=j;f.setEpochId=k;f.clearEpochForMailbox=l;f.$MAWCommonSetup$requireCondXplat=b("cr:4194");f.sendHardcodedInitSync=a}),null);
__d("LSPlatformRequestId",[],(function(a,b,c,d,e,f){"use strict";var g=4;function a(){var a=g;g+=1;return a}b={generate:a};f["default"]=b}),66);
__d("LSPlatformRequestScheduler",["clearTimeout","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.requests=new Map()}var b=a.prototype;b.schedule=function(a,b,d){var e=this.requests.get(b);e!=null&&c("clearTimeout")(e);this.requests.set(b,c("setTimeout")(a,d))};b.cleanup=function(){this.requests.forEach(function(a){return c("clearTimeout")(a)})};return a}();g["default"]=a}),98);
__d("LSTaskWorkItemType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];d=[0,3];e=[0,4];b=[0,5];f.workItemTypeSendToServer=a;f.workItemTypeHandleNative=c;f.workItemTypeDelayHandling=d;f.workItemTypeNone=e;f.workItemTypeSendToServerFireAndForget=b}),null);
__d("LSPlatformSyncSystem.bs",["FBLogger","LS.bs","LSBeginHandlingSync","LSBeginHandlingSyncForSyncGroup","LSCookie.bs","LSDict","LSJson","LSLogHistory","LSPersistedDbGating","LSPlatformGraphQLTransport.bs","LSPlatformRealtimeTransport.bs","LSPlatformRequestId","LSPlatformRequestScheduler","LSSyncChannel.bs","LSTaskWorkItemType.bs","LSTransaction.bs","MWPBumpEntityKey","Promise","Promise.bs","ReQL.bs","SortedAsyncIterable.bs","bs_belt_Option","bs_caml","bs_caml_format","bs_caml_int64","bs_caml_obj","bs_caml_option","bs_curry","bs_int64","bs_js_dict","gkx","killswitch","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a,e,f,g,h,i){var j=function(a,e){return d("LSTransaction.bs").run(a,function(a){return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("network_requests")),{hd:"",tl:{hd:e,tl:0}})).then(function(d){if(d!==void 0)return a.table("network_requests").put({epochId:void 0,failureCount:c("bs_caml_int64").add(d.failureCount,c("bs_caml_int64").one),lastDelayedRequestTimestampMs:d.lastDelayedRequestTimestampMs,lastSentTimestampMs:d.lastSentTimestampMs,lastSyncRequestTimestampMs:d.lastSyncRequestTimestampMs,networkTaskIdentifier:d.networkTaskIdentifier,syncDatabaseId:d.syncDatabaseId,taskQueueName:d.taskQueueName});else return b("Promise").resolve()})},"readWrite")},k=new(c("LSPlatformRequestScheduler"))(),l=function(a,j,k){k=c("LSDict").shapeToRecord(k);var l=c("LSDict").shapeToRecord(k.request_payload),m=k.type,n=c("LSPlatformRequestId").generate(),o=d("LSJson").stringify(c("LSDict").fromObject({database:l.database,epoch_id:l.epoch_id,failure_count:l.failure_count,last_applied_cursor:l.last_applied_cursor,sync_params:l.sync_params,version:c("bs_caml_format").caml_int64_of_string(g)}));if(j.skip_realtime_gateway)return d("LSPlatformGraphQLTransport.bs").publish(h,n,m,o,i).then(function(a){return f({experiments:a[2],syncScript:a[1]})});else return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("sync_groups")),{hd:j.sync_group_id,tl:0})).then(function(a){a=a!==void 0?a.syncChannel:d("LSSyncChannel.bs").mqtt;return c("bs_curry")._5(e.publish,a,void 0,n,m,o).then(function(a){return b("Promise").resolve()})})},m=function a(e,f){var g=function(b){return d("LSTransaction.bs").run(e,function(a){return c("LSBeginHandlingSyncForSyncGroup")(b,!1,d("LS.bs").make(a))},"readWrite").then(function(b){return a(e,b[0])})},h=function(a,b){k.schedule(function(){c("promiseDone")(g(a))},c("bs_int64").to_string(a),c("bs_caml_int64").to_float(b))},i=c("LSDict").shapeToRecord(f);f=i.work_item_type;if(c("bs_caml").i64_eq(f,d("LSTaskWorkItemType.bs").workItemTypeSendToServer)||c("bs_caml").i64_eq(f,d("LSTaskWorkItemType.bs").workItemTypeSendToServerFireAndForget)){var m=i.network_payload;if(m!==void 0)return l(e,i,c("bs_caml_option").valFromOption(m))["catch"](function(a){a.RE_EXN_ID===d("LSPlatformGraphQLTransport.bs").ServerError?d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_graphql_error"):a.RE_EXN_ID===d("Promise.bs").JsError?(d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_js_error"),c("recoverableViolation")("Encountered an JS error while publishing a LS sync request","messenger_web_product",{error:c("bs_caml_option").some(a._1)})):a.RE_EXN_ID===d("LSPlatformRealtimeTransport.bs").Timeout||a.RE_EXN_ID===d("LSPlatformRealtimeTransport.bs").NotConnected?(d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_timeout_or_disc"),d("LSLogHistory").log("Publish timed out","warn")):(d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_other_error"),c("FBLogger")("messenger_web_product").catching(a).mustfix("Encountered an JS error while publishing a LS sync request"));return j(e,i.sync_group_id).then(function(){return g(i.sync_group_id)})});else{c("recoverableViolation")("Expected networkpayload for sync request but didn't get any","messenger_web_product");return b("Promise").resolve()}}if(!c("bs_caml").i64_eq(f,d("LSTaskWorkItemType.bs").workItemTypeDelayHandling))if(c("bs_caml").i64_eq(f,d("LSTaskWorkItemType.bs").workItemTypeNone)||!c("bs_caml").i64_eq(f,d("LSTaskWorkItemType.bs").workItemTypeHandleNative))return b("Promise").resolve();else{c("recoverableViolation")("Native handling for sync group not implemented yet","messenger_web_product");return b("Promise").resolve()}m=i.next_sync_ms;if(m!==void 0){h(i.sync_group_id,m);return b("Promise").resolve()}else{c("recoverableViolation")("Expected delay for delayed sync request but didn't get any","messenger_web_product");return b("Promise").resolve()}},n=function(c){return b("Promise").all(c[0].map(function(b){return m(a,b)}))},o=function(){c("promiseDone")(d("LSTransaction.bs").run(a,function(a){return c("LSBeginHandlingSync")(!1,d("LS.bs").make(a))},"readWrite").then(n))},p=function(){return d("SortedAsyncIterable.bs").subscribe(d("ReQL.bs").fromTableAscending(a.table("sync_groups")),function(a,b){return o()})},q=function(){return e.subscribeToNonTaskResponses(function(a,b){a=b.ex;b=b.payload;a={experiments:a,syncScript:b};c("promiseDone")(f(a),function(){return o()},function(a){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","handle_sync_response_failure"),c("FBLogger")("messenger_web_product").catching(a.RE_EXN_ID===d("Promise.bs").JsError?c("bs_caml_option").some(a._1):a).mustfix("JS error encountered handling response from MQTT (pdb=%s): %s",c("gkx")("6543"),a.message)})})},r=function(a){var b=d("SortedAsyncIterable.bs").subscribe(d("ReQL.bs").fromTableAscending(a.table("sync_groups")),function(a,b){a=a.hd;var e=d("LSCookie.bs").get(),f=e.c,g=0,h;switch(b.TAG){case 0:var i=b._0.currentCursor;i!==void 0?(h=i,g=2):g=1;break;case 1:i=b._0.currentCursor;i!==void 0?(h=i,g=2):g=1;break;case 2:g=1;break}switch(g){case 1:if(!c("bs_belt_Option").isSome(c("bs_js_dict").get(f,c("bs_int64").to_string(a))))return;c("bs_js_dict").unsafeDeleteKey(f,c("bs_int64").to_string(a));b=d("LSCookie.bs").writeCookie(e);c("promiseDone")(b);return;case 2:if(!c("bs_caml_obj").caml_notequal(c("bs_js_dict").get(f,c("bs_int64").to_string(a)),h))return;f[c("bs_int64").to_string(a)]=h;i=d("LSCookie.bs").writeCookie(e);c("promiseDone")(i);return}});return function(a){return c("bs_curry")._1(b)}},s=function(){return e.onReconnect(function(){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","resume_sync_reconnect"),d("LSLogHistory").log("LS Sync System reconnecting","debug"),c("promiseDone")(d("LSTransaction.bs").run(a,function(a){return d("ReQL.bs").toArray(d("ReQL.bs").mergeJoin(d("ReQL.bs").fromTableAscending(a.table("sync_groups")),d("ReQL.bs").getKeyRange(d("ReQL.bs").fromTableAscending(a.table("network_requests")),{hd:"",tl:0}))).then(function(c){return b("Promise").all(c.map(function(b){b=b[1];return a.table("network_requests").put({epochId:void 0,failureCount:b.failureCount,lastDelayedRequestTimestampMs:b.lastDelayedRequestTimestampMs,lastSentTimestampMs:b.lastSentTimestampMs,lastSyncRequestTimestampMs:b.lastSyncRequestTimestampMs,networkTaskIdentifier:b.networkTaskIdentifier,syncDatabaseId:b.syncDatabaseId,taskQueueName:b.taskQueueName})}))}).then(function(b){return c("LSBeginHandlingSync")(!1,d("LS.bs").make(a))})},"readWrite").then(n))})},t=p(),u=q(),v=s();o();var w=!c("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&d("LSPersistedDbGating").allTablesPersisted?r(a):function(){};return{cleanup:function(){t(),v(),u(),w()}}}g.make=a}),98);
__d("LSPlatformTraceTasks",["LS.re","LSGenerateTraceId","LSPredefineTraceForTask","gkx","justknobx","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set();c("gkx")("4729")&&h.add("207");function a(a,e){var f,g,i,j;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:if(!c("justknobx")._("506")){k.next=12;break}f=0;case 2:if(!(f<e.length)){k.next=12;break}g=e[f];if(!((g.dataTraceId==null||g.dataTraceId==="")&&h.has(g.context))){k.next=9;break}i=c("LSGenerateTraceId")();if(!(i!=null)){k.next=9;break}k.next=9;return b("regeneratorRuntime").awrap(c("LSPredefineTraceForTask")(i,g.taskId,(j=g.context)!=null?j:"","",d("LS.re").make(a)));case 9:f++;k.next=2;break;case 12:case"end":return k.stop()}},null,this)}e={startTraceForTaskIfEligible:a};g["default"]=e}),98);
__d("LSPlatformTaskUtils",["FBLogger","I64","JSScheduler","LS.re","LSBeginHandlingFireForgetTasksForQueue","LSBeginHandlingPendingTasksForQueue","LSPlatformTraceTasks","LSShape","Promise","ReQL","justknobx","promiseDone","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,e,f){function g(){var g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.prev=0;i.next=3;return b("regeneratorRuntime").awrap(a.runInTransaction(function(a){return c("LSBeginHandlingPendingTasksForQueue")(f.queueName,!1,c("LS.re").make(a))},"readwrite","background"));case 3:g=i.sent;h=g[0];e(d("LSShape").toRecord(h));i.next=11;break;case 8:i.prev=8,i.t0=i["catch"](0),c("FBLogger")("messenger_web_product").catching(i.t0).warn("Failed to calculate work for task queue "+f.queueName);case 11:case"end":return i.stop()}},null,this,[[0,8]])}d("I64").gt(f.priority,d("I64").zero)&&c("justknobx")._("425")?c("JSScheduler").scheduleLoggingPriCallback(g):c("promiseDone")(g())}function i(a,e,f){var g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.prev=0;i.next=3;return b("regeneratorRuntime").awrap(a.runInTransaction(function(a){return c("LSBeginHandlingFireForgetTasksForQueue")(f.queueName,c("LS.re").make(a))},"readwrite","background"));case 3:g=i.sent;h=g[0];e(d("LSShape").toRecord(h));i.next=11;break;case 8:i.prev=8,i.t0=i["catch"](0),c("FBLogger")("messenger_web_product").catching(i.t0).warn("Failed to calculate work for fire forget queue "+f.queueName);case 11:case"end":return i.stop()}},null,this,[[0,8]])}function a(a,e){var f=new Set(),g=[],i=[];i.push(a.table("pending_tasks").index("queueNameTaskId").subscribe(function(a,b){var c;if(b.operation==="delete"){f.add(a.hd);return}a=b.operation==="put"&&b.prevValue==null||b.operation==="add";c=b.operation==="put"&&d("I64").compare(b.value.failureCount,(c=(c=b.prevValue)==null?void 0:c.failureCount)!=null?c:d("I64").zero)>0;(a||c)&&f.add(b.value.queueName);(b.operation==="add"&&b.value.dataTraceId==null||b.value.dataTraceId==="")&&g.push(b.value)}));i.push(a.table("network_requests").subscribe(function(a,b){a=a.hd;if(a==="")return;b.operation==="delete"?f.add(a):b.value.epochId==null&&f.add(a)}));i.push(a.subscribeToCommit(function(){var i=Array.from(f),j=g;f.clear();g=[];i.forEach(function(c){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.table("pending_tasks").index("queueNameTaskId")).bounds({gte:{hd:c,tl:0}})));case 2:f=g.sent,f!=null&&h(a,e,f);case 4:case"end":return g.stop()}},null,this)});j.length>0&&c("promiseDone")(a.runInTransaction(function(a){return c("LSPlatformTraceTasks").startTraceForTaskIfEligible(a,j)},"readwrite","background"))}));return i}function e(a,e){c("promiseDone")(function(){var c,f,g,i,j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:m.next=2;return b("regeneratorRuntime").awrap(d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.table("pending_tasks"))));case 2:c=m.sent,f=new Set(),(g=c,i=Array.isArray(g),j=0,g=i?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 5:if(!i){m.next=11;break}if(!(j>=g.length)){m.next=8;break}return m.abrupt("break",22);case 8:k=g[j++];m.next=15;break;case 11:j=g.next();if(!j.done){m.next=14;break}return m.abrupt("break",22);case 14:k=j.value;case 15:l=k;if(!f.has(l.queueName)){m.next=18;break}return m.abrupt("continue",20);case 18:f.add(l.queueName),h(a,e,l);case 20:m.next=5;break;case 22:case"end":return m.stop()}},null,this)}())}function j(a,e){c("promiseDone")(function(){var f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.table("pending_fire_and_forget_tasks"))));case 2:f=g.sent;g.next=5;return b("regeneratorRuntime").awrap(b("Promise").all(f.map(function(b){return i(a,e,b)})));case 5:c("promiseDone")(a.runInTransaction(function(a){return b("Promise").all(f.map(function(b){return a.table("pending_fire_and_forget_tasks")["delete"]({hd:b.taskId,tl:0})}))},"readwrite","background"));case 6:case"end":return g.stop()}},null,this)}())}function f(a,b){var c=!1,d=[];d.push(a.table("pending_fire_and_forget_tasks").subscribe(function(a,b){if(b.operation==="delete")return;a=b.operation==="put"&&b.prevValue==null||b.operation==="add";a&&(c=!0)}));d.push(a.subscribeToCommit(function(){c&&j(a,b),c=!1}));return d}g.checkQueuesWhenPendingTaskTableUpdates=a;g.checkAllPendingTasksForWork=e;g.checkAllFireForgetTasksForWork=j;g.checkQueuesWhenPendingFireForgetTaskTableUpdates=f}),98);
__d("LSPlatformTaskSystem.bs",["FBLogger","LS.bs","LSAppendDataTraceAddon","LSBeginHandlingPendingTasksForQueue","LSDict","LSHandleTaskSendFailureForQueue","LSHandleTaskSendSuccessForQueue","LSJson","LSPlatformDataTraceCheckPoint","LSPlatformRealtimeTransport.bs","LSPlatformRequestId","LSPlatformRequestScheduler","LSPlatformTaskUtils","LSRequestType.bs","LSSyncChannel.bs","LSTaskWorkItemType.bs","LSTransaction.bs","MWPBumpEntityKey","Promise","Promise.bs","ReQL.bs","bs_belt_Array","bs_belt_Option","bs_caml","bs_caml_int64","bs_caml_option","bs_curry","bs_int64","cr:1266","gkx","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=b("cr:1266")==null?void 0:b("bs_caml_option").some(b("cr:1266"));c={};function h(a,c){if(b("gkx")("6551")&&c!=null&&c.dataTraceId!=null&&c.context=="46")try{var d=c.dataTraceId;b("promiseDone")(a.runInTransaction(function(a){return b("LSAppendDataTraceAddon")(d,b("LSPlatformDataTraceCheckPoint").CLIENT_SEND_TASK_PAYLOAD,b("LSSyncChannel.bs").mqtt,void 0,"pdb",b("LS.bs").make(a))},"readwrite"),function(a){},function(a){b("FBLogger")("messenger_web_product").catching(a).warn("AppendTrace rejected in task system")})}catch(a){b("FBLogger")("messenger_web_product").catching(a).warn("Cannot append trace in task system")}}function a(a,c,d,e){var f=new(b("LSPlatformRequestScheduler"))(),i=function(c){c=b("bs_belt_Option").map(c.network_payload,function(a){return b("LSDict").shapeToRecord(a)});if(c!==void 0)return b("bs_belt_Option").mapWithDefault(b("bs_belt_Array").get(c.tasks,0),b("Promise").resolve(),function(c){c=b("LSDict").shapeToRecord(c).task_id;return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("pending_tasks")),{hd:c,tl:0}))});else return b("Promise").resolve()},j=function(c){return b("LSTransaction.bs").run(a,function(a){return b("LSHandleTaskSendFailureForQueue")(c,b("LS.bs").make(a))},"readWrite")},k=function l(k){var m=function(c,d){f.schedule(function(){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return b("LSBeginHandlingPendingTasksForQueue")(c,!1,b("LS.bs").make(a))},"readWrite").then(function(a){return l(b("LSDict").shapeToRecord(a[0]))}))},c,b("bs_caml_int64").to_float(d))},n=b("LSPlatformRequestId").generate(),o=b("bs_belt_Option").map(k.network_payload,function(a){return b("LSDict").shapeToRecord(a)}),p=k.work_item_type;if(o!==void 0){if(b("bs_caml").i64_eq(p,b("LSTaskWorkItemType.bs").workItemTypeSendToServer)){var q=o.epoch_id,r=o.tasks,s=k.queue_name;b("cr:1266")==null||b("bs_curry")._1(g.recordTaskSending,r);return b("Promise.bs").$$catch(i(k).then(function(b){h(a,b);return b}).then(function(a){return c.publish(b("LSSyncChannel.bs").mqtt,s,n,b("LSRequestType.bs").taskBatch,b("LSJson").stringify(b("LSDict").fromObject({data_trace_id:a==null?void 0:a.dataTraceId,epoch_id:q,tasks:r,version_id:e})))}).then(function(c){if(c.TAG===0){var e=c._1;c=e.ex;var f=e.payload;f={syncScript:f};c!=null&&(f=babelHelpers["extends"]({},f,{experiments:c}));return b("Promise.bs").$$catch(d(f).then(function(c){b("cr:1266")==null||b("bs_curry")._2(g.recordTaskSent,r,e.payload);return b("LSTransaction.bs").run(a,function(a){return b("LSHandleTaskSendSuccessForQueue")(s,b("LS.bs").make(a))},"readWrite")}),function(a){b("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","handle_task_failure");a=a.RE_EXN_ID===b("Promise.bs").JsError?a._1:a;b("FBLogger")("messenger_web_product").catching(a).mustfix("Encountered an error while processing a task response via realtime transport");return j(s)})}b("recoverableViolation")("Expected a response for a non fire forget task","messenger_web_product");return b("Promise").resolve()}),function(a){if(a.RE_EXN_ID===b("LSPlatformRealtimeTransport.bs").Timeout)b("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_timeout");else if(a.RE_EXN_ID!==b("LSPlatformRealtimeTransport.bs").NotConnected){b("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_generic");a=a.RE_EXN_ID===b("Promise.bs").JsError?a._1:a;b("FBLogger")("messenger_web_product").catching(a).mustfix("Encountered an error while publishing a LS task payload via realtime transport")}return j(s)})}if(b("bs_caml").i64_eq(p,b("LSTaskWorkItemType.bs").workItemTypeSendToServerFireAndForget))return b("Promise.bs").$$catch(b("Promise").all(o.tasks.map(function(a){return b("LSDict").shapeToRecord(a)}).map(function(a){return b("bs_curry")._5(c.publish,b("LSSyncChannel.bs").mqtt,void 0,n,b("LSRequestType.bs").fireForget,b("LSJson").stringify(b("LSDict").fromObject({label:a.label,payload:a.payload,version:e})))})).then(function(a){return b("Promise").resolve()}),function(a){return b("Promise").resolve()})}if(b("bs_caml").i64_eq(p,b("LSTaskWorkItemType.bs").workItemTypeDelayHandling)){m(k.queue_name,k.next_sync_ms);return b("Promise").resolve()}else if(b("bs_caml").i64_eq(p,b("LSTaskWorkItemType.bs").workItemTypeNone))return b("Promise").resolve();else if(b("bs_caml").i64_eq(p,b("LSTaskWorkItemType.bs").workItemTypeHandleNative)){b("recoverableViolation")("Native tasks not supported so far","messenger_web_product");return b("Promise").resolve()}else{b("recoverableViolation")("Unknown Task type of "+b("bs_int64").to_string(p),"messenger_web_product");return b("Promise").resolve()}},l=function(c){b("LSPlatformTaskUtils").checkAllPendingTasksForWork(a,k);return b("LSPlatformTaskUtils").checkAllPendingTasksForWork(a,k)},m=function(){return c.onReconnect(function(){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return b("ReQL.bs").toArray(b("ReQL.bs").bounds(b("ReQL.bs").fromTableAscending(a.table("network_requests")),{NAME:"greaterThan",VAL:{hd:"",tl:0}})).then(function(c){return b("Promise").all(c.map(function(c){return b("LSHandleTaskSendFailureForQueue")(c.taskQueueName,b("LS.bs").make(a))}))})},"readWrite"));return l()})},n=b("LSPlatformTaskUtils").checkQueuesWhenPendingTaskTableUpdates(a,k),o=b("LSPlatformTaskUtils").checkQueuesWhenPendingFireForgetTaskTableUpdates(a,k),p=m();l();return{cleanup:function(){n.forEach(function(a){return a()});o.forEach(function(a){return a()});return b("bs_curry")._1(p)}}}f.$LSPlatformDevtools$OR$null$requireCond=b("cr:1266");f.LSPlatformTaskUtils=c;f.make=a}),null);
__d("LSPlatformClient.bs",["ExecutionEnvironment","LSClearEpochBeforeResumeSync.bs","LSDataTraceFlushDeferred.bs","LSDatabaseProviderType","LSJSInMemoryStorage.bs","LSMetadata","LSPlatformDeviceId","LSPlatformHardcodedInitSync.bs","LSPlatformLsInitLog","LSPlatformRealtimeTransport.bs","LSPlatformSyncSystem.bs","LSPlatformTaskSystem.bs","Promise","bs_curry","cr:1266","cr:4153","cr:4160","cr:4654","cr:4783","gkx","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h=null;b("cr:4160")!==null&&(h=b("cr:4160").make());function a(a){var e={contents:{_0:void 0,TAG:0}};if(c("ExecutionEnvironment").canUseDOM)return a.getDb().then(function(f){return a.getEval().then(function(g){var i=d("LSDatabaseProviderType").getProviderType(),j=d("LSPlatformDeviceId").getDeviceIdForProviderType(i);b("cr:1266")!==null&&b("cr:1266").registerDb(f);if(c("gkx")("6551")){h!=null&&c("promiseDone")(h.then(function(a){a.isTabWithoutClient()===!0&&(b("cr:4783")!=null&&(b("cr:4783").markEvent("ls_init_end"),b("cr:4783").markEvent("maw_init_end"),b("cr:4783").markEvent("maw_init_skipped")),d("LSPlatformLsInitLog").addPoint("no_ls_sync"),d("LSPlatformLsInitLog").endSuccess())}));return b("Promise").resolve({cleanup:function(a){},db:f,onConnectionStatusChange:function(a){return function(a){}},start:function(a){return b("Promise").resolve()}})}var k;try{k=b("cr:1266")!=null?b("cr:1266").registerEval(g)()(f):g()(f)}catch(a){c("recoverableViolation")("fail to register datascriptEvaluator","messenger_web_product",{error:a}),k=g()(f)}return d("LSClearEpochBeforeResumeSync.bs").call(f).then(function(c){if(a.sendHardcodedInitSync)return d("LSPlatformHardcodedInitSync.bs").sendHardcodedInitSync(a,k,f,j);else return b("Promise").resolve()}).then(function(g){g=function(c){c=e.contents;switch(c.TAG){case 1:return b("Promise").resolve();case 0:case 2:break}c=e.contents;var g;switch(c.TAG){case 0:case 1:g=!1;break;case 2:g=!0;break}c=g?d("LSClearEpochBeforeResumeSync.bs").call(f):b("Promise").resolve();return c.then(function(b){var c=d("LSPlatformRealtimeTransport.bs").make(a.realtimeUnderylingTransport,a.appId,j),g=d("LSPlatformTaskSystem.bs").make(f,c,k,a.schemaVersion),h=d("LSPlatformSyncSystem.bs").make(f,c,k,a.schemaVersion,j,a.executeGraphQLLightSpeedRequest);b=function(a){g.cleanup(),h.cleanup(),c.cleanup(),e.contents={_0:void 0,TAG:2}};e.contents={_0:b,_1:c.onConnectionStatusChange,TAG:1}})};c("promiseDone")(d("LSDataTraceFlushDeferred.bs").watchForExpiredTraces(f));b("cr:4654")!==null&&b("cr:4654").isLabyrinthOnWebEnabled()&&b("cr:4153")!=null&&b("cr:4153").listenForChangesToBackupState(f);return b("Promise").resolve({cleanup:function(a){a=e.contents;switch(a.TAG){case 1:return c("bs_curry")._1(a._0);case 0:case 2:return}},db:f,onConnectionStatusChange:function(a){var b=e.contents;switch(b.TAG){case 1:return b._1(a);case 0:case 2:break}return function(a){}},start:g})})})});else return b("Promise").resolve({cleanup:function(a){},db:d("LSJSInMemoryStorage.bs").make(d("LSMetadata").metadata),onConnectionStatusChange:function(a){return function(a){}},start:function(a){return b("Promise").resolve()}})}e=a;g.make=e}),98);/*FB_PKG_DELIM*/
__d("LSVerifyE2EEMetadataThreadExistsV2",["LSCreateOfflineThreadingID","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(b){return c.i64.neq(a[1],f)?c.seq([function(b){return c.db.table(9).fetch([[[a[1]]]]).next().then(function(b,c){var e=b.done;b=b.value;return e?(e=[f,f],d[3]=e[0],d[4]=e[1],e):(c=b.item,e=[a[1],c.authorityLevel],d[3]=e[0],d[4]=e[1],e)})},function(a){return a=[d[3],d[4]],d[0]=a[0],d[1]=a[1],a}]):c.resolve((b=[f,f],d[0]=b[0],d[1]=b[1],b))},function(e){return c.i64.neq(d[0],f)?c.seq([function(e){return c.i64.neq(d[1],f)?c.i64.gt(a[2],d[1])?c.seq([function(b){return c.fe(c.db.table(9).fetch([[[d[0]]]]),function(b){var c=b.update;b.item;return c({authorityLevel:a[2]})})},function(a){return d[3]=new c.Map(),d[3].set("thread_fbid",d[0]),d[3].set("force_upsert",!1),d[3].set("use_open_messenger_transport",!1),d[3].set("sync_group",[0,95]),d[3].set("metadata_only",!1),d[4]=d[3].get("thread_fbid"),d[3],d[5]=c.toJSON(d[3]),c.sp(b("LSIssueNewTask"),c.i64.to_string(d[4]),[0,209],d[5],f,f,[0,0],[0,0],f,f,[0,0])}]):c.resolve():c.resolve()},function(a){return d[2]=d[0]}]):c.seq([function(e){return c.i64.neq(a[1],f)?c.seq([function(e){return c.i64.neq(a[2],[0,20])?(d[7]=new c.Map(),d[7].set("thread_fbid",a[1]),d[7].set("force_upsert",!1),d[7].set("use_open_messenger_transport",!1),d[7].set("sync_group",[0,95]),d[7].set("metadata_only",!1),d[8]=d[7].get("thread_fbid"),d[7],d[9]=c.toJSON(d[7]),c.sp(b("LSIssueNewTask"),c.i64.to_string(d[8]),[0,209],d[9],f,f,[0,0],[0,0],f,f,[0,0])):c.resolve()},function(b){return d[3]=a[1]}]):c.seq([function(a){return c.sp(b("LSCreateOfflineThreadingID"),c.i64.of_float(Date.now())).then(function(a){return a=a,d[7]=a[0],a})},function(a){return d[3]=d[7]}])},function(b){return d[4]=[64,1083495710],d[5]=[0,0],d[6]=[0,0],c.fe(c.ftr(c.db.table(9).fetch([[[d[3]]]]),function(b){return c.i64.eq(b.threadKey,d[3])&&c.i64.lt(b.authorityLevel,a[2])}),function(a){return a["delete"]()})},function(b){return c.db.table(9).add({threadKey:d[3],mailboxType:[0,4096],threadType:a[0],folderName:"inbox",lastActivityTimestampMs:[-1,4294967295],lastReadWatermarkTimestampMs:[-1,4294967295],removeWatermarkTimestampMs:[-1,4294967295],ongoingCallState:[0,0],parentThreadKey:[0,0],authorityLevel:a[2],capabilities:d[4],capabilities2:d[5],capabilities3:d[6],unsendLimitMs:[-1,4294967295],syncGroup:[0,95]})},function(a){return d[2]=d[3]}])},function(a){return e[0]=d[2]}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("MAWCryptoConsts",[],(function(a,b,c,d,e,f){a=60*60;b=24*a;c=32;d=new Uint8Array(0).buffer;e=128;a=256;var g=12,h=1,i=2,j=2;b=b*30*6;var k=3,l="AES-GCM",m="HKDF",n="SHA-256";f.HKDF_SEED_LENGTH_IN_BYTES=c;f.HKDF_INFO=d;f.AES_GCM_TAG_LENGTH=e;f.AES_GCM_KEY_LENGTH=a;f.AES_GCM_IV_LENGTH_IN_BYTES=g;f.VERSION=h;f.CIPHER_ID=i;f.ADDITIONAL_DATA_LENGTH_IN_BYTES=j;f.ENC_KEY_TTL=b;f.MAX_KEYCHAIN_SETUP_RETRIES=k;f.AES_GCM=l;f.HKDF=m;f.SHA256=n}),66);
__d("MAWKeychainUtil",[],(function(a,b,c,d,e,f){function a(a){return self.crypto.getRandomValues(new Uint8Array(a))}function b(a){var b=a.reduce(function(a,b){return a+b.byteLength},0),c=new Uint8Array(b);a.reduce(function(a,b){c.set(new Uint8Array(b),a);return a+b.byteLength},0);return c.buffer}function c(a,b){return new Uint8Array([a,b]).buffer}function d(a){var b=a.length;if(b>0&&b%2===0&&/^[\da-f]+$/gi.test(a)){var c=[];for(var d=0,b=b/2;d<b;++d){var e=parseInt(a.substring(d*2,d*2+2),16);c.push(e)}return new Uint8Array(c)}else return null}f.getBufferWithRandomValuesFromLength=a;f.mergeBuffers=b;f.makeAAD=c;f.fromHexString=d}),66);
__d("MAWSubtleCrypto",[],(function(a,b,c,d,e,f){a=self.crypto;b=a&&(a.subtle||a.webkitSubtle||a.subtle);f.MAWSubtleCrypto=b}),66);
__d("WAErr",[],(function(a,b,c,d,e,f){"use strict";function a(a){a=new Error(a);if(a.stack===void 0)try{throw a}catch(a){}return a}f["default"]=a}),66);
__d("WABase64",["WAErr","WALogger"],(function(a,b,c,d,e,f,g){function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Found unexpected character code while decoding B64 at index ",", length ",": ",""]);h=function(){return a};return a}var i=43,j=47,k=61,l=45,m=95,n=3e3,o="data:image/jpeg;base64,",p=function(a){return typeof a==="string"&&/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(a)};function a(a){return q(a,i,j,!0)}function b(a,b){b===void 0&&(b=!1);return q(a,l,m,b)}function q(a,b,c,d){a=Array.isArray(a)||a instanceof ArrayBuffer?new Uint8Array(a):a;if(a.length<=n)return r(a,b,c,d);else{var e=[];for(var f=0;f<a.length;f+=n)e.push(r(a.subarray(f,f+n),b,c,d));return e.join("")}}function r(a,b,c,d){var e=Math.ceil(a.length*4/3),f=4*Math.ceil(a.length/3),g=new Array(f);for(var h=0,i=0;h<f;h+=4,i+=3){var j=a[i]<<16|a[i+1]<<8|a[i+2];g[h]=j>>18;g[h+1]=j>>12&63;g[h+2]=j>>6&63;g[h+3]=j&63}for(j=0;j<e;j++){a=g[j];a<26?g[j]=65+a:a<52?g[j]=71+a:a<62?g[j]=a-4:a===62?g[j]=b:g[j]=c}for(h=e;h<f;h++)g[h]=61;i=String.fromCharCode.apply(String,g);return d?i:i.substring(0,e)}function s(a,b,c,e){var f=a.length,g=new Int32Array(f+f%4);for(var i=0;i<f;i++){var j=a.charCodeAt(i);if(65<=j&&j<=90)g[i]=j-65;else if(97<=j&&j<=122)g[i]=j-71;else if(48<=j&&j<=57)g[i]=j+4;else if(j===b)g[i]=62;else if(j===c)g[i]=63;else if(j===e){f=i;break}else{self.ERROR!=null&&d("WALogger").ERROR(h(),i,f,j);return null}}j=g.length/4;for(b=0,c=0;b<j;b++,c+=4)g[b]=g[c]<<18|g[c+1]<<12|g[c+2]<<6|g[c+3];e=Math.floor(f*3/4);i=new Uint8Array(e);a=0;b=0;for(;b+3<=e;a++,b+=3){j=g[a];i[b]=j>>16;i[b+1]=j>>8&255;i[b+2]=j&255}switch(e-b){case 2:i[b]=g[a]>>16;i[b+1]=g[a]>>8&255;break;case 1:i[b]=g[a]>>16}return i}function e(a){a=s(a,i,j,k);if(a)return a.buffer;else throw c("WAErr")("Base64.decode given invalid string")}function f(a,b){b===void 0&&(b=!1);a=s(a,l,m,b?k:-1);if(a)return a.buffer;else throw c("WAErr")("Base64.decode given invalid string")}function t(a){a=a instanceof ArrayBuffer?new Uint8Array(a):s(a,i,j,k);return a&&Array.from(a)}function u(a){return Math.floor(a.length*3/4)}g.BASE64_DATA_URL_SCHEME=o;g.isBase64=p;g.encodeB64=a;g.encodeB64UrlSafe=b;g.decodeB64=e;g.decodeB64UrlSafe=f;g.decodeB64ToJsArray=t;g.sizeWhenB64Decoded=u}),98);
__d("MAWKeychainCrypto",["MAWCryptoConsts","MAWKeychainUtil","MAWSubtleCrypto","MessengerWebInitData","WABase64","err"],(function(a,b,c,d,e,f,g){"use strict";var h=d("MAWKeychainUtil").makeAAD(d("MAWCryptoConsts").VERSION,d("MAWCryptoConsts").CIPHER_ID);function a(a,b,c){var e=d("MAWKeychainUtil").getBufferWithRandomValuesFromLength(d("MAWCryptoConsts").AES_GCM_IV_LENGTH_IN_BYTES),f=c?c:h;return d("MAWSubtleCrypto").MAWSubtleCrypto.encrypt({additionalData:f,iv:new Uint8Array(e),name:d("MAWCryptoConsts").AES_GCM,tagLength:d("MAWCryptoConsts").AES_GCM_TAG_LENGTH},a,b).then(function(a){a=d("MAWKeychainUtil").mergeBuffers([f,e,a]);return d("WABase64").encodeB64(a)})}function b(a,b){b=new Uint8Array(d("WABase64").decodeB64(b));var c=b.subarray(0,d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES),e=b.subarray(d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES,d("MAWCryptoConsts").AES_GCM_IV_LENGTH_IN_BYTES+d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES);b=b.subarray(d("MAWCryptoConsts").AES_GCM_IV_LENGTH_IN_BYTES+d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES);return d("MAWSubtleCrypto").MAWSubtleCrypto.decrypt({additionalData:c,iv:e,name:d("MAWCryptoConsts").AES_GCM,tagLength:d("MAWCryptoConsts").AES_GCM_TAG_LENGTH},a,b)}function e(){var a=d("MAWKeychainUtil").fromHexString(c("MessengerWebInitData").accountKey);if(a==null)throw c("err")("Invalid value for account key");return d("MAWSubtleCrypto").MAWSubtleCrypto.importKey("raw",a.buffer,{name:d("MAWCryptoConsts").AES_GCM},!1,["encrypt","decrypt"])}function f(){return d("WABase64").encodeB64(d("MAWKeychainUtil").getBufferWithRandomValuesFromLength(d("MAWCryptoConsts").HKDF_SEED_LENGTH_IN_BYTES))}function i(a){a=d("WABase64").decodeB64(a);return d("MAWSubtleCrypto").MAWSubtleCrypto.importKey("raw",a,{name:d("MAWCryptoConsts").HKDF},!1,["deriveKey"])}function j(){return d("MAWKeychainUtil").getBufferWithRandomValuesFromLength(d("MAWCryptoConsts").HKDF_SEED_LENGTH_IN_BYTES)}function k(a,b){return d("MAWSubtleCrypto").MAWSubtleCrypto.deriveKey({hash:{name:d("MAWCryptoConsts").SHA256},info:d("MAWCryptoConsts").HKDF_INFO,name:d("MAWCryptoConsts").HKDF,salt:b},a,{length:d("MAWCryptoConsts").AES_GCM_KEY_LENGTH,name:d("MAWCryptoConsts").AES_GCM},!0,["encrypt","decrypt"]).then(function(a){return d("MAWSubtleCrypto").MAWSubtleCrypto.exportKey("raw",a)})}function l(a){a=a.slice(0,d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES);return new DataView(a).getUint8(0)}function m(a){return l(d("WABase64").decodeB64(a))}g.ADDITIONAL_DATA=h;g.encryptDataToStringBuffer=a;g.decryptDataToArrayBuffer=b;g.genAccountKey=e;g.genBrowserEncryptionKeyString=f;g.importBrowserEncryptionKey=i;g.genDatabaseEncryptionSeed=j;g.genDatabaseEncryptionKey=k;g.getKeyVersionFromCipherData=l;g.getKeyVersionFromCipherDataString=m}),98);
/**
 * License: https://www.facebook.com/legal/license/OKBVmODmb-W/
 */
__d("tweetnacl-1.0.3",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){(function(a){var b=function(a){var b,c=new Float64Array(16);if(a)for(b=0;b<a.length;b++)c[b]=a[b];return c},c=function(){throw new Error("no PRNG")},d=new Uint8Array(16),e=new Uint8Array(32);e[0]=9;var f=b(),g=b([1]),h=b([56129,1]),i=b([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),j=b([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),k=b([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=b([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),m=b([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function n(a,b,c,d){a[b]=c>>24&255,a[b+1]=c>>16&255,a[b+2]=c>>8&255,a[b+3]=c&255,a[b+4]=d>>24&255,a[b+5]=d>>16&255,a[b+6]=d>>8&255,a[b+7]=d&255}function o(a,b,c,d,e){var f,g=0;for(f=0;f<e;f++)g|=a[b+f]^c[d+f];return(1&g-1>>>8)-1}function p(a,b,c,d){return o(a,b,c,d,16)}function q(a,b,c,d){return o(a,b,c,d,32)}function r(a,b,c,d){var e=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,f=c[0]&255|(c[1]&255)<<8|(c[2]&255)<<16|(c[3]&255)<<24,g=c[4]&255|(c[5]&255)<<8|(c[6]&255)<<16|(c[7]&255)<<24,h=c[8]&255|(c[9]&255)<<8|(c[10]&255)<<16|(c[11]&255)<<24,i=c[12]&255|(c[13]&255)<<8|(c[14]&255)<<16|(c[15]&255)<<24,j=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,k=b[0]&255|(b[1]&255)<<8|(b[2]&255)<<16|(b[3]&255)<<24,l=b[4]&255|(b[5]&255)<<8|(b[6]&255)<<16|(b[7]&255)<<24,m=b[8]&255|(b[9]&255)<<8|(b[10]&255)<<16|(b[11]&255)<<24;b=b[12]&255|(b[13]&255)<<8|(b[14]&255)<<16|(b[15]&255)<<24;var n=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,o=c[16]&255|(c[17]&255)<<8|(c[18]&255)<<16|(c[19]&255)<<24,p=c[20]&255|(c[21]&255)<<8|(c[22]&255)<<16|(c[23]&255)<<24,q=c[24]&255|(c[25]&255)<<8|(c[26]&255)<<16|(c[27]&255)<<24;c=c[28]&255|(c[29]&255)<<8|(c[30]&255)<<16|(c[31]&255)<<24;d=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24;var r=e,s=f,t=g,u=h,v=i,w=j,x=k,y=l,z=m,A=b,B=n,C=o,D=p,E=q,F=c,G=d,H;for(var I=0;I<20;I+=2)H=r+D|0,v^=H<<7|H>>>32-7,H=v+r|0,z^=H<<9|H>>>32-9,H=z+v|0,D^=H<<13|H>>>32-13,H=D+z|0,r^=H<<18|H>>>32-18,H=w+s|0,A^=H<<7|H>>>32-7,H=A+w|0,E^=H<<9|H>>>32-9,H=E+A|0,s^=H<<13|H>>>32-13,H=s+E|0,w^=H<<18|H>>>32-18,H=B+x|0,F^=H<<7|H>>>32-7,H=F+B|0,t^=H<<9|H>>>32-9,H=t+F|0,x^=H<<13|H>>>32-13,H=x+t|0,B^=H<<18|H>>>32-18,H=G+C|0,u^=H<<7|H>>>32-7,H=u+G|0,y^=H<<9|H>>>32-9,H=y+u|0,C^=H<<13|H>>>32-13,H=C+y|0,G^=H<<18|H>>>32-18,H=r+u|0,s^=H<<7|H>>>32-7,H=s+r|0,t^=H<<9|H>>>32-9,H=t+s|0,u^=H<<13|H>>>32-13,H=u+t|0,r^=H<<18|H>>>32-18,H=w+v|0,x^=H<<7|H>>>32-7,H=x+w|0,y^=H<<9|H>>>32-9,H=y+x|0,v^=H<<13|H>>>32-13,H=v+y|0,w^=H<<18|H>>>32-18,H=B+A|0,C^=H<<7|H>>>32-7,H=C+B|0,z^=H<<9|H>>>32-9,H=z+C|0,A^=H<<13|H>>>32-13,H=A+z|0,B^=H<<18|H>>>32-18,H=G+F|0,D^=H<<7|H>>>32-7,H=D+G|0,E^=H<<9|H>>>32-9,H=E+D|0,F^=H<<13|H>>>32-13,H=F+E|0,G^=H<<18|H>>>32-18;r=r+e|0;s=s+f|0;t=t+g|0;u=u+h|0;v=v+i|0;w=w+j|0;x=x+k|0;y=y+l|0;z=z+m|0;A=A+b|0;B=B+n|0;C=C+o|0;D=D+p|0;E=E+q|0;F=F+c|0;G=G+d|0;a[0]=r>>>0&255;a[1]=r>>>8&255;a[2]=r>>>16&255;a[3]=r>>>24&255;a[4]=s>>>0&255;a[5]=s>>>8&255;a[6]=s>>>16&255;a[7]=s>>>24&255;a[8]=t>>>0&255;a[9]=t>>>8&255;a[10]=t>>>16&255;a[11]=t>>>24&255;a[12]=u>>>0&255;a[13]=u>>>8&255;a[14]=u>>>16&255;a[15]=u>>>24&255;a[16]=v>>>0&255;a[17]=v>>>8&255;a[18]=v>>>16&255;a[19]=v>>>24&255;a[20]=w>>>0&255;a[21]=w>>>8&255;a[22]=w>>>16&255;a[23]=w>>>24&255;a[24]=x>>>0&255;a[25]=x>>>8&255;a[26]=x>>>16&255;a[27]=x>>>24&255;a[28]=y>>>0&255;a[29]=y>>>8&255;a[30]=y>>>16&255;a[31]=y>>>24&255;a[32]=z>>>0&255;a[33]=z>>>8&255;a[34]=z>>>16&255;a[35]=z>>>24&255;a[36]=A>>>0&255;a[37]=A>>>8&255;a[38]=A>>>16&255;a[39]=A>>>24&255;a[40]=B>>>0&255;a[41]=B>>>8&255;a[42]=B>>>16&255;a[43]=B>>>24&255;a[44]=C>>>0&255;a[45]=C>>>8&255;a[46]=C>>>16&255;a[47]=C>>>24&255;a[48]=D>>>0&255;a[49]=D>>>8&255;a[50]=D>>>16&255;a[51]=D>>>24&255;a[52]=E>>>0&255;a[53]=E>>>8&255;a[54]=E>>>16&255;a[55]=E>>>24&255;a[56]=F>>>0&255;a[57]=F>>>8&255;a[58]=F>>>16&255;a[59]=F>>>24&255;a[60]=G>>>0&255;a[61]=G>>>8&255;a[62]=G>>>16&255;a[63]=G>>>24&255}function s(a,b,c,d){var e=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,f=c[0]&255|(c[1]&255)<<8|(c[2]&255)<<16|(c[3]&255)<<24,g=c[4]&255|(c[5]&255)<<8|(c[6]&255)<<16|(c[7]&255)<<24,h=c[8]&255|(c[9]&255)<<8|(c[10]&255)<<16|(c[11]&255)<<24,i=c[12]&255|(c[13]&255)<<8|(c[14]&255)<<16|(c[15]&255)<<24,j=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,k=b[0]&255|(b[1]&255)<<8|(b[2]&255)<<16|(b[3]&255)<<24,l=b[4]&255|(b[5]&255)<<8|(b[6]&255)<<16|(b[7]&255)<<24,m=b[8]&255|(b[9]&255)<<8|(b[10]&255)<<16|(b[11]&255)<<24;b=b[12]&255|(b[13]&255)<<8|(b[14]&255)<<16|(b[15]&255)<<24;var n=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,o=c[16]&255|(c[17]&255)<<8|(c[18]&255)<<16|(c[19]&255)<<24,p=c[20]&255|(c[21]&255)<<8|(c[22]&255)<<16|(c[23]&255)<<24,q=c[24]&255|(c[25]&255)<<8|(c[26]&255)<<16|(c[27]&255)<<24;c=c[28]&255|(c[29]&255)<<8|(c[30]&255)<<16|(c[31]&255)<<24;d=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24;e=e;f=f;g=g;h=h;i=i;j=j;k=k;l=l;m=m;b=b;n=n;o=o;p=p;q=q;c=c;d=d;var r;for(var s=0;s<20;s+=2)r=e+p|0,i^=r<<7|r>>>32-7,r=i+e|0,m^=r<<9|r>>>32-9,r=m+i|0,p^=r<<13|r>>>32-13,r=p+m|0,e^=r<<18|r>>>32-18,r=j+f|0,b^=r<<7|r>>>32-7,r=b+j|0,q^=r<<9|r>>>32-9,r=q+b|0,f^=r<<13|r>>>32-13,r=f+q|0,j^=r<<18|r>>>32-18,r=n+k|0,c^=r<<7|r>>>32-7,r=c+n|0,g^=r<<9|r>>>32-9,r=g+c|0,k^=r<<13|r>>>32-13,r=k+g|0,n^=r<<18|r>>>32-18,r=d+o|0,h^=r<<7|r>>>32-7,r=h+d|0,l^=r<<9|r>>>32-9,r=l+h|0,o^=r<<13|r>>>32-13,r=o+l|0,d^=r<<18|r>>>32-18,r=e+h|0,f^=r<<7|r>>>32-7,r=f+e|0,g^=r<<9|r>>>32-9,r=g+f|0,h^=r<<13|r>>>32-13,r=h+g|0,e^=r<<18|r>>>32-18,r=j+i|0,k^=r<<7|r>>>32-7,r=k+j|0,l^=r<<9|r>>>32-9,r=l+k|0,i^=r<<13|r>>>32-13,r=i+l|0,j^=r<<18|r>>>32-18,r=n+b|0,o^=r<<7|r>>>32-7,r=o+n|0,m^=r<<9|r>>>32-9,r=m+o|0,b^=r<<13|r>>>32-13,r=b+m|0,n^=r<<18|r>>>32-18,r=d+c|0,p^=r<<7|r>>>32-7,r=p+d|0,q^=r<<9|r>>>32-9,r=q+p|0,c^=r<<13|r>>>32-13,r=c+q|0,d^=r<<18|r>>>32-18;a[0]=e>>>0&255;a[1]=e>>>8&255;a[2]=e>>>16&255;a[3]=e>>>24&255;a[4]=j>>>0&255;a[5]=j>>>8&255;a[6]=j>>>16&255;a[7]=j>>>24&255;a[8]=n>>>0&255;a[9]=n>>>8&255;a[10]=n>>>16&255;a[11]=n>>>24&255;a[12]=d>>>0&255;a[13]=d>>>8&255;a[14]=d>>>16&255;a[15]=d>>>24&255;a[16]=k>>>0&255;a[17]=k>>>8&255;a[18]=k>>>16&255;a[19]=k>>>24&255;a[20]=l>>>0&255;a[21]=l>>>8&255;a[22]=l>>>16&255;a[23]=l>>>24&255;a[24]=m>>>0&255;a[25]=m>>>8&255;a[26]=m>>>16&255;a[27]=m>>>24&255;a[28]=b>>>0&255;a[29]=b>>>8&255;a[30]=b>>>16&255;a[31]=b>>>24&255}function t(a,b,c,d){r(a,b,c,d)}function u(a,b,c,d){s(a,b,c,d)}var v=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function w(a,b,c,d,e,f,g){var h=new Uint8Array(16),i=new Uint8Array(64),j;for(j=0;j<16;j++)h[j]=0;for(j=0;j<8;j++)h[j]=f[j];while(e>=64){t(i,h,g,v);for(j=0;j<64;j++)a[b+j]=c[d+j]^i[j];f=1;for(j=8;j<16;j++)f=f+(h[j]&255)|0,h[j]=f&255,f>>>=8;e-=64;b+=64;d+=64}if(e>0){t(i,h,g,v);for(j=0;j<e;j++)a[b+j]=c[d+j]^i[j]}return 0}function x(a,b,c,d,e){var f=new Uint8Array(16),g=new Uint8Array(64),h;for(h=0;h<16;h++)f[h]=0;for(h=0;h<8;h++)f[h]=d[h];while(c>=64){t(g,f,e,v);for(h=0;h<64;h++)a[b+h]=g[h];d=1;for(h=8;h<16;h++)d=d+(f[h]&255)|0,f[h]=d&255,d>>>=8;c-=64;b+=64}if(c>0){t(g,f,e,v);for(h=0;h<c;h++)a[b+h]=g[h]}return 0}function y(a,b,c,d,e){var f=new Uint8Array(32);u(f,d,e,v);e=new Uint8Array(8);for(var g=0;g<8;g++)e[g]=d[g+16];return x(a,b,c,e,f)}function z(a,b,c,d,e,f,g){var h=new Uint8Array(32);u(h,f,g,v);g=new Uint8Array(8);for(var i=0;i<8;i++)g[i]=f[i+16];return w(a,b,c,d,e,g,h)}var A=function(a){this.buffer=new Uint8Array(16);this.r=new Uint16Array(10);this.h=new Uint16Array(10);this.pad=new Uint16Array(8);this.leftover=0;this.fin=0;var b,c;b=a[0]&255|(a[1]&255)<<8;this.r[0]=b&8191;c=a[2]&255|(a[3]&255)<<8;this.r[1]=(b>>>13|c<<3)&8191;b=a[4]&255|(a[5]&255)<<8;this.r[2]=(c>>>10|b<<6)&7939;c=a[6]&255|(a[7]&255)<<8;this.r[3]=(b>>>7|c<<9)&8191;b=a[8]&255|(a[9]&255)<<8;this.r[4]=(c>>>4|b<<12)&255;this.r[5]=b>>>1&8190;c=a[10]&255|(a[11]&255)<<8;this.r[6]=(b>>>14|c<<2)&8191;b=a[12]&255|(a[13]&255)<<8;this.r[7]=(c>>>11|b<<5)&8065;c=a[14]&255|(a[15]&255)<<8;this.r[8]=(b>>>8|c<<8)&8191;this.r[9]=c>>>5&127;this.pad[0]=a[16]&255|(a[17]&255)<<8;this.pad[1]=a[18]&255|(a[19]&255)<<8;this.pad[2]=a[20]&255|(a[21]&255)<<8;this.pad[3]=a[22]&255|(a[23]&255)<<8;this.pad[4]=a[24]&255|(a[25]&255)<<8;this.pad[5]=a[26]&255|(a[27]&255)<<8;this.pad[6]=a[28]&255|(a[29]&255)<<8;this.pad[7]=a[30]&255|(a[31]&255)<<8};A.prototype.blocks=function(a,b,c){var d=this.fin?0:1<<11,e,f,g,h,i,j,k,l,m,n,o,p=this.h[0],q=this.h[1],r=this.h[2],s=this.h[3],t=this.h[4],u=this.h[5],v=this.h[6],w=this.h[7],x=this.h[8],y=this.h[9],z=this.r[0],A=this.r[1],B=this.r[2],C=this.r[3],D=this.r[4],E=this.r[5],F=this.r[6],G=this.r[7],H=this.r[8],I=this.r[9];while(c>=16)e=a[b+0]&255|(a[b+1]&255)<<8,p+=e&8191,f=a[b+2]&255|(a[b+3]&255)<<8,q+=(e>>>13|f<<3)&8191,e=a[b+4]&255|(a[b+5]&255)<<8,r+=(f>>>10|e<<6)&8191,f=a[b+6]&255|(a[b+7]&255)<<8,s+=(e>>>7|f<<9)&8191,e=a[b+8]&255|(a[b+9]&255)<<8,t+=(f>>>4|e<<12)&8191,u+=e>>>1&8191,f=a[b+10]&255|(a[b+11]&255)<<8,v+=(e>>>14|f<<2)&8191,e=a[b+12]&255|(a[b+13]&255)<<8,w+=(f>>>11|e<<5)&8191,f=a[b+14]&255|(a[b+15]&255)<<8,x+=(e>>>8|f<<8)&8191,y+=f>>>5|d,e=0,f=e,f+=p*z,f+=q*(5*I),f+=r*(5*H),f+=s*(5*G),f+=t*(5*F),e=f>>>13,f&=8191,f+=u*(5*E),f+=v*(5*D),f+=w*(5*C),f+=x*(5*B),f+=y*(5*A),e+=f>>>13,f&=8191,g=e,g+=p*A,g+=q*z,g+=r*(5*I),g+=s*(5*H),g+=t*(5*G),e=g>>>13,g&=8191,g+=u*(5*F),g+=v*(5*E),g+=w*(5*D),g+=x*(5*C),g+=y*(5*B),e+=g>>>13,g&=8191,h=e,h+=p*B,h+=q*A,h+=r*z,h+=s*(5*I),h+=t*(5*H),e=h>>>13,h&=8191,h+=u*(5*G),h+=v*(5*F),h+=w*(5*E),h+=x*(5*D),h+=y*(5*C),e+=h>>>13,h&=8191,i=e,i+=p*C,i+=q*B,i+=r*A,i+=s*z,i+=t*(5*I),e=i>>>13,i&=8191,i+=u*(5*H),i+=v*(5*G),i+=w*(5*F),i+=x*(5*E),i+=y*(5*D),e+=i>>>13,i&=8191,j=e,j+=p*D,j+=q*C,j+=r*B,j+=s*A,j+=t*z,e=j>>>13,j&=8191,j+=u*(5*I),j+=v*(5*H),j+=w*(5*G),j+=x*(5*F),j+=y*(5*E),e+=j>>>13,j&=8191,k=e,k+=p*E,k+=q*D,k+=r*C,k+=s*B,k+=t*A,e=k>>>13,k&=8191,k+=u*z,k+=v*(5*I),k+=w*(5*H),k+=x*(5*G),k+=y*(5*F),e+=k>>>13,k&=8191,l=e,l+=p*F,l+=q*E,l+=r*D,l+=s*C,l+=t*B,e=l>>>13,l&=8191,l+=u*A,l+=v*z,l+=w*(5*I),l+=x*(5*H),l+=y*(5*G),e+=l>>>13,l&=8191,m=e,m+=p*G,m+=q*F,m+=r*E,m+=s*D,m+=t*C,e=m>>>13,m&=8191,m+=u*B,m+=v*A,m+=w*z,m+=x*(5*I),m+=y*(5*H),e+=m>>>13,m&=8191,n=e,n+=p*H,n+=q*G,n+=r*F,n+=s*E,n+=t*D,e=n>>>13,n&=8191,n+=u*C,n+=v*B,n+=w*A,n+=x*z,n+=y*(5*I),e+=n>>>13,n&=8191,o=e,o+=p*I,o+=q*H,o+=r*G,o+=s*F,o+=t*E,e=o>>>13,o&=8191,o+=u*D,o+=v*C,o+=w*B,o+=x*A,o+=y*z,e+=o>>>13,o&=8191,e=(e<<2)+e|0,e=e+f|0,f=e&8191,e=e>>>13,g+=e,p=f,q=g,r=h,s=i,t=j,u=k,v=l,w=m,x=n,y=o,b+=16,c-=16;this.h[0]=p;this.h[1]=q;this.h[2]=r;this.h[3]=s;this.h[4]=t;this.h[5]=u;this.h[6]=v;this.h[7]=w;this.h[8]=x;this.h[9]=y};A.prototype.finish=function(a,b){var c=new Uint16Array(10),d,e;if(this.leftover){e=this.leftover;this.buffer[e++]=1;for(;e<16;e++)this.buffer[e]=0;this.fin=1;this.blocks(this.buffer,0,16)}d=this.h[1]>>>13;this.h[1]&=8191;for(e=2;e<10;e++)this.h[e]+=d,d=this.h[e]>>>13,this.h[e]&=8191;this.h[0]+=d*5;d=this.h[0]>>>13;this.h[0]&=8191;this.h[1]+=d;d=this.h[1]>>>13;this.h[1]&=8191;this.h[2]+=d;c[0]=this.h[0]+5;d=c[0]>>>13;c[0]&=8191;for(e=1;e<10;e++)c[e]=this.h[e]+d,d=c[e]>>>13,c[e]&=8191;c[9]-=1<<13;d=(d^1)-1;for(e=0;e<10;e++)c[e]&=d;d=~d;for(e=0;e<10;e++)this.h[e]=this.h[e]&d|c[e];this.h[0]=(this.h[0]|this.h[1]<<13)&65535;this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535;this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535;this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535;this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535;this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535;this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535;this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535;c=this.h[0]+this.pad[0];this.h[0]=c&65535;for(e=1;e<8;e++)c=(this.h[e]+this.pad[e]|0)+(c>>>16)|0,this.h[e]=c&65535;a[b+0]=this.h[0]>>>0&255;a[b+1]=this.h[0]>>>8&255;a[b+2]=this.h[1]>>>0&255;a[b+3]=this.h[1]>>>8&255;a[b+4]=this.h[2]>>>0&255;a[b+5]=this.h[2]>>>8&255;a[b+6]=this.h[3]>>>0&255;a[b+7]=this.h[3]>>>8&255;a[b+8]=this.h[4]>>>0&255;a[b+9]=this.h[4]>>>8&255;a[b+10]=this.h[5]>>>0&255;a[b+11]=this.h[5]>>>8&255;a[b+12]=this.h[6]>>>0&255;a[b+13]=this.h[6]>>>8&255;a[b+14]=this.h[7]>>>0&255;a[b+15]=this.h[7]>>>8&255};A.prototype.update=function(a,b,c){var d,e;if(this.leftover){e=16-this.leftover;e>c&&(e=c);for(d=0;d<e;d++)this.buffer[this.leftover+d]=a[b+d];c-=e;b+=e;this.leftover+=e;if(this.leftover<16)return;this.blocks(this.buffer,0,16);this.leftover=0}c>=16&&(e=c-c%16,this.blocks(a,b,e),b+=e,c-=e);if(c){for(d=0;d<c;d++)this.buffer[this.leftover+d]=a[b+d];this.leftover+=c}};function B(a,b,c,d,e,f){f=new A(f);f.update(c,d,e);f.finish(a,b);return 0}function C(a,b,c,d,e,f){var g=new Uint8Array(16);B(g,0,c,d,e,f);return p(a,b,g,0)}function D(a,b,c,d,e){if(c<32)return-1;z(a,0,b,0,c,d,e);B(a,16,a,32,c-32,a);for(b=0;b<16;b++)a[b]=0;return 0}function E(a,b,c,d,e){var f=new Uint8Array(32);if(c<32)return-1;y(f,0,32,d,e);if(C(b,16,b,32,c-32,f)!==0)return-1;z(a,0,b,0,c,d,e);for(f=0;f<32;f++)a[f]=0;return 0}function F(a,b){var c;for(c=0;c<16;c++)a[c]=b[c]|0}function G(a){var b,c,d=1;for(b=0;b<16;b++)c=a[b]+d+65535,d=Math.floor(c/65536),a[b]=c-d*65536;a[0]+=d-1+37*(d-1)}function H(a,b,c){var d;c=~(c-1);for(var e=0;e<16;e++)d=c&(a[e]^b[e]),a[e]^=d,b[e]^=d}function I(a,c){var d,e,f=b(),g=b();for(d=0;d<16;d++)g[d]=c[d];G(g);G(g);G(g);for(c=0;c<2;c++){f[0]=g[0]-65517;for(d=1;d<15;d++)f[d]=g[d]-65535-(f[d-1]>>16&1),f[d-1]&=65535;f[15]=g[15]-32767-(f[14]>>16&1);e=f[15]>>16&1;f[14]&=65535;H(g,f,1-e)}for(d=0;d<16;d++)a[2*d]=g[d]&255,a[2*d+1]=g[d]>>8}function J(a,b){var c=new Uint8Array(32),d=new Uint8Array(32);I(c,a);I(d,b);return q(c,0,d,0)}function K(a){var b=new Uint8Array(32);I(b,a);return b[0]&1}function L(a,b){var c;for(c=0;c<16;c++)a[c]=b[2*c]+(b[2*c+1]<<8);a[15]&=32767}function M(a,b,c){for(var d=0;d<16;d++)a[d]=b[d]+c[d]}function N(a,b,c){for(var d=0;d<16;d++)a[d]=b[d]-c[d]}function O(a,b,c){var d,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=c[0],K=c[1],L=c[2],M=c[3],N=c[4],O=c[5],P=c[6],Q=c[7],R=c[8],S=c[9],T=c[10],U=c[11],V=c[12],W=c[13],X=c[14];c=c[15];d=b[0];e+=d*J;f+=d*K;g+=d*L;h+=d*M;i+=d*N;j+=d*O;k+=d*P;l+=d*Q;m+=d*R;n+=d*S;o+=d*T;p+=d*U;q+=d*V;r+=d*W;s+=d*X;t+=d*c;d=b[1];f+=d*J;g+=d*K;h+=d*L;i+=d*M;j+=d*N;k+=d*O;l+=d*P;m+=d*Q;n+=d*R;o+=d*S;p+=d*T;q+=d*U;r+=d*V;s+=d*W;t+=d*X;u+=d*c;d=b[2];g+=d*J;h+=d*K;i+=d*L;j+=d*M;k+=d*N;l+=d*O;m+=d*P;n+=d*Q;o+=d*R;p+=d*S;q+=d*T;r+=d*U;s+=d*V;t+=d*W;u+=d*X;v+=d*c;d=b[3];h+=d*J;i+=d*K;j+=d*L;k+=d*M;l+=d*N;m+=d*O;n+=d*P;o+=d*Q;p+=d*R;q+=d*S;r+=d*T;s+=d*U;t+=d*V;u+=d*W;v+=d*X;w+=d*c;d=b[4];i+=d*J;j+=d*K;k+=d*L;l+=d*M;m+=d*N;n+=d*O;o+=d*P;p+=d*Q;q+=d*R;r+=d*S;s+=d*T;t+=d*U;u+=d*V;v+=d*W;w+=d*X;x+=d*c;d=b[5];j+=d*J;k+=d*K;l+=d*L;m+=d*M;n+=d*N;o+=d*O;p+=d*P;q+=d*Q;r+=d*R;s+=d*S;t+=d*T;u+=d*U;v+=d*V;w+=d*W;x+=d*X;y+=d*c;d=b[6];k+=d*J;l+=d*K;m+=d*L;n+=d*M;o+=d*N;p+=d*O;q+=d*P;r+=d*Q;s+=d*R;t+=d*S;u+=d*T;v+=d*U;w+=d*V;x+=d*W;y+=d*X;z+=d*c;d=b[7];l+=d*J;m+=d*K;n+=d*L;o+=d*M;p+=d*N;q+=d*O;r+=d*P;s+=d*Q;t+=d*R;u+=d*S;v+=d*T;w+=d*U;x+=d*V;y+=d*W;z+=d*X;A+=d*c;d=b[8];m+=d*J;n+=d*K;o+=d*L;p+=d*M;q+=d*N;r+=d*O;s+=d*P;t+=d*Q;u+=d*R;v+=d*S;w+=d*T;x+=d*U;y+=d*V;z+=d*W;A+=d*X;B+=d*c;d=b[9];n+=d*J;o+=d*K;p+=d*L;q+=d*M;r+=d*N;s+=d*O;t+=d*P;u+=d*Q;v+=d*R;w+=d*S;x+=d*T;y+=d*U;z+=d*V;A+=d*W;B+=d*X;C+=d*c;d=b[10];o+=d*J;p+=d*K;q+=d*L;r+=d*M;s+=d*N;t+=d*O;u+=d*P;v+=d*Q;w+=d*R;x+=d*S;y+=d*T;z+=d*U;A+=d*V;B+=d*W;C+=d*X;D+=d*c;d=b[11];p+=d*J;q+=d*K;r+=d*L;s+=d*M;t+=d*N;u+=d*O;v+=d*P;w+=d*Q;x+=d*R;y+=d*S;z+=d*T;A+=d*U;B+=d*V;C+=d*W;D+=d*X;E+=d*c;d=b[12];q+=d*J;r+=d*K;s+=d*L;t+=d*M;u+=d*N;v+=d*O;w+=d*P;x+=d*Q;y+=d*R;z+=d*S;A+=d*T;B+=d*U;C+=d*V;D+=d*W;E+=d*X;F+=d*c;d=b[13];r+=d*J;s+=d*K;t+=d*L;u+=d*M;v+=d*N;w+=d*O;x+=d*P;y+=d*Q;z+=d*R;A+=d*S;B+=d*T;C+=d*U;D+=d*V;E+=d*W;F+=d*X;G+=d*c;d=b[14];s+=d*J;t+=d*K;u+=d*L;v+=d*M;w+=d*N;x+=d*O;y+=d*P;z+=d*Q;A+=d*R;B+=d*S;C+=d*T;D+=d*U;E+=d*V;F+=d*W;G+=d*X;H+=d*c;d=b[15];t+=d*J;u+=d*K;v+=d*L;w+=d*M;x+=d*N;y+=d*O;z+=d*P;A+=d*Q;B+=d*R;C+=d*S;D+=d*T;E+=d*U;F+=d*V;G+=d*W;H+=d*X;I+=d*c;e+=38*u;f+=38*v;g+=38*w;h+=38*x;i+=38*y;j+=38*z;k+=38*A;l+=38*B;m+=38*C;n+=38*D;o+=38*E;p+=38*F;q+=38*G;r+=38*H;s+=38*I;b=1;d=e+b+65535;b=Math.floor(d/65536);e=d-b*65536;d=f+b+65535;b=Math.floor(d/65536);f=d-b*65536;d=g+b+65535;b=Math.floor(d/65536);g=d-b*65536;d=h+b+65535;b=Math.floor(d/65536);h=d-b*65536;d=i+b+65535;b=Math.floor(d/65536);i=d-b*65536;d=j+b+65535;b=Math.floor(d/65536);j=d-b*65536;d=k+b+65535;b=Math.floor(d/65536);k=d-b*65536;d=l+b+65535;b=Math.floor(d/65536);l=d-b*65536;d=m+b+65535;b=Math.floor(d/65536);m=d-b*65536;d=n+b+65535;b=Math.floor(d/65536);n=d-b*65536;d=o+b+65535;b=Math.floor(d/65536);o=d-b*65536;d=p+b+65535;b=Math.floor(d/65536);p=d-b*65536;d=q+b+65535;b=Math.floor(d/65536);q=d-b*65536;d=r+b+65535;b=Math.floor(d/65536);r=d-b*65536;d=s+b+65535;b=Math.floor(d/65536);s=d-b*65536;d=t+b+65535;b=Math.floor(d/65536);t=d-b*65536;e+=b-1+37*(b-1);b=1;d=e+b+65535;b=Math.floor(d/65536);e=d-b*65536;d=f+b+65535;b=Math.floor(d/65536);f=d-b*65536;d=g+b+65535;b=Math.floor(d/65536);g=d-b*65536;d=h+b+65535;b=Math.floor(d/65536);h=d-b*65536;d=i+b+65535;b=Math.floor(d/65536);i=d-b*65536;d=j+b+65535;b=Math.floor(d/65536);j=d-b*65536;d=k+b+65535;b=Math.floor(d/65536);k=d-b*65536;d=l+b+65535;b=Math.floor(d/65536);l=d-b*65536;d=m+b+65535;b=Math.floor(d/65536);m=d-b*65536;d=n+b+65535;b=Math.floor(d/65536);n=d-b*65536;d=o+b+65535;b=Math.floor(d/65536);o=d-b*65536;d=p+b+65535;b=Math.floor(d/65536);p=d-b*65536;d=q+b+65535;b=Math.floor(d/65536);q=d-b*65536;d=r+b+65535;b=Math.floor(d/65536);r=d-b*65536;d=s+b+65535;b=Math.floor(d/65536);s=d-b*65536;d=t+b+65535;b=Math.floor(d/65536);t=d-b*65536;e+=b-1+37*(b-1);a[0]=e;a[1]=f;a[2]=g;a[3]=h;a[4]=i;a[5]=j;a[6]=k;a[7]=l;a[8]=m;a[9]=n;a[10]=o;a[11]=p;a[12]=q;a[13]=r;a[14]=s;a[15]=t}function P(a,b){O(a,b,b)}function Q(a,c){var d=b(),e;for(e=0;e<16;e++)d[e]=c[e];for(e=253;e>=0;e--)P(d,d),e!==2&&e!==4&&O(d,d,c);for(e=0;e<16;e++)a[e]=d[e]}function R(a,c){var d=b(),e;for(e=0;e<16;e++)d[e]=c[e];for(e=250;e>=0;e--)P(d,d),e!==1&&O(d,d,c);for(e=0;e<16;e++)a[e]=d[e]}function S(a,c,d){var e=new Uint8Array(32),f=new Float64Array(80),g,i=b(),j=b(),k=b(),l=b(),m=b(),n=b();for(g=0;g<31;g++)e[g]=c[g];e[31]=c[31]&127|64;e[0]&=248;L(f,d);for(g=0;g<16;g++)j[g]=f[g],l[g]=i[g]=k[g]=0;i[0]=l[0]=1;for(g=254;g>=0;--g)c=e[g>>>3]>>>(g&7)&1,H(i,j,c),H(k,l,c),M(m,i,k),N(i,i,k),M(k,j,l),N(j,j,l),P(l,m),P(n,i),O(i,k,i),O(k,j,m),M(m,i,k),N(i,i,k),P(j,i),N(k,l,n),O(i,k,h),M(i,i,l),O(k,k,i),O(i,l,n),O(l,j,f),P(j,m),H(i,j,c),H(k,l,c);for(g=0;g<16;g++)f[g+16]=i[g],f[g+32]=k[g],f[g+48]=j[g],f[g+64]=l[g];d=f.subarray(32);c=f.subarray(16);Q(d,d);O(c,c,d);I(a,c);return 0}function T(a,b){return S(a,b,e)}function U(a,b){c(b,32);return T(a,b)}function V(a,b,c){var e=new Uint8Array(32);S(e,c,b);return u(a,d,e,v)}var W=D,X=E;function aa(a,b,c,d,e,f){var g=new Uint8Array(32);V(g,e,f);return W(a,b,c,d,g)}function ba(a,b,c,d,e,f){var g=new Uint8Array(32);V(g,e,f);return X(a,b,c,d,g)}var ca=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function da(a,b,c,d){var e=new Int32Array(16),f=new Int32Array(16),g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=a[0],H=a[1],I=a[2],J=a[3],K=a[4],L=a[5],M=a[6],N=a[7],O=b[0],P=b[1],Q=b[2],R=b[3],S=b[4],T=b[5],U=b[6],V=b[7],W=0;while(d>=128){for(y=0;y<16;y++)z=8*y+W,e[y]=c[z+0]<<24|c[z+1]<<16|c[z+2]<<8|c[z+3],f[y]=c[z+4]<<24|c[z+5]<<16|c[z+6]<<8|c[z+7];for(y=0;y<80;y++){g=G;h=H;i=I;j=J;k=K;l=L;m=M;N;o=O;p=P;q=Q;r=R;s=S;t=T;u=U;V;A=N;B=V;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=(K>>>14|S<<32-14)^(K>>>18|S<<32-18)^(S>>>41-32|K<<32-(41-32));B=(S>>>14|K<<32-14)^(S>>>18|K<<32-18)^(K>>>41-32|S<<32-(41-32));C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;A=K&L^~K&M;B=S&T^~S&U;C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;A=ca[y*2];B=ca[y*2+1];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;A=e[y%16];B=f[y%16];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;w=E&65535|F<<16;x=C&65535|D<<16;A=w;B=x;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=(G>>>28|O<<32-28)^(O>>>34-32|G<<32-(34-32))^(O>>>39-32|G<<32-(39-32));B=(O>>>28|G<<32-28)^(G>>>34-32|O<<32-(34-32))^(G>>>39-32|O<<32-(39-32));C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;A=G&H^G&I^H&I;B=O&P^O&Q^P&Q;C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;n=E&65535|F<<16;v=C&65535|D<<16;A=j;B=r;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=w;B=x;C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;j=E&65535|F<<16;r=C&65535|D<<16;H=g;I=h;J=i;K=j;L=k;M=l;N=m;G=n;P=o;Q=p;R=q;S=r;T=s;U=t;V=u;O=v;if(y%16===15)for(z=0;z<16;z++)A=e[z],B=f[z],C=B&65535,D=B>>>16,E=A&65535,F=A>>>16,A=e[(z+9)%16],B=f[(z+9)%16],C+=B&65535,D+=B>>>16,E+=A&65535,F+=A>>>16,w=e[(z+1)%16],x=f[(z+1)%16],A=(w>>>1|x<<32-1)^(w>>>8|x<<32-8)^w>>>7,B=(x>>>1|w<<32-1)^(x>>>8|w<<32-8)^(x>>>7|w<<32-7),C+=B&65535,D+=B>>>16,E+=A&65535,F+=A>>>16,w=e[(z+14)%16],x=f[(z+14)%16],A=(w>>>19|x<<32-19)^(x>>>61-32|w<<32-(61-32))^w>>>6,B=(x>>>19|w<<32-19)^(w>>>61-32|x<<32-(61-32))^(x>>>6|w<<32-6),C+=B&65535,D+=B>>>16,E+=A&65535,F+=A>>>16,D+=C>>>16,E+=D>>>16,F+=E>>>16,e[z]=E&65535|F<<16,f[z]=C&65535|D<<16}A=G;B=O;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[0];B=b[0];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[0]=G=E&65535|F<<16;b[0]=O=C&65535|D<<16;A=H;B=P;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[1];B=b[1];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[1]=H=E&65535|F<<16;b[1]=P=C&65535|D<<16;A=I;B=Q;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[2];B=b[2];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[2]=I=E&65535|F<<16;b[2]=Q=C&65535|D<<16;A=J;B=R;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[3];B=b[3];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[3]=J=E&65535|F<<16;b[3]=R=C&65535|D<<16;A=K;B=S;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[4];B=b[4];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[4]=K=E&65535|F<<16;b[4]=S=C&65535|D<<16;A=L;B=T;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[5];B=b[5];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[5]=L=E&65535|F<<16;b[5]=T=C&65535|D<<16;A=M;B=U;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[6];B=b[6];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[6]=M=E&65535|F<<16;b[6]=U=C&65535|D<<16;A=N;B=V;C=B&65535;D=B>>>16;E=A&65535;F=A>>>16;A=a[7];B=b[7];C+=B&65535;D+=B>>>16;E+=A&65535;F+=A>>>16;D+=C>>>16;E+=D>>>16;F+=E>>>16;a[7]=N=E&65535|F<<16;b[7]=V=C&65535|D<<16;W+=128;d-=128}return d}function Y(a,b,c){var d=new Int32Array(8),e=new Int32Array(8),f=new Uint8Array(256),g,h=c;d[0]=1779033703;d[1]=3144134277;d[2]=1013904242;d[3]=2773480762;d[4]=1359893119;d[5]=2600822924;d[6]=528734635;d[7]=1541459225;e[0]=4089235720;e[1]=2227873595;e[2]=4271175723;e[3]=1595750129;e[4]=2917565137;e[5]=725511199;e[6]=4215389547;e[7]=327033209;da(d,e,b,c);c%=128;for(g=0;g<c;g++)f[g]=b[h-c+g];f[c]=128;c=256-128*(c<112?1:0);f[c-9]=0;n(f,c-8,h/536870912|0,h<<3);da(d,e,f,c);for(g=0;g<8;g++)n(a,8*g,d[g],e[g]);return 0}function ea(a,c){var d=b(),e=b(),f=b(),g=b(),h=b(),i=b(),k=b(),l=b(),m=b();N(d,a[1],a[0]);N(m,c[1],c[0]);O(d,d,m);M(e,a[0],a[1]);M(m,c[0],c[1]);O(e,e,m);O(f,a[3],c[3]);O(f,f,j);O(g,a[2],c[2]);M(g,g,g);N(h,e,d);N(i,g,f);M(k,g,f);M(l,e,d);O(a[0],h,i);O(a[1],l,k);O(a[2],k,i);O(a[3],h,l)}function fa(a,b,c){var d;for(d=0;d<4;d++)H(a[d],b[d],c)}function ga(a,c){var d=b(),e=b(),f=b();Q(f,c[2]);O(d,c[0],f);O(e,c[1],f);I(a,e);a[31]^=K(d)<<7}function ha(a,b,c){var d,e;F(a[0],f);F(a[1],g);F(a[2],g);F(a[3],f);for(e=255;e>=0;--e)d=c[e/8|0]>>(e&7)&1,fa(a,b,d),ea(b,a),ea(a,a),fa(a,b,d)}function ia(a,c){var d=[b(),b(),b(),b()];F(d[0],k);F(d[1],l);F(d[2],g);O(d[3],k,l);ha(a,d,c)}function ja(a,d,e){var f=new Uint8Array(64),g=[b(),b(),b(),b()];e||c(d,32);Y(f,d,32);f[0]&=248;f[31]&=127;f[31]|=64;ia(g,f);ga(a,g);for(e=0;e<32;e++)d[e+32]=a[e];return 0}var ka=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function la(a,b){var c,d,e,f;for(d=63;d>=32;--d){c=0;for(e=d-32,f=d-12;e<f;++e)b[e]+=c-16*b[d]*ka[e-(d-32)],c=Math.floor((b[e]+128)/256),b[e]-=c*256;b[e]+=c;b[d]=0}c=0;for(e=0;e<32;e++)b[e]+=c-(b[31]>>4)*ka[e],c=b[e]>>8,b[e]&=255;for(e=0;e<32;e++)b[e]-=c*ka[e];for(d=0;d<32;d++)b[d+1]+=b[d]>>8,a[d]=b[d]&255}function ma(a){var b=new Float64Array(64),c;for(c=0;c<64;c++)b[c]=a[c];for(c=0;c<64;c++)a[c]=0;la(a,b)}function na(a,c,d,e){var f=new Uint8Array(64),g=new Uint8Array(64),h=new Uint8Array(64),i,j=new Float64Array(64),k=[b(),b(),b(),b()];Y(f,e,32);f[0]&=248;f[31]&=127;f[31]|=64;var l=d+64;for(i=0;i<d;i++)a[64+i]=c[i];for(i=0;i<32;i++)a[32+i]=f[32+i];Y(h,a.subarray(32),d+32);ma(h);ia(k,h);ga(a,k);for(i=32;i<64;i++)a[i]=e[i];Y(g,a,d+64);ma(g);for(i=0;i<64;i++)j[i]=0;for(i=0;i<32;i++)j[i]=h[i];for(i=0;i<32;i++)for(c=0;c<32;c++)j[i+c]+=g[i]*f[c];la(a.subarray(32),j);return l}function oa(a,c){var d=b(),e=b(),h=b(),j=b(),k=b(),l=b(),n=b();F(a[2],g);L(a[1],c);P(h,a[1]);O(j,h,i);N(h,h,a[2]);M(j,a[2],j);P(k,j);P(l,k);O(n,l,k);O(d,n,h);O(d,d,j);R(d,d);O(d,d,h);O(d,d,j);O(d,d,j);O(a[0],d,j);P(e,a[0]);O(e,e,j);J(e,h)&&O(a[0],a[0],m);P(e,a[0]);O(e,e,j);if(J(e,h))return-1;K(a[0])===c[31]>>7&&N(a[0],f,a[0]);O(a[3],a[0],a[1]);return 0}function pa(a,c,d,e){var f,g=new Uint8Array(32),h=new Uint8Array(64),i=[b(),b(),b(),b()],j=[b(),b(),b(),b()];if(d<64)return-1;if(oa(j,e))return-1;for(f=0;f<d;f++)a[f]=c[f];for(f=0;f<32;f++)a[f+32]=e[f];Y(h,a,d);ma(h);ha(i,j,h);ia(j,c.subarray(32));ea(i,j);ga(g,i);d-=64;if(q(c,0,g,0)){for(f=0;f<d;f++)a[f]=0;return-1}for(f=0;f<d;f++)a[f]=c[f+64];return d}var qa=32,ra=24,sa=32,ta=16,ua=32,va=32,wa=32,xa=32,ya=32,za=ra,Aa=sa,Ba=ta,Z=64,Ca=32,Da=64,Ea=32,Fa=64;a.lowlevel={crypto_core_hsalsa20:u,crypto_stream_xor:z,crypto_stream:y,crypto_stream_salsa20_xor:w,crypto_stream_salsa20:x,crypto_onetimeauth:B,crypto_onetimeauth_verify:C,crypto_verify_16:p,crypto_verify_32:q,crypto_secretbox:D,crypto_secretbox_open:E,crypto_scalarmult:S,crypto_scalarmult_base:T,crypto_box_beforenm:V,crypto_box_afternm:W,crypto_box:aa,crypto_box_open:ba,crypto_box_keypair:U,crypto_hash:Y,crypto_sign:na,crypto_sign_keypair:ja,crypto_sign_open:pa,crypto_secretbox_KEYBYTES:qa,crypto_secretbox_NONCEBYTES:ra,crypto_secretbox_ZEROBYTES:sa,crypto_secretbox_BOXZEROBYTES:ta,crypto_scalarmult_BYTES:ua,crypto_scalarmult_SCALARBYTES:va,crypto_box_PUBLICKEYBYTES:wa,crypto_box_SECRETKEYBYTES:xa,crypto_box_BEFORENMBYTES:ya,crypto_box_NONCEBYTES:za,crypto_box_ZEROBYTES:Aa,crypto_box_BOXZEROBYTES:Ba,crypto_sign_BYTES:Z,crypto_sign_PUBLICKEYBYTES:Ca,crypto_sign_SECRETKEYBYTES:Da,crypto_sign_SEEDBYTES:Ea,crypto_hash_BYTES:Fa,gf:b,D:i,L:ka,pack25519:I,unpack25519:L,M:O,A:M,S:P,Z:N,pow2523:R,add:ea,set25519:F,modL:la,scalarmult:ha,scalarbase:ia};function Ga(a,b){if(a.length!==qa)throw new Error("bad key size");if(b.length!==ra)throw new Error("bad nonce size")}function Ha(a,b){if(a.length!==wa)throw new Error("bad public key size");if(b.length!==xa)throw new Error("bad secret key size")}function $(){for(var a=0;a<arguments.length;a++)if(!(arguments[a]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Ia(a){for(var b=0;b<a.length;b++)a[b]=0}a.randomBytes=function(a){var b=new Uint8Array(a);c(b,a);return b};a.secretbox=function(a,b,c){$(a,b,c);Ga(c,b);var d=new Uint8Array(sa+a.length),e=new Uint8Array(d.length);for(var f=0;f<a.length;f++)d[f+sa]=a[f];D(e,d,d.length,b,c);return e.subarray(ta)};a.secretbox.open=function(a,b,c){$(a,b,c);Ga(c,b);var d=new Uint8Array(ta+a.length),e=new Uint8Array(d.length);for(var f=0;f<a.length;f++)d[f+ta]=a[f];if(d.length<32)return null;return E(e,d,d.length,b,c)!==0?null:e.subarray(sa)};a.secretbox.keyLength=qa;a.secretbox.nonceLength=ra;a.secretbox.overheadLength=ta;a.scalarMult=function(a,b){$(a,b);if(a.length!==va)throw new Error("bad n size");if(b.length!==ua)throw new Error("bad p size");var c=new Uint8Array(ua);S(c,a,b);return c};a.scalarMult.base=function(a){$(a);if(a.length!==va)throw new Error("bad n size");var b=new Uint8Array(ua);T(b,a);return b};a.scalarMult.scalarLength=va;a.scalarMult.groupElementLength=ua;a.box=function(b,c,d,e){d=a.box.before(d,e);return a.secretbox(b,c,d)};a.box.before=function(a,b){$(a,b);Ha(a,b);var c=new Uint8Array(ya);V(c,a,b);return c};a.box.after=a.secretbox;a.box.open=function(b,c,d,e){d=a.box.before(d,e);return a.secretbox.open(b,c,d)};a.box.open.after=a.secretbox.open;a.box.keyPair=function(){var a=new Uint8Array(wa),b=new Uint8Array(xa);U(a,b);return{publicKey:a,secretKey:b}};a.box.keyPair.fromSecretKey=function(a){$(a);if(a.length!==xa)throw new Error("bad secret key size");var b=new Uint8Array(wa);T(b,a);return{publicKey:b,secretKey:new Uint8Array(a)}};a.box.publicKeyLength=wa;a.box.secretKeyLength=xa;a.box.sharedKeyLength=ya;a.box.nonceLength=za;a.box.overheadLength=a.secretbox.overheadLength;a.sign=function(a,b){$(a,b);if(b.length!==Da)throw new Error("bad secret key size");var c=new Uint8Array(Z+a.length);na(c,a,a.length,b);return c};a.sign.open=function(a,b){$(a,b);if(b.length!==Ca)throw new Error("bad public key size");var c=new Uint8Array(a.length);a=pa(c,a,a.length,b);if(a<0)return null;b=new Uint8Array(a);for(a=0;a<b.length;a++)b[a]=c[a];return b};a.sign.detached=function(b,c){b=a.sign(b,c);c=new Uint8Array(Z);for(var d=0;d<c.length;d++)c[d]=b[d];return c};a.sign.detached.verify=function(a,b,c){$(a,b,c);if(b.length!==Z)throw new Error("bad signature size");if(c.length!==Ca)throw new Error("bad public key size");var d=new Uint8Array(Z+a.length),e=new Uint8Array(Z+a.length),f;for(f=0;f<Z;f++)d[f]=b[f];for(f=0;f<a.length;f++)d[f+Z]=a[f];return pa(e,d,d.length,c)>=0};a.sign.keyPair=function(){var a=new Uint8Array(Ca),b=new Uint8Array(Da);ja(a,b);return{publicKey:a,secretKey:b}};a.sign.keyPair.fromSecretKey=function(a){$(a);if(a.length!==Da)throw new Error("bad secret key size");var b=new Uint8Array(Ca);for(var c=0;c<b.length;c++)b[c]=a[32+c];return{publicKey:b,secretKey:new Uint8Array(a)}};a.sign.keyPair.fromSeed=function(a){$(a);if(a.length!==Ea)throw new Error("bad seed size");var b=new Uint8Array(Ca),c=new Uint8Array(Da);for(var d=0;d<32;d++)c[d]=a[d];ja(b,c,!0);return{publicKey:b,secretKey:c}};a.sign.publicKeyLength=Ca;a.sign.secretKeyLength=Da;a.sign.seedLength=Ea;a.sign.signatureLength=Z;a.hash=function(a){$(a);var b=new Uint8Array(Fa);Y(b,a,a.length);return b};a.hash.hashLength=Fa;a.verify=function(a,b){$(a,b);if(a.length===0||b.length===0)return!1;return a.length!==b.length?!1:o(a,0,b,0,a.length)===0?!0:!1};a.setPRNG=function(a){c=a};(function(){var b=typeof self!=="undefined"?self.crypto||self.msCrypto:null;if(b&&b.getRandomValues){var c=65536;a.setPRNG(function(a,d){var e,f=new Uint8Array(d);for(e=0;e<d;e+=c)b.getRandomValues(f.subarray(e,e+Math.min(d-e,c)));for(e=0;e<d;e++)a[e]=f[e];Ia(f)})}else b&&b.randomBytes&&a.setPRNG(function(a,c){var d,e=b.randomBytes(c);for(d=0;d<c;d++)a[d]=e[d];Ia(e)})})()})(typeof g!=="undefined"&&g.exports?g.exports:self.nacl=self.nacl||{})}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
__d("tweetnacl",["tweetnacl-1.0.3"],(function(a,b,c,d,e,f){e.exports=b("tweetnacl-1.0.3")()}),null);
__d("MAWKeychainNaClCrypto",["MAWCryptoConsts","MAWKeychainCrypto","WABase64","tweetnacl"],(function(a,b,c,d,e,f,g){"use strict";var h=function(b){babelHelpers.inheritsLoose(a,b);function a(a){var c;c=b.call(this,a)||this;c.name="EARError";c.message=a;return c}return a}(babelHelpers.wrapNativeSuper(Error));function i(a,b,c){c=c?c:d("MAWKeychainCrypto").ADDITIONAL_DATA;c=new Uint8Array(c);var e=d("tweetnacl").randomBytes(d("tweetnacl").secretbox.nonceLength);b=d("tweetnacl").secretbox(b,e,new Uint8Array(a));a=new Uint8Array(d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES+e.length+b.length);a.set(c);a.set(e,d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES);a.set(b,d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES+e.length);return a.buffer}function j(a,b,c){return d("WABase64").encodeB64(i(a,b,c))}function k(a,b,c){b.slice(0,d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES);var e=b.slice(d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES,d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES+d("tweetnacl").secretbox.nonceLength);b=b.slice(d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES+d("tweetnacl").secretbox.nonceLength,d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES+d("tweetnacl").secretbox.nonceLength+4*Math.ceil(b.byteLength/3));b=d("tweetnacl").secretbox.open(new Uint8Array(b),new Uint8Array(e),new Uint8Array(a));if(b==null){throw new h("Encrypted dexie was unable to decrypt an entity. Attempting to use key version : "+((e=c)!=null?e:"non-provided")+".")}return b}function l(a,b,c){return k(a,d("WABase64").decodeB64(b),c)}function a(a,b,c){return j(a,b,c)}function b(a,b,c){return l(a,b,c)}g.EARDecryptionError=h;g.encryptTweetNaClArrayBuffer=i;g.encryptTweetNaCl=j;g.decryptTweetNaClArrayBuffer=k;g.decryptTweetNaCl=l;g.encrypt=a;g.decrypt=b}),98);
__d("WAArrayBufferUtils",["Promise"],(function(a,b,c,d,e,f){function a(a){var b=new ArrayBuffer(a.length);b=new Uint8Array(b);var c,d;for(c=0,d=a.length;c<d;c++)b[c]=a.charCodeAt(c);return b.buffer}function c(a,c){c===void 0&&(c=5e5);return new(b("Promise"))(function(b,d){var e=a.length,f=new ArrayBuffer(e),g=new Uint8Array(f),h=0;requestAnimationFrame(i);function i(){var d=Math.min(h+c,e);while(h<d)g[h]=a.charCodeAt(h),h++;if(h===e){b(f);return}requestAnimationFrame(i)}})}function d(a){return String.fromCharCode.apply(null,new Uint8Array(a))}var g=8388607;function e(a,b){a=new Uint8Array(a);if(b>g)throw new Error("Divisor is too big");var c=0;for(var d=0;d<a.length;++d)c=((c<<8)+a[d])%b;return c}function h(a){a=a.map(function(a){return new Uint8Array(a)});var b=a.reduce(function(a,b){return a+b.byteLength},0),c=new Uint8Array(b);a.reduce(function(a,b){c.set(b,a);return a+b.byteLength},0);return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}function i(a,b){a=new Uint8Array(a);b=new Uint8Array(b);return j(a,b)}function j(a,b){if(a.byteLength!==b.byteLength)return!1;for(var c=0;c!==a.byteLength;c++)if(a[c]!==b[c])return!1;return!0}f.stringToArrayBuffer=a;f.largeStringToArrayBuffer=c;f.arrayBufferToString=d;f.arrayBufferMod=e;f.concatBuffers=h;f.arrayBuffersEqualUNSAFE=i;f.uint8ArraysEqualUNSAFE=j}),66);
__d("MAWVaultMaterials",["FBLogger","WAArrayBufferUtils","randomInt","tweetnacl"],(function(a,b,c,d,e,f,g){"use strict";var h={encryptionKey:null,prefixAndSuffix:null};function i(a){h.prefixAndSuffix=a}function j(){return h.encryptionKey}function k(a){h.encryptionKey=a}function a(){h.encryptionKey=null,h.prefixAndSuffix=null}function l(){return n()!=null&&j()!=null}function m(){var a=1e9,b=9999999999;return c("randomInt")(a,b)+"##"+c("randomInt")(a,b)}function n(){return h.prefixAndSuffix}function o(){if(!l())throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("Vault materials are null");return babelHelpers["extends"]({},h)}function b(a){var b=l();c("FBLogger")("messenger_e2ee_web").debug("Setting vault materials -- vaultMaterials=%s, previouslySetup=%s",Boolean(a).toString(),b);if(!b){p((b=a)!=null?b:{encryptionKey:d("tweetnacl").randomBytes(32).buffer,prefixAndSuffix:m()})}return o()}function p(a){var b=a.encryptionKey;a=a.prefixAndSuffix;if(b==null||a==null)throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("Cannot set null values for encryption key and prefix");k(b);i(a)}function e(){return q(o())}function q(a){var b=a.encryptionKey;a=a.prefixAndSuffix;if(a!=null&&b!=null){b=d("WAArrayBufferUtils").arrayBufferToString(b);return JSON.stringify({encryptionKey:b,prefixAndSuffix:a})}else return""}function f(a){if(a==="")return null;else{a=JSON.parse(a);if(a.encryptionKey==null||a.prefixAndSuffix==null)throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("Vault materials were not in correct format");var b=d("WAArrayBufferUtils").stringToArrayBuffer(a.encryptionKey);a=a.prefixAndSuffix;return{encryptionKey:b,prefixAndSuffix:a}}}g.TEST_ONLY_clearVaultMaterials=a;g.hasVaultBeenSetup=l;g.getVaultPrefixAndSuffix=n;g.getVaultMaterials=o;g.initializeVaultMaterials=b;g.materialsToString=e;g.fromMaterialsToString=q;g.fromStringToMaterials=f}),98);
__d("MAWVault",["FBLogger","MAWGating","MAWKeychainNaClCrypto","MAWVaultMaterials"],(function(a,b,c,d,e,f,g){"use strict";function h(a){if(!d("MAWGating").isVaultingEnabled())return!1;var b=d("MAWVaultMaterials").getVaultPrefixAndSuffix();if(b==null)return!1;b=new RegExp(b+".*"+b);return b.test(a)}function i(a){if(!d("MAWGating").isVaultingEnabled())return a;if(h(a)){var b=d("MAWVaultMaterials").getVaultMaterials(),e=b.encryptionKey;b=b.prefixAndSuffix;if(b==null)throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("Vault prefix and suffix should not be null when unvaulting");var f=new RegExp(b+"(.*)"+b);f=a.match(f);if(f==null||f.length!=2)throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("Could not retrieve inner value to unvault");if(e==null)throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("Vault encryption key was null before unvault");f=f[1];b=""+b+f+b;var g=k(e,f);return a.replace(b,function(){return g})}return a}function a(a){if(a==="")return a;if(!d("MAWGating").isVaultingEnabled())return a;if(!d("MAWVaultMaterials").hasVaultBeenSetup()){c("FBLogger")("messenger_e2ee_web").mustfix("Attempted to vault value while materials were not setup");return a}if(h(a)){c("FBLogger")("messenger_e2ee_web").mustfix("Attempted to vault value that's already been vaulted");return a}var b=d("MAWVaultMaterials").getVaultMaterials(),e=b.encryptionKey;b=b.prefixAndSuffix;if(b==null||e==null)throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("Cannot vault before vault materials are set");e=j(e,a);return""+b+e+b}function b(a){if(!d("MAWGating").isVaultingEnabled())return a;if(!h(a))throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("Value should be vaulted");return i(a)}function j(a,b){b=new TextEncoder().encode(b).buffer;return d("MAWKeychainNaClCrypto").encryptTweetNaCl(a,new Uint8Array(b))}function k(a,b){a=d("MAWKeychainNaClCrypto").decryptTweetNaCl(a,b);return new TextDecoder().decode(a)}g.isVaulted=h;g.unvault=i;g.vault=a;g.unvaultOrThrow=b}),98);
__d("isObject",[],(function(a,b,c,d,e,f){function a(a){var b=typeof a;return b==="function"||b==="object"&&!!a}f["default"]=a}),66);
__d("isPlainObject",[],(function(a,b,c,d,e,f){"use strict";function a(a){return Object.prototype.toString.call(a)==="[object Object]"}f["default"]=a}),66);
__d("MAWVaultDb",["MAWGating","MAWQplProxy","MAWVault","err","isObject","isPlainObject","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=1/1e3,i=new WeakMap();function j(a,b){return b[a]!=null}function a(a,b,e){if(!c("isPlainObject")(a)||!d("MAWGating").isVaultingEnabled()||!j(b,e)||a==null)return a;var f=i.get(a);if(f!==void 0)return f;f=Math.random()<h?d("MAWQplProxy").startQplUserFlow(c("qpl")._(25301509,"119")):null;try{var g=babelHelpers["extends"]({},a);e=e[b];k(g,e,!0);f==null?void 0:f.endSuccess();i.set(a,g);return g}catch(a){f==null?void 0:f.endFail("vault_fail");throw c("err")(a.message+" - Failed to vault an entity in the table: "+b)}}function b(a,b,e){if(!c("isPlainObject")(a)||!d("MAWGating").isVaultingEnabled()||!j(b,e)||a==null)return a;var f=Math.random()<h?d("MAWQplProxy").startQplUserFlow(c("qpl")._(25313217,"120")):null;try{a=babelHelpers["extends"]({},a);e=e[b];k(a,e,!1);f==null?void 0:f.endSuccess();return a}catch(a){f==null?void 0:f.endFail("unvault_fail");throw c("err")(a.message+" - Unvaulting failed for an entity in the table: "+b)}}function k(a,b,e){if(a==null||b==null)return!1;if(!c("isObject")(a)&&!c("isObject")(b)&&a!=null&&b===!0)return!0;for(var f in a)if(a[f]!=null&&b[f]!=null&&k(a[f],b[f],e)){var g=a[f];e?a[f]=d("MAWVault").vault(g):d("MAWVault").isVaulted(g)&&(a[f]=d("MAWVault").unvault(g))}return!1}g.vaultDbRow=a;g.unvaultDbRow=b;g.maybeVaultOrUnvaultColumns=k}),98);
__d("MAWVaultDefinitions",[],(function(a,b,c,d,e,f){"use strict";a={messages:{msgContent:{content:!0},quote:{content:{msgContent:{content:!0}}}},unrenderedMessages:{msgContent:!0}};b={messages:{text:!0,replyMessageText:!0},threads:{snippet:!0}};f.ARMADILLO_IDB_VAULT_DEFINITIONS=a;f.PERSISTED_DB_VAULT_DEFINITIONS=b}),66);
__d("MAWFolderTypes",[],(function(a,b,c,d,e,f){"use strict";a=0;b=1;c=2;d=10;e={ARCHIVED:d,INBOX:a,OTHER:c,PENDING:b};f.INBOX=a;f.PENDING=b;f.OTHER=c;f.ARCHIVED=d;f.FOLDER_ID=e}),66);
__d("MAWTimeUtils.bs",["bs_caml_int64"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(!(a==null))if(a>2147483647)return a;else return a*1e3}b=2147483647;d=[2328,1316134911];g.getMillisTime=a;g.maxUnixTime=b;g.maxTimestampMs=d;g.minTimestampMs=c("bs_caml_int64").zero}),98);
__d("MAWCreateOneToOneThread.bs",["FBID.bs","LS.bs","LSAuthorityLevel.bs","LSTransaction.bs","LSVerifyE2EEMetadataThreadExistsV2","MAWBackendBridge.bs","MAWBridge.bs","MAWGating","MAWJidUtils.bs","MAWJids","MAWJob.bs","MessagingThreadType.bs","Promise","ReQL.bs","bs_belt_Option","bs_caml_format","bs_caml_int64","bs_curry","bs_int64","bs_js_null_undefined"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return d("MAWBridge.bs").createApi(d("MAWBackendBridge.bs").namespace,d("MAWBackendBridge.bs").CreateThread.$$event,a)}function a(a,e,f,g){var i=d("FBID.bs").ofStringExn(c("bs_int64").to_string(e));g=f!==void 0||!d("MAWGating").isOccamadillo()?b("Promise").resolve(f):d("LSTransaction.bs").run(a,function(a){return c("LSVerifyE2EEMetadataThreadExistsV2")(d("MessagingThreadType.bs").secureMessageOverWaOneToOne,void 0,d("LSAuthorityLevel.bs").optimistic,d("LS.bs").make(a))},"readWrite").then(function(a){return c("bs_int64").to_string(a[0])});return g.then(function(e){var f=c("bs_curry")._1(h({contactFbid:i,offlineThreadingId:c("bs_js_null_undefined").fromOption(e)}).sendAndReceive).then(function(f){var g=f.jid,h=f.chatId,i=f.created;if(d("MAWGating").isOccamadillo())return d("LSTransaction.bs").run(a,function(a){var f=c("bs_caml_format").caml_int64_of_string(d("MAWJidUtils.bs").switchOnChatJidType(g,{group:d("MAWJids").groupIdFromJid,user:d("MAWJids").userIdFromJid}));return d("ReQL.bs").first(d("ReQL.bs").getKeyRange(d("ReQL.bs").fromIndexAscending(a.table("mi_act_mapping_table").index("jid")),{hd:f,tl:0})).then(function(d){if(d!==void 0)return b("Promise").resolve({chatId:c("bs_caml_int64").to_int32(d.clientThreadPk),created:i,jid:g});else return a.table("mi_act_mapping_table").put({clientThreadPk:c("bs_caml_int64").of_int32(h),jid:f,serverThreadKey:c("bs_belt_Option").getExn(c("bs_belt_Option").map(e,c("bs_caml_format").caml_int64_of_string))}).then(function(a){return{chatId:h,created:i,jid:g}})})},"readWrite");else return b("Promise").resolve({chatId:h,created:i,jid:g})}),g=d("MAWJob.bs").getDevices.waitUntilPersisted(new Set().add(d("MAWJids").toUserJid(i)),"creating-1-1-thread",void 0,{priority:"UI_ACTION"});return b("Promise").all([f,g])}).then(function(a){return a[0]})}e=a;g.call=e}),98);
__d("MAWVault.bs",["MAWVault"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("MAWVault").vault(a)}function b(a){return d("MAWVault").unvault(a)}function c(a){return d("MAWVault").unvaultOrThrow(a)}g.vault=a;g.unvault=b;g.unvaultOrThrow=c}),98);
__d("MAWUnvaultTransform",["MAWVault","baseTextTransformAllStrings"],(function(a,b,c,d,e,f,g){"use strict";function a(){return function(a){return c("baseTextTransformAllStrings")(a,function(a,b){return h(a,b)})}}function h(a,b){if(a.length===0)return[a];return d("MAWVault").isVaulted(a)?[d("MAWVault").unvault(a)]:[a]}g["default"]=a}),98);
__d("MAWUnvaultTransform.bs",["MAWUnvaultTransform"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return c("MAWUnvaultTransform")()}g.unvaultTransform=a}),98);